<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Home - Yanghao Wang</title>
  
  
  <link href="http://yanghaowang.github.io/atom.xml" rel="self"/>
  
  <link href="http://yanghaowang.github.io/"/>
  <updated>2021-10-23T15:25:33.816Z</updated>
  <id>http://yanghaowang.github.io/</id>
  
  <author>
    <name>Yanghao Wang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Short Notes on A/B Testing</title>
    <link href="http://yanghaowang.github.io/posts/20210916-Short-Notes-on-A-B-Testing"/>
    <id>http://yanghaowang.github.io/posts/20210916-Short-Notes-on-A-B-Testing</id>
    <published>2021-09-16T21:57:33.000Z</published>
    <updated>2021-10-23T15:25:33.816Z</updated>
    
    <content type="html"><![CDATA[<p class='twelve columns' style="text-align: center;"><img src="/posts/20210916-Short-Notes-on-A-B-Testing/ABTesting.jpg" class=""></p><h2 id="Short-Notes-on-A-B-Testing"><a href="#Short-Notes-on-A-B-Testing" class="headerlink" title="Short Notes on A/B Testing"></a>Short Notes on A/B Testing</h2><h3 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h3><ul><li>Understand what drives your business and provide insights for business decisions  </li><li>Understand causal relationship</li></ul><h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><ul><li>The control and testing groups can be clearly defined</li><li>Metrics of interest can be quantified</li><li>Data can be collected in a timely manner</li></ul><h3 id="Five-Stages-in-Practice"><a href="#Five-Stages-in-Practice" class="headerlink" title="Five Stages in Practice"></a>Five Stages in Practice</h3><ul><li>Define a study question</li><li>Make hypotheses (variations) and identify metrics</li><li>Identify variables<ul><li>Determine the data to be collected</li></ul></li><li>Run experiments and collect data<ul><li>Determine a detectable difference (i.e., how small of a difference you would like to detect, for example, 10% increase in your metric of interest)</li><li>Calculate the proper sample size using power analysis</li><li>Determine what fraction of traffic can be used in the treatment</li><li>Conduct a prior A/A test to check unfavorable impacts on business and a simultaneous A/A test to track seasonality and systematic biases/trend if any</li></ul></li><li>Measure results</li></ul><p class='twelve columns' style="text-align: center;"><img src="/posts/20210916-Short-Notes-on-A-B-Testing/ABTestingSteps.png" class=""></p><h3 id="Some-Details-in-A-B-Testing"><a href="#Some-Details-in-A-B-Testing" class="headerlink" title="Some Details in A/B Testing"></a>Some Details in A/B Testing</h3><h4 id="Common-Web-Analytics-Metrics"><a href="#Common-Web-Analytics-Metrics" class="headerlink" title="Common Web Analytics Metrics"></a>Common Web Analytics Metrics</h4><table><thead><tr><th>Count</th><th>Conversion</th><th>Time</th><th>Business</th></tr></thead><tbody><tr><td>Page View <br>Visits / Return Visits<br/>Click <br/>Visitor / Unique Visitor <br/>(Daily / Monthly) Active Users</td><td>Click Thru Rate <br/>Click Thru Probability <br/>User Click Probability  <br/>Bounce Rate</td><td>Active Time <br>Page View Duration</td><td>Revenue <br>Member <br>Order</td></tr></tbody></table><p>In addition, we can also consider a composite metric.</p><h4 id="Examples-of-Changes-for-Testing"><a href="#Examples-of-Changes-for-Testing" class="headerlink" title="Examples of Changes for Testing"></a>Examples of Changes for Testing</h4><ul><li>Page Contents<ul><li>Headlines, Sub Headlines, Font Size</li><li>Background Image, Background Color</li><li>Paragraph Text</li><li>Page Layout</li></ul></li><li>Call-to-Action<ul><li>Button Place, Button Color, Button Size</li><li>Text</li></ul></li></ul><p>Notes: <em>Only one thing can be changed in a pair of the control and treatment group.</em></p><h4 id="Experiment-Settings"><a href="#Experiment-Settings" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h4><ul><li><p>Target Audience</p><ul><li>Country, Region</li><li>Demographics</li></ul></li><li><p>Sample Size</p></li><li><p>Experiment Period (Time)</p></li><li><p>Percentage of Traffic for A/B Testing</p></li><li><p>Split for Control and Treatment</p><p>Notes: Users visiting the page at different time or using different devices might see different features in the test. These are users in the mixed group, neither in A or B. To solve this problem, we might need to evenly split users in the control and treatment group. Theoretically, the percentages of the mixed group users in A and B should be similar.</p></li><li><p>A/A Test </p><ul><li><p>Run a small A/A test in a short time prior to the A/B test to check the change in metrics of interest and whether there are any unfavorable impacts on business</p></li><li><p>Run an A/A test simultaneously to track the systematic trend during the A/B test period</p></li></ul></li></ul><h4 id="Power-Analysis"><a href="#Power-Analysis" class="headerlink" title="Power Analysis"></a>Power Analysis</h4><ul><li><p><strong>False Positive</strong> (Type I Error): Falsely reject the null hypothesis</p><ul><li>False positive rate ($\alpha$, e.g., 5%) is the significant level of a statistic test</li></ul></li><li><p><strong>False Negative</strong> (Type II Error): Fail to reject (i.e., we should reject but we did not)</p><ul><li>False negative rate ($\beta$, e.g., 20%) is used in calculating the power of a test, i.e., $1-\beta$</li></ul></li></ul><p>Discuss the values of $\alpha$ and $\beta$ with business partners.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Here is a function in R</span></span><br><span class="line"><span class="comment"># https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/power.prop.test</span></span><br><span class="line"><span class="comment"># power.prop.test(n = NULL, p1 = NULL, p2 = NULL, </span></span><br><span class="line"><span class="comment">#                 power = NULL, sig.level = 0.05,</span></span><br><span class="line"><span class="comment">#                 alternative = c(&quot;two.sided&quot;, &quot;one.sided&quot;),</span></span><br><span class="line"><span class="comment">#                 strict = FALSE, tol = .Machine$double.eps^0.25)</span></span><br><span class="line"><span class="comment"># Examples</span></span><br><span class="line">power.prop.test(p1 = <span class="number">0.5</span>, p2 = <span class="number">0.75</span>, power = <span class="number">0.90</span>) <span class="comment">## =&gt;     n = 76.7 in each group</span></span><br><span class="line">power.prop.test(p1 = <span class="number">0.5</span>, p2 = <span class="number">0.501</span>, </span><br><span class="line">                power = <span class="number">0.90</span>, sig.level=<span class="number">.001</span>)      <span class="comment">## =&gt;     n = 10451937 in each group</span></span><br><span class="line">power.prop.test(n = <span class="number">50</span>, p1 = <span class="number">0.5</span>, p2 = <span class="number">0.75</span>)       <span class="comment">## =&gt; power = 0.740</span></span><br><span class="line">power.prop.test(n = <span class="number">50</span>, p1 = <span class="number">0.5</span>, power = <span class="number">0.90</span>)    <span class="comment">## =&gt;    p2 = 0.8026</span></span><br><span class="line">power.prop.test(n = <span class="number">50</span>, p1 = <span class="number">0.5</span>, p2 = <span class="number">0.9</span>,</span><br><span class="line">                power = <span class="number">0.90</span>, sig.level=<span class="literal">NULL</span>)      <span class="comment">## =&gt; sig.l = 0.00131</span></span><br></pre></td></tr></table></figure><h4 id="Result-Evaluation"><a href="#Result-Evaluation" class="headerlink" title="Result Evaluation"></a>Result Evaluation</h4><table><thead><tr><th>Group</th><th>Control - A</th><th>Variation - B</th></tr></thead><tbody><tr><td>Unique Visitor</td><td>500</td><td>500</td></tr><tr><td>Unique Click</td><td>50</td><td>60</td></tr><tr><td>Conversion Rate</td><td>10%</td><td>12%</td></tr></tbody></table><ul><li><p>$H_0:\space d=0$</p></li><li><p>$d \sim N(0,SE)$</p><ul><li>$p_{\text{pool}}=\frac{50+60}{500+500}=0.11$</li><li>$SE=\sqrt{p_{\text{pool}}\times(1-p_{\text{pool}})\times(\frac{1}{N_A}+\frac{1}{N_B})}=0.019789$</li></ul></li><li><p>Calculate 95% confidence interval ($\alpha=5%$)</p><ul><li>$\pm z_{\alpha/2}\times SE\implies (-1.96\times SE, 1.96\times SE)=(-0.0388, 0.0388)$</li><li>$d = 12% - 10% =0.02 &lt; 0.0388$</li><li>Cannot reject $H_0$</li></ul></li><li><p>Suppose $N_A$ and $N_B$ become 10 times larger</p><ul><li>$SE=0.00003916$</li><li>$\pm z_{\alpha/2}\times SE = \pm 0.0000767536$</li><li>$d=0.02&gt;0.0000767536$</li><li>Reject $H_0$</li></ul></li></ul><h3 id="Some-Challenges-in-A-B-Testing"><a href="#Some-Challenges-in-A-B-Testing" class="headerlink" title="Some Challenges in A/B Testing"></a>Some Challenges in A/B Testing</h3><h4 id="Tradeoff-between-alpha-and-beta"><a href="#Tradeoff-between-alpha-and-beta" class="headerlink" title="Tradeoff between $\alpha$ and $\beta$"></a>Tradeoff between $\alpha$ and $\beta$</h4><ul><li><p>By definition, $\alpha$ is the false positive rate, representing the chance that we falsely reject $H_0$. In contrast, $\beta$ is the false negative rate, representing the chance that we should reject but didn’t.</p></li><li><p>Since resources and time are limited, we need put the effect on the project that improves the business most significantly and has the largest favorable business impact.</p></li><li><p>As a result, we might emphasize $\alpha$ at expense of $\beta$. Also, remember to reach an agreement with business before the test.</p></li></ul><h4 id="Insignificant-Treatment-Effect"><a href="#Insignificant-Treatment-Effect" class="headerlink" title="Insignificant Treatment Effect"></a>Insignificant Treatment Effect</h4><ul><li>It is worth noting that the difference between control and treatment is <em>insignificant in statistics</em>. The testing feature can be helpful in the long run.</li><li>Generate a line plot to visualize the difference and check if one is above the other in most of the time, though the difference could be statistically insignificant. Such a line plot can also provide some insights.</li></ul><h4 id="Multi-armed-Bandit-Approach"><a href="#Multi-armed-Bandit-Approach" class="headerlink" title="Multi-armed Bandit Approach"></a>Multi-armed Bandit Approach</h4><p>We want to achieve two goals at a time: (1) find the best variant in a longer time of experiment and (2) maximize the revenue during the experiment period as well.</p><ul><li>Solution: Adjust fraction of (new) users in treatment/control according to which group seems to be doing better.</li></ul>]]></content>
    
    
    <summary type="html">This is a brief note on A/B Testing, including the motivation, prerequisites, and practice steps. Some details and challenges in developing an A/B testing are also covered.</summary>
    
    
    
    
    <category term="A/B Testing" scheme="http://yanghaowang.github.io/tags/A-B-Testing/"/>
    
  </entry>
  
  <entry>
    <title>How to Use Class Objects in Python</title>
    <link href="http://yanghaowang.github.io/posts/20210810-How-to-Use-Class-Objects-in-Python"/>
    <id>http://yanghaowang.github.io/posts/20210810-How-to-Use-Class-Objects-in-Python</id>
    <published>2021-08-11T02:50:09.000Z</published>
    <updated>2021-08-11T04:34:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>I am used to statistical programming and use self-defined functions a lot in R. In my research work, a self-defined function works well in most cases since the scalability and flexibility of codes are less of concern. However, as using more Python and reading more source codes of Python packages, I find <code>class</code> is an important object and deserves a brief study on it.</p><p>A class is a prototype for an object, from which new instances can be created. An instance is a copy of the class with actual values.</p><h2 id="Class-Object"><a href="#Class-Object" class="headerlink" title="Class Object"></a>Class Object</h2><p>A given class object consists of two components:</p><ul><li>State: Attributes/properties of an object</li><li>Behavior: Methods of an object</li></ul><p>All the instances share the attributes and the methods of the class. But the values of attributes are unique for each instance. Let’s see an example as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define a python class named &#x27;makecake&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">makecake</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Define class variables</span></span><br><span class="line">    cook = <span class="string">&#x27;Sharon&#x27;</span></span><br><span class="line">    price_lb = <span class="number">5</span>    <span class="comment"># unit price; dollars per lb</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initialize</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, weight</span>):</span></span><br><span class="line">        <span class="comment"># Define instance variables</span></span><br><span class="line">        self.weight = weight</span><br><span class="line">       </span><br><span class="line">    <span class="comment"># Define a method for an instance</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.weight*self.price_lb</span><br></pre></td></tr></table></figure><blockquote><p><code>makecake</code> is the class name.</p><p><code>cook</code> and <code>price_lb</code> are the class attributes, representing the cook and the unit price of a cake.</p><p><code>price()</code> is the class method used to calculate the cake price.</p><p><code>__init__</code> method is a preserved method for a class object, used to initializing its state. The <code>__init__</code> method is executed at the time the class is instantiated (i.e., the creation of an instance).</p><p><code>self</code> is a must-have parameter in each class method, though it might take no arguments. When we call a method of an object as <code>myobject.method(arg1, arg2)</code>, it is equivalent to the command that <code>MyClass.method(myobject, arg1, arg2)</code>.</p></blockquote><p>Also, note that <code>weight</code> is a variable <em>unique to each instance</em>, while <code>cook</code>, <code>price_lb</code>, <code>price()</code> are <em>class variables</em> shared by all instances of the class.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cake = makecake(weight=<span class="number">2</span>)</span><br><span class="line">print(cake.cook)</span><br><span class="line">print(cake.price_lb)</span><br><span class="line">cake.price()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sharon</span><br><span class="line">5</span><br><span class="line">10</span><br></pre></td></tr></table></figure><h2 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h2><p>Inheritance allows us to define a class that inherits all the methods and properties from another class. For example, inherited from <code>makecake</code>, I declare a new class <code>ordercake</code> as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define a python class based on &#x27;makecake&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ordercake</span>(<span class="params">makecake</span>):</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initialize</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, weight, tax_rate=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="comment"># Define instance variables</span></span><br><span class="line">        self.weight = weight</span><br><span class="line">        self.tax_rate = tax_rate <span class="keyword">if</span> tax_rate <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0.06</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkout</span>(<span class="params">self, tip=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> tip <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            tip = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># self.price() is inherited from &#x27;makecake&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;Receipt&#x27;</span>, <span class="string">&#x27;\n--------------------&#x27;</span></span><br><span class="line">              <span class="string">&#x27;\nCake Price:&#x27;</span>, <span class="built_in">round</span>(self.price(), <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTax:&#x27;</span>, <span class="built_in">round</span>(self.price()*self.tax_rate, <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTips:&#x27;</span>, tip, <span class="string">&#x27;\n--------------------&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;\nTotal:&#x27;</span>, <span class="built_in">round</span>(self.price()*(<span class="number">1</span>+self.tax_rate)+tip, <span class="number">2</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder0 = ordercake(weight=<span class="number">2</span>)</span><br><span class="line">myorder0.checkout()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.6 </span><br><span class="line">Tips: 0 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 10.6</span><br></pre></td></tr></table></figure><p>In addtion to the inherited attributes, I add another attribute <code>tax_rate</code> in the <code>ordercake</code> class to calculate the cake price after tax such that<br>$$<br>\text{Cake Price after Tax}=\text{Cake Price before Tax}\times(1+\text{Tax Rate}).<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder1 = ordercake(weight=<span class="number">2</span>, tax_rate = <span class="number">0.08</span>)</span><br><span class="line">myorder1.checkout()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.8 </span><br><span class="line">Tips: 0 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 10.8</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myorder1.checkout(tip&#x3D;2)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.8 </span><br><span class="line">Tips: 2 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 12.8</span><br></pre></td></tr></table></figure><h2 id="Use-Self-defined-Function-in-Class"><a href="#Use-Self-defined-Function-in-Class" class="headerlink" title="Use Self-defined Function in Class"></a>Use Self-defined Function in Class</h2><p>To enhance the <code>ordercake</code> class, I add an additional function to determine the delivery fee as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define a free-delivery function</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_delivery</span>(<span class="params">order_price</span>):</span></span><br><span class="line">    <span class="comment"># Define the delivery fee</span></span><br><span class="line">    delivery_fee = <span class="number">5</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Waive delivery fee if order price &gt;= 15 dollars</span></span><br><span class="line">    <span class="keyword">if</span> order_price &gt;= <span class="number">15</span>:</span><br><span class="line">        delivery_fee = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> delivery_fee</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define a python class based on &#x27;makecake&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ordercake_delivery</span>(<span class="params">makecake</span>):</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, weight, delivery, tax_rate=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="comment"># Define instance variables</span></span><br><span class="line">        self.weight = weight</span><br><span class="line">        self.delivery_fcn = delivery</span><br><span class="line">        self.tax_rate = tax_rate <span class="keyword">if</span> tax_rate <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0.06</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkout</span>(<span class="params">self, tip=<span class="literal">None</span></span>):</span></span><br><span class="line">        d_fee = self.delivery_fcn(self.price())</span><br><span class="line">        <span class="keyword">if</span> tip <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            tip = <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        print(<span class="string">&#x27;Receipt&#x27;</span>, <span class="string">&#x27;\n--------------------&#x27;</span></span><br><span class="line">              <span class="string">&#x27;\nCake Price:&#x27;</span>, <span class="built_in">round</span>(self.price(), <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTax:&#x27;</span>, <span class="built_in">round</span>(self.price()*self.tax_rate, <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTips:&#x27;</span>, tip,</span><br><span class="line">              <span class="string">&#x27;\nDelivery:&#x27;</span>, d_fee, <span class="string">&#x27;\n--------------------&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;\nTotal:&#x27;</span>, <span class="built_in">round</span>(self.price()*(<span class="number">1</span>+self.tax_rate)+tip+d_fee, <span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>A delivery fee of 5 dollars is added to the receipt if the cake price is less than 15 dollars.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder2 = ordercake_delivery(weight=<span class="number">2</span>, delivery=free_delivery)</span><br><span class="line">myorder2.checkout()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.6 </span><br><span class="line">Tips: 0 </span><br><span class="line">Delivery: 5 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 15.6</span><br></pre></td></tr></table></figure><p>In contrast, the delivery fee is waived if the cake price is 15 dollars or above.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder3 = ordercake_delivery(weight=<span class="number">3</span>, delivery=free_delivery)</span><br><span class="line">myorder3.checkout(tip=<span class="number">2</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 15 </span><br><span class="line">Tax: 0.9 </span><br><span class="line">Tips: 2 </span><br><span class="line">Delivery: 0 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 17.9</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>Python Classes and Objects at GeeksforGeeks: <a href="https://www.geeksforgeeks.org/python-classes-and-objects/">https://www.geeksforgeeks.org/python-classes-and-objects/</a></p>]]></content>
    
    
    <summary type="html">A class is a prototype for an object, from which new instances can be created.</summary>
    
    
    
    
    <category term="Python" scheme="http://yanghaowang.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Path to Virtual Drive</title>
    <link href="http://yanghaowang.github.io/posts/20210720-Path-to-Virtual-Drive"/>
    <id>http://yanghaowang.github.io/posts/20210720-Path-to-Virtual-Drive</id>
    <published>2021-07-20T15:54:41.000Z</published>
    <updated>2021-10-21T21:07:18.962Z</updated>
    
    <content type="html"><![CDATA[<p class='twelve columns' style="text-align: center;">    <img src="/posts/20210720-Path-to-Virtual-Drive/SyncingGoogleDrive.png" class=""></p><p>This July, Google released a new Google Drive desktop app to replace old versions. The biggest change is that I cannot find a local path for files that are selected to be synced to the corresponding files in Google Drive.</p><h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>It bothered me since I mapped a virtual drive <code>W:</code> to the local Google Drive folder using a <code>.bat</code> file with a Windows command <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/subst"><code>subst</code></a> executed when I log into Windows. I learned this trick from my professor at UTK. It allowed me to keep a consistent working directory in my coding scripts. At the beginning of a script, I usually define a working directory at <code>W:</code> which is synced to my Google Drive. Using this trick, I no longer need to change the existing directory when switching my working computer from the desktop in my office to the laptop at home.</p><p>Now, the new Google Drive desktop app does not maintain a local path. Instead, it creates a drive, named “Google Drive,” after it starts as I am logging into Windows. The computer executes the selected software in the Windows Startup list. However, the new Google Drive app takes a little longer to fully start than my <code>.bat</code>. Therefore, when the <code>.bat</code> starts, it cannot find the corresponding path to be mapped to <code>W:</code>.</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>I turn off “Google Drive” in the Windows Startup list, while use the <code>.bat</code> file to start it before executing the <code>subst</code> command.</p><p>Here is an example of my <code>.bat</code> file, say <code>vdrive.bat</code>.</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">subst M: <span class="string">&quot;C:\Users\&lt;username&gt;\OneDrive - azureford&quot;</span></span><br><span class="line"><span class="built_in">start</span> C:\<span class="string">&quot;Program Files&quot;</span>\Google\<span class="string">&quot;Drive File Stream&quot;</span>\<span class="number">51.0</span>.<span class="number">16.0</span>\GoogleDriveFS.exe</span><br><span class="line">timeout /t <span class="number">8</span> /nobreak &gt; nul</span><br><span class="line">subst W: <span class="string">&quot;G:\My Drive&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>Notes: Please replace <code>&lt;username&gt;</code> with your username. If interested, feel free to check the references for windows commands, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/echo"><code>echo</code></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/start"><code>start</code></a>, and <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/timeout"><code>timeout</code></a>.</p></blockquote><p><code>vdrive.bat</code> will be started as I log into Windows if it is added to Windows Registry as a string value in <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]</code>. I need define a value name and the value data for this string value, where the value name is a string displayed in the Windows Startup list and the value data is a path with double quotation marks at both ends, e.g., <code>&quot;C:\vdrive.bat&quot;</code>.</p><p>Every time, when <code>vdrive.bat</code> starts, a Command Prompt window appears. I don’t want to see that as I log into Windows. So I create a shortcut for <code>vdrive.bat</code>, that is, <code>vdrive.bat.lnk</code>. Right click the shortcut file, choose “Minimized” in Run, and save the change. Then I update the value data to <code>&quot;C:\vdrive.bat.lnk&quot;</code> in Windows Registry. Awesome, it works perfectly!</p><p>Don’t want to work in Windows Registry for the Startup list. No problem. You can put the shortcut in the following directory:</p><blockquote><p>Startup folder for user:<br><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code></p><p>Startup folder for all users:<br><code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</code></p></blockquote><h3 id="Navigating-in-Command-Prompt"><a href="#Navigating-in-Command-Prompt" class="headerlink" title="Navigating in Command Prompt"></a>Navigating in Command Prompt</h3><p>In Command Prompt, the default <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cd"><code>cd</code></a> command allows us to change the working directory within the same drive. When changing to a directory in another drive,</p><ol><li>we need switch to the target drive first by typing the letter of the drive and then direct us to the target directory using <code>cd</code>, or</li><li>we can add a parameter in the <code>cd</code> command, i.e., <code>cd /d &quot;&lt;path in another drive&gt;&quot;</code>.</li></ol><p class='twelve columns' style="text-align: center;">    <img src="/posts/20210720-Path-to-Virtual-Drive/cd_command.png" class=""></p>]]></content>
    
    
    <summary type="html">Windows CMD, Command Prompt, Navigation, Virtual Drive, Google Drive, GoogleDriveFS.exe</summary>
    
    
    
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
    <category term="CMD" scheme="http://yanghaowang.github.io/tags/CMD/"/>
    
  </entry>
  
  <entry>
    <title>GitHub Authentication and Basic Functionalities</title>
    <link href="http://yanghaowang.github.io/posts/20210615-GitHub-Authentication-and-Basic-Functionalities"/>
    <id>http://yanghaowang.github.io/posts/20210615-GitHub-Authentication-and-Basic-Functionalities</id>
    <published>2021-06-15T16:06:00.000Z</published>
    <updated>2021-10-21T21:22:01.865Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I share with colleagues my knowledge of Git/GitHub. I gave a presentation in a team meeting, which covers the authentication and the basic functionalities of GitHub. </p><p class='twelve columns' style="text-align: center;">    <img src="/posts/20210615-GitHub-Authentication-and-Basic-Functionalities/Git_GitHub.png" class=""></p><p>The authentication setting of GitHub in Git is not as easy as that in the GitHub Desktop App. Most beginners are overwhelmed by large numbers of relevant posts. Therefore, I list the <em>only necessary official</em> references that you can follow step by step to set up the authentication. Moreover, from my perspectives, I list the basic functionalities of GitHub as well as the corresponding daily Git commands. Lastly, I share some rules of thumb for collaboration in GitHub.</p><h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><p><em>You must authenticate before you can access certain resources on GitHub</em>. When you authenticate to GitHub, you supply or confirm credentials that are unique to you to prove that you are exactly who you declare to be. The most two popular ways to authenticate to GitHub are </p><ol><li>A Combination of Username and Personal Access Token, and</li><li>The SSH Protocol</li></ol><h3 id="Username-and-Token"><a href="#Username-and-Token" class="headerlink" title="Username and Token"></a>Username and Token</h3><ol><li><p>Creating a personal access token: <a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-token">https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-token</a></p></li><li><p>Using a token on the command line: <a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#using-a-token-on-the-command-line">https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#using-a-token-on-the-command-line</a></p></li></ol><h3 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h3><ol><li>Checking for existing SSH keys: <a href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/checking-for-existing-ssh-keys">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/checking-for-existing-ssh-keys</a></li><li>Generating a new SSH key and adding it to the ssh-agent: <a href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a></li><li>Adding a new SSH key to your GitHub account: <a href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account</a></li></ol><p>With SSH keys, you can connect to GitHub without supplying your username and personal access token at each visit.</p><p class='twelve columns' style="text-align: center;">    <img src="/posts/20210615-GitHub-Authentication-and-Basic-Functionalities/GitHubAuthentication.png" class=""></p><h2 id="Basic-Functionalities"><a href="#Basic-Functionalities" class="headerlink" title="Basic Functionalities"></a>Basic Functionalities</h2><h3 id="Adding-an-existing-project-to-GitHub"><a href="#Adding-an-existing-project-to-GitHub" class="headerlink" title="Adding an existing project to GitHub"></a>Adding an existing project to GitHub</h3><p><a href="https://docs.github.com/en/github/importing-your-projects-to-github/importing-source-code-to-github/adding-an-existing-project-to-github-using-the-command-line">https://docs.github.com/en/github/importing-your-projects-to-github/importing-source-code-to-github/adding-an-existing-project-to-github-using-the-command-line</a></p><h3 id="Cloning-a-repository"><a href="#Cloning-a-repository" class="headerlink" title="Cloning a repository"></a>Cloning a repository</h3><p><a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository-from-github/cloning-a-repository">https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository-from-github/cloning-a-repository</a></p><h3 id="Branch-Checkout-Branch"><a href="#Branch-Checkout-Branch" class="headerlink" title="Branch: Checkout/Branch"></a>Branch: Checkout/Branch</h3><ol><li>Create a new branch using <code>git branch &lt;branch_name&gt;</code>.</li><li>Switch to the new branch using <code>git checkout &lt;branch_name&gt;</code>.</li></ol><p>Execute two command lines in one: <code>git checkout -b &lt;branch_name&gt;</code></p><h3 id="Adding-a-file-to-a-repository"><a href="#Adding-a-file-to-a-repository" class="headerlink" title="Adding a file to a repository"></a>Adding a file to a repository</h3><p><a href="https://docs.github.com/en/github/managing-files-in-a-repository/managing-files-using-the-command-line/adding-a-file-to-a-repository-using-the-command-line">https://docs.github.com/en/github/managing-files-in-a-repository/managing-files-using-the-command-line/adding-a-file-to-a-repository-using-the-command-line</a></p><h3 id="Remove-files-from-the-working-directory"><a href="#Remove-files-from-the-working-directory" class="headerlink" title="Remove files from the working directory"></a>Remove files from the working directory</h3><ol><li>Remove files (e.g. trash.txt) from local directory manually.</li><li><code>git rm trash.txt</code> in Git Bash.</li><li>Commit the change using <code>git commit -m &quot;Remove trash.txt&quot;</code>.</li></ol><h3 id="Pull-and-Push"><a href="#Pull-and-Push" class="headerlink" title="Pull and Push"></a>Pull and Push</h3><ol><li>Check the target remote repository on GitHub using <code>git remote -v</code>.</li><li>Pull the latest changes from GitHub with <code>git pull</code>.</li><li>Push your work to GitHub with <code>git push origin &lt;branch_name&gt;&quot;</code> where <code>origin</code> is referred to as the target remote repository.</li></ol><h3 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h3><p>Merge code changes in two different branches (target branch and to be merged branch)</p><ol><li>Checkout the target branch using <code>git checkout &lt;target_bread&gt;</code>.</li><li>Merge the changes from to-be-merged-branch into the target branch using <code>git merge &lt;to_be_merged_branch&gt;</code>.</li></ol><h3 id="Revert-and-Reset"><a href="#Revert-and-Reset" class="headerlink" title="Revert and Reset"></a>Revert and Reset</h3><p><code>git revert &lt;commit_ID&gt;</code> will undo the changes in a particular commit.</p><ul><li><code>git reset </code></li></ul><ul><li><code>git commit --amend</code></li></ul><h2 id="Best-Practices-for-Collaboration"><a href="#Best-Practices-for-Collaboration" class="headerlink" title="Best Practices for Collaboration"></a>Best Practices for Collaboration</h2><ol><li>Always synchronize your branches before starting any work on your own.</li><li>Make changes that are self-contained.</li><li>Avoid having very large changes that modify a lot of different things. (Try to make changes as small as possible as long as they’re self-contained.)</li><li>When working on a big change, it makes sense to have a separate feature branch.</li><li>Regularly merge changes made on the master branch back onto the feature branch.</li><li>Have the latest version of the project in the master branch, and the stable version of the project on a separate branch.</li><li>You shouldn’t rebase changes that have been pushed to remote repos.</li><li>Write commit messages.</li><li>Only edit the same branch when necessary after submitting a pull request.</li></ol>]]></content>
    
    
    <summary type="html">Git, GitHub, Git Basics, GitHub Authentication</summary>
    
    
    
    
    <category term="Git" scheme="http://yanghaowang.github.io/tags/Git/"/>
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
  </entry>
  
  <entry>
    <title>Brief Introduction of Essential Methods in Causal Inference</title>
    <link href="http://yanghaowang.github.io/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference"/>
    <id>http://yanghaowang.github.io/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference</id>
    <published>2021-05-07T00:30:32.000Z</published>
    <updated>2021-05-17T01:05:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>Running an AB test becomes a generic solution when we are interested in the causal impacts of a new feature on the product sales or performance. What if we cannot set up the environment of an experiment because of market regulation?</p><p>In this post, we turn back to some essential methods in causal inference. These methods are briefly covered by the Coursera Project, titled “<a href="https://www.coursera.org/projects/essential-causal-inference-for-data-science">Essential Causal Inference Techniques for Data Science</a>.”</p><h2 id="Idea-behind-Causal-Inference"><a href="#Idea-behind-Causal-Inference" class="headerlink" title="Idea behind Causal Inference"></a>Idea behind Causal Inference</h2><p>Try to control for all possible confounders and <strong>look for “natural sources” of variation that can split our data into quasi random groups</strong> and mimic the randomization we would get from an AB test.</p><p>In other words, removing the effects of all the potential confounders, we believe that testing groups are randomly split and comparable.</p><h2 id="Essential-Methods"><a href="#Essential-Methods" class="headerlink" title="Essential Methods"></a>Essential Methods</h2><h3 id="Controlled-Regression"><a href="#Controlled-Regression" class="headerlink" title="Controlled Regression"></a>Controlled Regression</h3><ul><li><p>We have Y =&gt; usage as measured by completing the 2nd week of a course</p></li><li><p>and X =&gt; First Week NPS (net promoter score) which is a satisfaction rating on a 1-10 scale</p></li><li><p>Univariate regression of Y (usage) on X (product quality)</p></li><li><p>Multiple regression of Y (usage) on X (product quality) and a set of controls</p></li></ul><p>If </p><ol><li><p>the R squared in the multiple regression increases “a lot” from that in the univariate regression</p></li><li><p>coefficient on X is similar in the two models</p></li></ol><p>then by the theory of controlled regression, we can use it as the causal impact.</p><blockquote><p>Sources of Error</p><ul><li><p>Omitted Variable Bias</p><p>Look at the R squared in the multiple regression with controls and how large it is (if R^2^ is not close to 100% we know there are a lot of omitted variables in our regression)</p></li><li><p>Included Variable Bias</p><p>This is the opposite of omitted variable bias and involves the inclusion of too many controls. No direct way to identify this problem but generally can leave out controls that are not determined at time observe X. In the ML context, it is the information leakage (e.g., target encoding), that is, using future to predict the past.</p></li></ul></blockquote><p>Controlled regression can be a bit of art form and a bit of random. People nowadays prefer the other causal inference techniques that are considered to be more rigorous and reliable.</p><h3 id="Regression-Discontinuity"><a href="#Regression-Discontinuity" class="headerlink" title="Regression Discontinuity"></a>Regression Discontinuity</h3><p>Focus on cut-off point that can be thought of as local randomized experiment.</p><img src="/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference/RD.png" class=""><blockquote><p>Arbitrarily assigned cutoff point randomly splits the sample into two comparable groups around the cutoff point. </p></blockquote><ul><li><p>Y: Revenue or course enrollment</p></li><li><p>X: Advertisement (advertised, e.g., via email, if the percentage of subtitled materials in a course is greater than 80%)</p></li><li><p>Assumption</p><ol><li><p>Courses below and above the 80% subtitle threshold are similar to one another, so the discontinuity point effectively randomizes the sample.</p><blockquote><p>Check:</p><ol><li>Sample size similar below and above cutoff (i.e., roughly balanced)</li><li>Sample below and above cutoff are similar on observable/confounders</li></ol></blockquote></li><li><p>Advertising available or not is assumed to be the only differentiator between courses at the 70% subtitle value and the 90% subtitle value.</p><blockquote><p>Check:</p><p>Conduct placebo tests, that is, run regression discontinuity at points other than the cutoff and check for no effect (e.g., run regression discontinuity at 20%, 30%, and 40% and we shouldn’t find any significant difference at these levels)</p></blockquote></li></ol></li></ul><p>Using regression discontinuity design (RDD), we estimate a linear regression with a term of the X variable with the discontinuity, an indicator for the discontinuity (which is a function of the X variable being above or below the cutoff point), and the interaction of the X variable and the discontinuity indicator.<br>$$<br>y=\beta_0+\beta_1 \cdot x+\beta_2 \cdot I(x\ge c)+\beta_3\cdot x \cdot I(x\ge c),<br>$$<br>where $x$ is the variable with the discontinuity, $I(\cdot)$ is an indicator function, and $c$ is the randomly assigned cutoff point.</p><blockquote><p>Note this regression fits two linear models (with different coefficients) below and above the cutoff point. When $x&lt;c$, the intercept and the coefficient of the X variable are $\beta_0$ and $\beta_1$. In contrast, when $x\ge c$, the intercept and the coefficient become $\beta_0+\beta_2$ and $\beta_1+\beta_3$.</p><p>This change in the model structure is analog to the formulation of the Chow test for examining the structural break.</p></blockquote><p>Comparing pre and post the discontinuity, we obtain the causal effect given by<br>$$<br>\beta_2 + \beta_3\times c.<br>$$</p><h3 id="Difference-in-Difference"><a href="#Difference-in-Difference" class="headerlink" title="Difference-in-Difference"></a>Difference-in-Difference</h3><img src="/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference/DID.png" class=""><ul><li><p>Y: Revenue</p></li><li><p>X: Price change</p></li><li><p>Assumption: Parallel Trends</p><p>Check revenue in control country with no price change was similar and highly correlated with revenue in treatment country with price change (ensure control can serve as counterfactual)</p><ol><li>Graph control and treatment groups in the pre period and see if highly correlated</li><li>Build a regression model to check whether trends are identical (hypotheses testing if there is no difference in slopes between two groups)</li></ol></li><li><p>Extension: <strong>Synthetic Control</strong></p><ul><li>Problem with regular DID: Picking a single control group that satisfies parallel trends can be arbitrary</li><li>Synthetic control creates a synthetic control group that is a weighted average of many control groups<ol><li>Choose weights to minimize tracking error with treatment group pre intervention (parallel trends)</li><li>Causal estimate is difference post intervention between treatment and “synthetic control” </li></ol></li><li>R packages: <a href="https://cran.r-project.org/web/packages/Synth/index.html"><code>Synth</code></a>; <a href="https://cran.r-project.org/web/packages/CausalImpact/"><code>CausalImpact</code></a> (Bayesian Version)</li></ul></li></ul><h3 id="Instrumental-Variables"><a href="#Instrumental-Variables" class="headerlink" title="Instrumental Variables"></a>Instrumental Variables</h3><ul><li><p>Assumptions</p><ol><li><p>Strong First Stage: Instruments are strong predictors for the X variable</p><p>Hypothesis tests for weak instruments</p></li><li><p>Exclusion Restriction: Instruments have an impact on the Y variable only through their impact on the X variable</p><p>There is no test for this assumption. We need to use logic to strengthen the validity of this assumption. In a <strong>randomized encouragement trial</strong> (i.e., a RCT used for product promotion campaign; think of email notification) where we create the instrument as a randomly assigned nudge that prompts the X variable, we can ensure exclusion restriction through random assignment.</p></li></ol></li></ul><h3 id="Machine-Learning-ML-Causal-Inference"><a href="#Machine-Learning-ML-Causal-Inference" class="headerlink" title="Machine Learning (ML) + Causal Inference"></a>Machine Learning (ML) + Causal Inference</h3><ul><li><p>Weakness of classic causal approaches</p><ul><li>Fail with many covariates</li><li>Model selection unprincipled</li><li>Linear relationships and no interactions</li></ul></li><li><p>Benefits of ML</p><ul><li>Handle high dimensionality</li><li>Principled ways to choose model</li><li>Nonlinear model using higher order features</li></ul></li><li><p>ML form controlled regression</p><ul><li><p>Use ML models to control for many potential confounders and/or nonlinear effects. </p><blockquote><p>Standard controlled regression steps</p><ul><li>Regress Y on X and a set of controls C to identify coefficient of interest on X</li><li>Be wary of omitted and included variable biases</li></ul></blockquote></li><li><p>There are two types of ML form controlled regressions:</p><ul><li>Double Selection (LASSO)</li><li>Double Debiased (Generic ML models)</li></ul><blockquote><p>Double Selection on AB test data:</p><ul><li>Reduce the noises and increase statistical power (give smaller confidence intervals in a shorter experiment period)</li><li>Good for small samples and small effect sizes (i.e., small expected difference between A and B groups)</li></ul></blockquote></li><li><p>Steps</p><ul><li><p>Define outcome Y, treatment indicator X, and high dimensional set of controls C</p></li><li><p>Split data into two sets: Training and Testing (this can be generalized to k-folds)</p></li><li><p><strong>Fit</strong> two Lassos of X~C and Y~C <strong>on the training</strong> data set</p><blockquote><p>Use <a href="https://stats.stackexchange.com/questions/138569/why-is-lambda-within-one-standard-error-from-the-minimum-is-a-recommended-valu">the one standard error rule</a> to choose the optimal $\lambda$ (i.e., the shrinkage parameter) for the LASSO regression</p><p>The final set of controls is a union of controls from the LASSO regression X~C and Y~C</p></blockquote></li><li><p>Take fitted models and <strong>apply to the testing</strong> data set</p></li><li><p>Get all nonzero variables in C and use as controls in controlled regression of Y on X</p></li></ul></li></ul></li><li><p>Causal Trees/Forests</p><ul><li><p>Previous models assume homogeneous treatment effects. However, <strong>causal trees/forests estimates heterogeneous treatment effects</strong> where impact differs on observed criteria</p><ul><li>Use trees (or forests) to identify partition of the demographic space that maximizes observed difference of Y between treatment and control while balancing overfitting</li></ul></li><li><p>Steps</p><ul><li>Split data into two halves</li><li>Fit trees/forests on one half (i.e., the splitting subsample) and apply to second half (i.e., the estimating subsample) to estimate treatment effects</li><li>Heterogeneous treatment effects from difference in Y in leaf nodes (i.e., the treatment effect conditioned on C attributes in leaf nodes) </li><li>Optimization criteria set up to find the best fit given the splitting subsample</li><li>Forest is an average of a collection of trees with sampling</li></ul></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Running an AB test becomes a generic solution when we are interested in the causal impacts of a new feature on the product sales or perfo</summary>
      
    
    
    
    
    <category term="Causal Inference" scheme="http://yanghaowang.github.io/tags/Causal-Inference/"/>
    
    <category term="Machine Learning" scheme="http://yanghaowang.github.io/tags/Machine-Learning/"/>
    
  </entry>
  
  <entry>
    <title>Aggregate Data in SQL Using GROUP BY or Window Functions</title>
    <link href="http://yanghaowang.github.io/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions"/>
    <id>http://yanghaowang.github.io/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions</id>
    <published>2021-04-10T15:57:07.000Z</published>
    <updated>2021-04-11T03:15:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>Aggregating over groups and calculating summary statistics by group provide an informative angle to review the data. As examining the data at the disaggregated level, we might prefer including the summary statistics aside. Therefore, we need to merge a table of summary statistics at the group level back to the disaggregated data using group ID. <em>Window functions</em> are introduced in SQL to facilitate this process.</p><blockquote><p>A <em>window function</em> performs a calculation across a set of table rows that are somehow related to the current row. This is comparable to the type of calculation that can be done with an aggregate function. <strong>In contrast to regular aggregate functions, use of a window function does not cause rows to become grouped into a single output row</strong> – the rows retain their separate identities (<a href="https://mode.com/sql-tutorial/sql-window-functions/#intro-to-window-functions">MODE Tutorial Link</a>).</p></blockquote><p>This post summarizes the primary use of window functions by presenting practice examples.</p><h2 id="The-OVER-Clause-Syntax"><a href="#The-OVER-Clause-Syntax" class="headerlink" title="The OVER Clause Syntax"></a>The <code>OVER</code> Clause Syntax</h2><p>The basic syntax of window function is to use SQL functions (either aggregate functions such as <code>SUM</code>, <code>COUNT</code>, and <code>AVG</code> or row-wise functions such as <code>ROW_NUMBER()</code> and <code>RANK()</code>) together with the <code>OVER</code> clause.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---- OVER (ORDER BY) ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_time,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">      start_time</span><br><span class="line">  ) <span class="keyword">AS</span> cumsum <span class="comment">-- cumulative sum overall</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br><span class="line"></span><br><span class="line"><span class="comment">---- OVER (PARTITION BY) ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">  ) <span class="keyword">AS</span> sub_total <span class="comment">-- subtotal by group</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br><span class="line"></span><br><span class="line"><span class="comment">---- OVER (PARTITION BY + ORDER BY) ----</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">      start_time</span><br><span class="line">  ) <span class="keyword">AS</span> running_total <span class="comment">-- cumsum within group</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br></pre></td></tr></table></figure><blockquote><p>The <code>PARTITION BY</code> clause within the <code>OVER</code> clause divides the data into subsets by the values of selected columns.</p></blockquote><h2 id="GROUP-BY-JOIN-Window-Functions"><a href="#GROUP-BY-JOIN-Window-Functions" class="headerlink" title="GROUP BY + JOIN = Window Functions"></a><code>GROUP BY</code> + <code>JOIN</code> = Window Functions</h2><p>Here is a diagram to illustrate this <code>GROUP BY</code>+<code>JOIN</code> process:</p><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/transform-example.png" class=""><blockquote><p>This can be completed by <code>pandas.DataFrame.transform</code> in Python (<a href="https://pbpython.com/pandas_transform.html">Reference Link</a>) or <code>DT[, .SD, by]</code> using <code>data.table</code> package in R (<a href="https://rdatatable.gitlab.io/data.table/articles/datatable-sd-usage.html">Reference Link</a>).</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---- Window Functions ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">COUNT</span>(duration_seconds) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal) <span class="keyword">AS</span> n_duration,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal) <span class="keyword">AS</span> subtotal_duration</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> duration_seconds &gt; <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds</span><br><span class="line"></span><br><span class="line"><span class="comment">---- GROUP BY + LEFT JOIN ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  raw.start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  n_duration,</span><br><span class="line">  subtotal_duration</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012 <span class="keyword">raw</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">      start_terminal,</span><br><span class="line">      <span class="keyword">COUNT</span>(duration_seconds) <span class="keyword">AS</span> n_duration,</span><br><span class="line">      <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">AS</span> subtotal_duration</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">      tutorial.dc_bikeshare_q1_2012</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">      start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">      <span class="keyword">AND</span> duration_seconds &gt; <span class="number">3000</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">      start_terminal</span><br><span class="line">  ) subsum <span class="keyword">ON</span> subsum.start_terminal = raw.start_terminal</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  raw.start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> raw.duration_seconds &gt; <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds</span><br></pre></td></tr></table></figure><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/WindowFunction_1.png" class=""><h2 id="ROW-NUMBER-RANK-and-DENSE-RANK"><a href="#ROW-NUMBER-RANK-and-DENSE-RANK" class="headerlink" title="ROW_NUMBER(), RANK(), and DENSE_RANK()"></a><code>ROW_NUMBER()</code>, <code>RANK()</code>, and <code>DENSE_RANK()</code></h2><p>When labeling the row numbers, we are thinking of <code>ROW_NUMBER()</code>, <code>RANK()</code>, and <code>DENSE_RANK()</code>. </p><ul><li><p><code>RANK()</code> vs. <code>ROW_NUMBER()</code></p><p>For example, if you order by <code>start_time</code>, there might exist some rows with identical start times. <code>RANK()</code> gives the same rank to these rows, whereas <code>ROW_NUMBER()</code> gives them different numbers in order. </p></li><li><p><code>RANK()</code> vs. <code>DENSE_RANK()</code></p><p>For example, <code>RANK()</code> would give the identical rows a rank of 2, then might give 5 by skipping the ranks 3 and 4. In contrast, <code>DENSE_RANK()</code> would not skip any rank. It gives all the identical rows a rank of 2, followed by 3.</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---- ROW_NUMBER() ----</span></span><br><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       start_time,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       ROW_NUMBER() <span class="keyword">OVER</span> (</span><br><span class="line">         <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">         <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_time</span><br><span class="line">       ) <span class="keyword">AS</span> row_number</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---- RANK() ----</span></span><br><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       <span class="keyword">RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">         <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">         <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_time</span><br><span class="line">       ) <span class="keyword">AS</span> <span class="keyword">rank</span></span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Quartile-Quintile-and-Percentile"><a href="#Quartile-Quintile-and-Percentile" class="headerlink" title="Quartile, Quintile, and Percentile"></a>Quartile, Quintile, and Percentile</h2><p>Use the window function <code>NTILE(# of buckets)</code> to label the subgroups ordered by selected columns.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       NTILE(<span class="number">4</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">          <span class="keyword">AS</span> quartile,</span><br><span class="line">       NTILE(<span class="number">5</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">         <span class="keyword">AS</span> quintile,</span><br><span class="line">       NTILE(<span class="number">100</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">         <span class="keyword">AS</span> percentile</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> duration_seconds &gt; <span class="number">300</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_terminal, duration_seconds</span><br></pre></td></tr></table></figure><h3 id="Window-Alias"><a href="#Window-Alias" class="headerlink" title="Window Alias"></a>Window Alias</h3><p>If you’re planning to write several window functions in to the same query, using the same window, you can create an alias. The <code>WINDOW</code> clause, if included, should always come <em>after</em> the <code>WHERE</code> clause.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal) <span class="keyword">AS</span> subtotal,</span><br><span class="line">       NTILE(<span class="number">4</span>) <span class="keyword">OVER</span> ntile_window                               <span class="keyword">AS</span> quartile,</span><br><span class="line">       NTILE(<span class="number">5</span>) <span class="keyword">OVER</span> ntile_window                               <span class="keyword">AS</span> quintile,</span><br><span class="line">       NTILE(<span class="number">100</span>) <span class="keyword">OVER</span> ntile_window                             <span class="keyword">AS</span> percentile,</span><br><span class="line">       ROW_NUMBER() <span class="keyword">OVER</span> ntile_window                           <span class="keyword">AS</span> row_numb</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> duration_seconds &gt; <span class="number">300</span></span><br><span class="line"><span class="keyword">WINDOW</span> ntile_window <span class="keyword">AS</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_terminal, duration_seconds</span><br></pre></td></tr></table></figure><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/WindowFunction_2.png" class=""><blockquote><p>When <code># of buckets</code> is greater than the number of records, <code>NTILE()</code> == <code>ROW_NUMBER()</code>.</p></blockquote><h2 id="Comparing-to-The-Preceding-or-Following-Rows"><a href="#Comparing-to-The-Preceding-or-Following-Rows" class="headerlink" title="Comparing to The Preceding or Following Rows"></a>Comparing to The Preceding or Following Rows</h2><p>You can use <code>LAG</code> or <code>LEAD</code> to create columns that pull values from other rows.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       LAG(duration_seconds, <span class="number">1</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds) <span class="keyword">AS</span> lag,</span><br><span class="line">       duration_seconds -LAG(duration_seconds, <span class="number">1</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">         <span class="keyword">AS</span> lag_difference,</span><br><span class="line">       <span class="keyword">LEAD</span>(duration_seconds, <span class="number">1</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds) <span class="keyword">AS</span> <span class="keyword">lead</span></span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_terminal, duration_seconds</span><br></pre></td></tr></table></figure><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/WindowFunction_3.png" class="">]]></content>
    
    
    <summary type="html">Aggregate Data in SQL, GROUP BY, Window Functions, SQL OVER Clause, Window Alias</summary>
    
    
    
    
    <category term="SQL" scheme="http://yanghaowang.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Aggregating and Filtering at One Time in SQL</title>
    <link href="http://yanghaowang.github.io/posts/20210406-Aggregating-and-Filtering-at-One-Time-in-SQL"/>
    <id>http://yanghaowang.github.io/posts/20210406-Aggregating-and-Filtering-at-One-Time-in-SQL</id>
    <published>2021-04-07T01:37:57.000Z</published>
    <updated>2021-04-10T19:22:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>When it comes to reporting some statistics by group in SQL, we will think of using the aggregate functions and, if needed, the <code>WHERE</code> clause for filtering. However, the <code>WHERE</code> clause doesn’t allow you to filter on aggregate columns. To complete the query at one time without subqueries, we need the help of the <code>HAVING</code> clause.</p><h2 id="Aggregate-Functions"><a href="#Aggregate-Functions" class="headerlink" title="Aggregate Functions"></a>Aggregate Functions</h2><p>There are four popular aggregate functions in SQL:</p><ul><li><p><code>COUNT</code> counts the number of non-<code>NULL</code> rows in a column</p><ul><li><code>COUNT(DISTINCT price)</code> counts the number of the distinct non-<code>NULL</code> values in <code>price</code>.</li></ul></li><li><p><code>SUM</code> adds together all the values in a numeric column</p><ul><li><code>NULL</code> is treated as <code>0</code>. </li></ul></li><li><p><code>MIN</code> and <code>MAX</code> return the lowest and highest values in a numeric column, respectively</p></li><li><p><code>AVG</code> calculates the average of a group of selected values</p><ul><li><p>It can ONLY be used on numerical columns.</p></li><li><p><code>NULL</code> is ignored in the calculation.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(price)</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line"> <span class="keyword">WHERE</span> price <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="comment">---- Equivalent Query ----</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(price)</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.storesales</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="Aggregate-by-Group"><a href="#Aggregate-by-Group" class="headerlink" title="Aggregate by Group"></a>Aggregate by Group</h3><p>For example, you might want to count the number of entries for each year and month.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">year</span>,</span><br><span class="line">       <span class="keyword">month</span>,</span><br><span class="line">       <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="keyword">count</span></span><br><span class="line"> <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">month</span>, <span class="keyword">year</span></span><br></pre></td></tr></table></figure><h2 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h2><p>What if we are only interested in the months when the highest price is over 200.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">year</span>,</span><br><span class="line">       <span class="keyword">month</span>,</span><br><span class="line">       <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> month_high</span><br><span class="line"> <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">MAX</span>(price) &gt; <span class="number">200</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line"><span class="comment">---- Equivalent Query ----</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">      <span class="keyword">SELECT</span> <span class="keyword">year</span>,</span><br><span class="line">             <span class="keyword">month</span>,</span><br><span class="line">             <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> month_high</span><br><span class="line">        <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line">       <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line">      ) sub</span><br><span class="line"><span class="keyword">WHERE</span> month_high &gt; <span class="number">200</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br></pre></td></tr></table></figure><ul><li>Using the aggregate function and the <code>HAVING</code> clause at one time to filter on an aggregated column.</li><li>The <code>WHERE</code> clause does not work in this case.</li></ul>]]></content>
    
    
    <summary type="html">Aggregate Functions in SQL, SQL GROUP BY, SQL WHERE, SQL HAVING, Filters on Aggregate Columns in SQL</summary>
    
    
    
    
    <category term="SQL" scheme="http://yanghaowang.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Hypothesis Testing vs. A/B Testing</title>
    <link href="http://yanghaowang.github.io/posts/20210405-Hypothesis-Testing-vs-A-B-Testing"/>
    <id>http://yanghaowang.github.io/posts/20210405-Hypothesis-Testing-vs-A-B-Testing</id>
    <published>2021-04-05T21:12:01.000Z</published>
    <updated>2021-04-25T18:14:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>A/B testing is a popular term in Data Science. It is fairly self-explanatory to me at the first glance but then arises an question, what is the difference between the A/B testing people are using nowadays and the hypothesis testing I learnt in the statistics class. </p><p>In this post, I include some key points for understanding the hypothesis testing and the A/B testing, as well as some takeaways from other posts. In short, A/B testing is a version of a two-sample hypothesis testing for a randomized controlled experiment with two groups, control and treatment.</p><h2 id="Hypothesis-Testing"><a href="#Hypothesis-Testing" class="headerlink" title="Hypothesis Testing"></a>Hypothesis Testing</h2><ul><li>Specify the null ($H_0$) and alternative ($H_1$) Hypothesis</li><li>Calculate test statistics according to the observed sample</li><li>Reject or cannot reject the null hypothesis</li></ul><p>In the hypothesis testing, we have some knowledge of a population and observe a representative sample from the population. By computing the test statistics, we verify if our knowledge of the population can be supported by the observed sample.</p><p><a href="https://towardsdatascience.com/a-gentle-introduction-to-the-mathematics-behind-a-b-testing-3afe354bdce3">A post by Jérôme Spielmann</a> gives a gentle introduction about the mathematics behind the statistical testing and the transition from the generic testing to the A/B testing.</p><blockquote><p>In this post, the author has an example of the results in a A/B test.</p><table><thead><tr><th align="left"></th><th align="center">Click on Link</th><th align="center">Did not Click</th></tr></thead><tbody><tr><td align="left">Design A</td><td align="center">33</td><td align="center">362</td></tr><tr><td align="left">Design B</td><td align="center">42</td><td align="center">283</td></tr></tbody></table><p>In the hypothesis testing, we focus on the results from one design and have<br>$$<br>H_0:p=0.05\quad\text{v.s.}\quad H_1:p\neq 0.05.<br>$$</p><p>In the A/B testing, we compare the results from two designs and have</p><p>$$<br>H_0:p_1=p_2=p\quad\text{v.s.}\quad H_1:p_1\neq p_2.<br>$$</p></blockquote><h2 id="A-B-Testing"><a href="#A-B-Testing" class="headerlink" title="A/B Testing"></a>A/B Testing</h2><ul><li>Define a measure of interest (i.e., treatment) and a metric</li><li>Specify the control and treatment group (i.e., Group A and B)</li><li>Construct the null hypothesis that the treatment group is as same as the control group</li><li>Calculate test statistics according to the control and treatment group</li><li>Reject or cannot reject the null hypothesis</li></ul><p>In the A/B testing, we have a hypothesis of a measure and we are interested in its impact. Particularly, we design a randomized experiment with two groups that are identical prior to the treatment. In the testing process, one group is treated, while the other is not. </p><h3 id="Test-Statistics"><a href="#Test-Statistics" class="headerlink" title="Test Statistics"></a>Test Statistics</h3><p>The A/B testing includes applications of <a href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">statistical hypothesis testing</a> or “<a href="https://en.wikipedia.org/wiki/Two-sample_hypothesis_testing">two-sample hypothesis testing</a>“ as used in statistics. The test statistics vary with the metrics that are used for comparing the two groups.</p><ul><li> <a href="https://en.wikipedia.org/wiki/Z-test">Z-test</a> is appropriate for comparing means under stringent conditions regarding normality and a known standard deviation.</li><li> <a href="https://en.wikipedia.org/wiki/Student's_t-test">Student’s t-tests</a> is appropriate for comparing means under relaxed conditions when less is assumed. </li><li> <a href="https://en.wikipedia.org/wiki/Welch's_t_test">Welch’s t test</a> assumes the least and is therefore the most commonly used test in a two-sample hypothesis test where the mean of a metric is to be optimized.</li><li> <a href="https://en.wikipedia.org/wiki/Fisher's_exact_test">Fisher’s exact test</a> is used in a comparison of two <a href="https://en.wikipedia.org/wiki/Binomial_distribution">binomial distributions</a> such as a <a href="https://en.wikipedia.org/wiki/Click-through_rate">click-through rate</a>.</li></ul><table><thead><tr><th>Assumed Distribution</th><th align="left">Example Case</th><th>Standard Test</th><th>Alternative Test</th></tr></thead><tbody><tr><td><a href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian</a></td><td align="left"><a href="https://en.wikipedia.org/wiki/Average_revenue_per_user">Average revenue per user</a></td><td><a href="https://en.wikipedia.org/wiki/Welch's_t-test">Welch’s t-test</a> <br>(Unpaired t-test)</td><td><a href="https://en.wikipedia.org/wiki/Student's_t-test">Student’s t-test</a></td></tr><tr><td><a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial</a></td><td align="left"><a href="https://en.wikipedia.org/wiki/Click-through_rate">Click-through rate</a></td><td><a href="https://en.wikipedia.org/wiki/Fisher's_exact_test">Fisher’s exact test</a></td><td><a href="https://en.wikipedia.org/wiki/Barnard's_test">Barnard’s test</a></td></tr><tr><td><a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson</a></td><td align="left">Transactions <br/>per paying user</td><td>E-test</td><td>C-test</td></tr><tr><td><a href="https://en.wikipedia.org/wiki/Multinomial_distribution">Multinomial</a></td><td align="left">Number of <br/>each product purchased</td><td><a href="https://en.wikipedia.org/wiki/Chi-squared_test">Chi-squared test</a></td><td></td></tr><tr><td>Unknown</td><td align="left"></td><td><a href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test">Mann–Whitney U test</a></td><td><a href="https://en.wikipedia.org/wiki/Gibbs_sampling">Gibbs sampling</a></td></tr></tbody></table><blockquote><p>Reference Link: <a href="https://en.wikipedia.org/wiki/A/B_testing#Common_test_statistics">https://en.wikipedia.org/wiki/A/B_testing#Common_test_statistics</a></p></blockquote><h3 id="Test-Significance-Level-and-Statistical-Power"><a href="#Test-Significance-Level-and-Statistical-Power" class="headerlink" title="Test Significance Level and Statistical Power"></a>Test Significance Level and Statistical Power</h3><p>Oftentimes, a problem will be given with a desired confidence level instead of the significance level ($\alpha$). A typical 95% confidence level for an A/B test corresponds to a significance level of 0.05.</p><blockquote><p>$\text{significance level}~\alpha=1-\text{confidence level}$</p></blockquote><p><em>An experiment in the A/B testing is typically set up at a minimum statistical power of 80 percent</em>. In other words, we want the test to show it is at least 80 percent in the probability that the treatment truly works.</p><p>By construction, if we increase the sample size for both A and B group, we will make the distributions under $H_0$ and $H_1$ much narrower and hence increase the statistical power.   </p><h3 id="Test-Sample-Size"><a href="#Test-Sample-Size" class="headerlink" title="Test Sample Size"></a>Test Sample Size</h3><p>The key is to determine the minimum sample size for the experiment, because it is directly related to how quickly you can complete the test and deliver statistically significant results.</p><blockquote><p>There are two calculators available on the web:</p><ul><li><a href="https://www.evanmiller.org/ab-testing/sample-size.html">Sample Size Calculator (Evan’s Awesome A/B Tools) (evanmiller.org)</a></li><li><a href="https://www.optimizely.com/sample-size-calculator/">A/B Test Sample Size Calculator (optimizely.com)</a></li></ul><p>You will need the baseline conversion rate and the minimum detectable effect, which is the minimum difference between the control and treatment group.</p><p>For detailed discussions on statistical power and sample size, you can also check these two notes:</p><ul><li><a href="https://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/BS704_Power/BS704_Power_print.html">Power and Sample Size Determination (Boston Univeristy School of Public Health)</a></li><li><a href="https://med.stanford.edu/content/dam/sm/s-spire/documents/WIPvF_EstimatingPowerSampleSize_ATrickey.pdf">Estimating Power and Sample Size (Stanford-Surgery Policy Improvement Research and Education)</a></li></ul></blockquote><p>According to the <a href="https://web.stanford.edu/~kcobb/hrp259/lecture11.ppt">the lecture notes from Stanford</a>, we have this formula:<br>$$<br>n=\frac{r+1}{r}\frac{\sigma^2(Z_\beta+Z_{\alpha/2})^2}{d^2},<br>$$<br>where $n$ is the sample size of the smaller group, $r$ is the ratio of the larger group to the smaller group, $\sigma$ is the standard deviation of the outcome variable, $Z_\beta$ and $Z_{\alpha/2}$ represents the critical value at the desired power and significance level (two-sided testing), and $d$ is the size of the treatment effect (i.e., the difference in means).</p><blockquote><p>All-purpose power formula $Z_\beta=\frac{d}{\text{s.e. of }d}-Z_{\alpha/2}$</p><p>Standard error (s.e.) of $d = \sqrt{\frac{\sigma^2}{n}+\frac{\sigma^2}{rn}}$</p></blockquote><p>Subsequently, this formula can be adapted to a case with a binary metric:<br>$$<br>n=\frac{r+1}{r}\frac{\bar p(1-\bar p)(Z_\beta+Z_{\alpha/2})^2}{(p_1-p_2)^2},<br>$$<br>where $\bar p = (p_1+p_2)/2$. A corresponding Python script is provided in <a href="https://towardsdatascience.com/the-math-behind-a-b-testing-with-example-code-part-1-of-2-7be752e1d06f">a post by Nguyen Ngo</a>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy.stats <span class="keyword">as</span> scs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">min_sample_size</span>(<span class="params">bcr, mde, power=<span class="number">0.8</span>, sig_level=<span class="number">0.05</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns the minimum sample size to set up a split test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        bcr (float): probability of success for control, sometimes</span></span><br><span class="line"><span class="string">        referred to as baseline conversion rate</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        mde (float): minimum change in measurement between control</span></span><br><span class="line"><span class="string">        group and test group if alternative hypothesis is true, sometimes</span></span><br><span class="line"><span class="string">        referred to as minimum detectable effect</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        power (float): probability of rejecting the null hypothesis when the</span></span><br><span class="line"><span class="string">        null hypothesis is false, typically 0.8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        sig_level (float): significance level often denoted as alpha,</span></span><br><span class="line"><span class="string">        typically 0.05</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        min_N: minimum sample size (float)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    References:</span></span><br><span class="line"><span class="string">        Stanford lecture on sample sizes</span></span><br><span class="line"><span class="string">        http://statweb.stanford.edu/~susan/courses/s141/hopower.pdf</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># standard normal distribution to determine z-values</span></span><br><span class="line">    standard_norm = scs.norm(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># find Z_beta from desired power</span></span><br><span class="line">    Z_beta = standard_norm.ppf(power)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># find Z_alpha</span></span><br><span class="line">    Z_alpha = standard_norm.ppf(<span class="number">1</span>-sig_level/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># average of probabilities from both groups</span></span><br><span class="line">    pooled_prob = (bcr + bcr+mde) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    min_N = (<span class="number">2</span> * pooled_prob * (<span class="number">1</span> - pooled_prob) * (Z_beta + Z_alpha)**<span class="number">2</span></span><br><span class="line">             / mde**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> min_N</span><br></pre></td></tr></table></figure><h2 id="Refresher-on-A-B-Testing"><a href="#Refresher-on-A-B-Testing" class="headerlink" title="Refresher on A/B Testing"></a>Refresher on A/B Testing</h2><blockquote><p>This part summarizes <a href="https://hbr.org/2017/06/a-refresher-on-ab-testing">the article</a> published in <em>Harvard Business Review</em>. </p></blockquote><h3 id="How-Does-A-B-Testing-Work"><a href="#How-Does-A-B-Testing-Work" class="headerlink" title="How Does A/B Testing Work?"></a>How Does A/B Testing Work?</h3><p>A/B testing, at its most basic, is a way to compare two versions of something to figure out which performs better. “The A/B test can be considered the most basic kind of randomized controlled experiment,” Fung says. “In its simplest form, there are two treatments and one acts as the control for the other.” <em>As with all randomized controlled experiments, you must estimate the <strong>sample size</strong> you need to achieve a statistical significance, which will help you make sure the result you’re seeing “isn’t just because of background noise</em>,” Fung says.</p><p>Lots of managers run sequential tests — e.g., testing size first (large versus small), then testing color (blue versus red), then testing typeface (Times versus Arial) — because they believe they shouldn’t vary two or more factors at the same time. But according to Fung, that view has been debunked by statisticians. And <em>sequential tests are suboptimal because you’re not measuring what happens when factors interact</em>. For example, it may be that users prefer blue on average but prefer red when it’s combined with Arial. This kind of result is regularly missed in sequential A/B testing because the typeface test is run on blue buttons that have “won” the prior test. </p><p>Using mathematics you can “smartly pick and run only certain subsets of those treatments; then you can infer the rest from the data.” This is called “multivariate” testing in the A/B testing world and often means you end up doing an A/B/C test or even an A/B/C/D test. In the example above with colors and size, it might mean showing different groups: a large red button, a small red button, a large blue button, and a small blue button.</p><h3 id="What-Mistakes-Do-People-Make-When-Doing-A-B-Tests"><a href="#What-Mistakes-Do-People-Make-When-Doing-A-B-Tests" class="headerlink" title="What Mistakes Do People Make When Doing A/B Tests?"></a>What Mistakes Do People Make When Doing A/B Tests?</h3><ul><li><p>First, he says, too many managers don’t let the tests run their course. </p><ul><li>The problem is that, because of randomization, it’s possible that if you let the test run to its natural end, you might get a different result. </li></ul></li><li><p>The second mistake is looking at too many metrics.</p><ul><li>The problem is that if you’re looking at such a large number of metrics at the same time, you’re at risk of making what statisticians call “spurious correlations.” </li><li>In proper test design, you should decide on the metrics you’re going to look at before you execute an experiment and select a few. The more you’re measuring, the more likely that you’re going to see random fluctuations.  </li></ul></li><li><p>Lastly, few companies do enough retesting.</p><ul><li>Even though there may be little chance that any given A/B result is driven by random chance, if you do lots of A/B tests, the chances that at least one of your results is wrong grows rapidly.</li><li>The smaller the improvement, the less reliable the results.  </li></ul></li></ul><p>It’s clear that A/B testing is not a panacea. There are more complex kinds of experiments that are more efficient and will give you more reliable data. But A/B testing is a great way to gain a <em>quick</em> understanding of a question you have.   </p>]]></content>
    
    
    <summary type="html">Hypothesis Testing, A/B Testing</summary>
    
    
    
    
    <category term="Hypothesis Testing" scheme="http://yanghaowang.github.io/tags/Hypothesis-Testing/"/>
    
    <category term="A/B Testing" scheme="http://yanghaowang.github.io/tags/A-B-Testing/"/>
    
  </entry>
  
  <entry>
    <title>Error Types and Measures</title>
    <link href="http://yanghaowang.github.io/posts/20210327-Error-Types-and-Measures"/>
    <id>http://yanghaowang.github.io/posts/20210327-Error-Types-and-Measures</id>
    <published>2021-03-27T20:14:51.000Z</published>
    <updated>2021-10-21T15:13:24.450Z</updated>
    
    <content type="html"><![CDATA[<p>In the context of econometrics and the empirical analysis in microeconomics, we focus on the type I error and pay much attention on p-value evaluated at a given significance level ($\alpha$). I haven’t cared about the type II error and the statistical power of a test ($1-\beta$) quite a while since I worked on some homework problems related to type II error in the graduate school as taking the Mathematical Statistics course.</p><p>When evaluating the results from a A/B testing and comparing the performances of alternative machine learning models, we inevitably encounter quite a few measures pertaining to type I and type II errors. In this post, I am going to review the error types and some relevant measures.</p><h2 id="Error-Types"><a href="#Error-Types" class="headerlink" title="Error Types"></a>Error Types</h2><p>Errors arise in the process of the statistical testing. Let $H_0$ and $H_1$ denote the null and the alternative hypothesis for a test. By calculating a test statistic from an observed sample, we can reject $H_0$ or not. Because of the randomness, we sometimes might make a mistake as concluding with the value of a test statistic. Here is a table explicitly presenting the error types in a statistical test.</p><table><thead><tr><th></th><th align="left">$H_0$ is true</th><th align="left">$H_0$ is not true</th></tr></thead><tbody><tr><td>Reject $H_0$</td><td align="left">Type I error <br>False Positive (FP)</td><td align="left">Correct <br>True Positive (TP)</td></tr><tr><td>Cannot reject $H_0$</td><td align="left">Correct<br>True Negative (TN)</td><td align="left">Type II error <br>False Negative (FN)</td></tr></tbody></table><p>As follows, there are relevant measures build on this table:</p><ul><li><p>Recall, Sensitivity, or True Positive Rate (TPR):<br>$$<br>\frac{TP}{TP+FN}=1-\beta<br>$$<br>where $1-\beta$ represents the statistical power of the test.</p></li><li><p>False Positive Rate (FPR):<br>$$<br>\frac{FP}{FP+TN}=\alpha<br>$$<br>where $\alpha$ represents the significance level of the test.</p><blockquote><p>In a binary classification problem, the TPR and the FPR will vary accordingly as we change the determination threshold in a model (e.g., the cut-off point for a logit model in predicting the credit default).</p><img src="/posts/20210327-Error-Types-and-Measures/AUC.png" class=""><p>A <strong>receiver (or relative) operating characteristic curve</strong>, or <strong>ROC curve</strong>, is a <a href="https://en.wikipedia.org/wiki/Graph_of_a_function">graphical plot</a> that illustrates the diagnostic ability of a <a href="https://en.wikipedia.org/wiki/Binary_classifier">binary classifier</a> system <u>as its discrimination threshold is varied</u>. The method was originally developed for operators of military radar receivers, which is why it is so named.</p><p>The optimal cut-off point on ROC can be determined by one of the three criteria (<a href="http://www.medicalbiostatistics.com/roccurve.pdf">Reference Link</a>):</p><ul><li>The farthest point from the random classifier, that is, max(TPR+FPR), the Youden index</li><li>The closest point to the perfect classifier (0, 1)</li><li>The point minimizing the cost.</li></ul></blockquote></li><li><p>Precision, or Positive Predictive Value (PPV):<br>$$<br>\frac{TP}{TP+FP}<br>$$</p></li><li><p>Specificity, Selectivity, or True Negative Rate (TNR):<br>$$<br>\frac{TN}{TN+FP}=1-\alpha<br>$$</p></li><li><p>Accuracy:<br>$$<br>\frac{TP+TN}{TP+TN+FP+FN}<br>$$</p></li><li><p>F1 Score (Harmonic mean of precision and recall):<br>$$<br>\frac{1}{\frac{1}{2}\frac{1}{\text{Precision}}+\frac{1}{2}\frac{1}{\text{ Recall}}}=2\times\frac{\text{Precision}\times\text{Recall}}{\text{Precision}+\text{Recall}}<br>$$</p><blockquote><p>The harmonic mean is best used for fractions such as rates.</p><p>For example, Joe drives a car at 10 mph for the half of the journey and 40 mph for the second half. What’s his average speed? The naïve answer is to calculate the total mileage of the journey and then divide it by the total drive time. Denote the total mileage of the journey as $x$ and the total drive time is $\frac{0.5x}{10}+\frac{0.5x}{40}$. Therefore, the average speed is $x/\left(\frac{0.5x}{10}+\frac{0.5x}{40}\right)=16$ mph.</p></blockquote></li></ul><h2 id="Trade-off-between-Errors"><a href="#Trade-off-between-Errors" class="headerlink" title="Trade-off between Errors"></a>Trade-off between Errors</h2><p>We cannot reduce the type I error (false positive) and the type II error (false negative) at the same time, once a testing environment is fixed and the observed results are given. Usually, we set the expected result as the alternative hypothesis $H_1$ and prefer minimizing $\alpha$ in a statistical test, the probability that we incorrectly reject $H_0$.</p><p>The figure below presents the change in $\alpha$ and $\beta$ as the cut-off point is altered in a given test. By construction, we would like to differentiate the distributions under $H_0$ and $H_1$ as much as possible.</p><img src="/posts/20210327-Error-Types-and-Measures/PPV_NPV_Sensitivity_and_Specificity.png" class=""><p>In this figure, it is easy to see the specificity ($=1-\alpha$, also known as the confidence level) and the sensitivity ($=1-\beta$, also known as the statistical power of the test) representing the “true” portion of the $H_0$ distribution and the $H_1$ distribution, respectively.</p>]]></content>
    
    
    <summary type="html">type I error, type II error, measures built on errors, terms from a confusion matrix, ROC, AUC</summary>
    
    
    
    
    <category term="Error Types" scheme="http://yanghaowang.github.io/tags/Error-Types/"/>
    
    <category term="Confusion Matrix" scheme="http://yanghaowang.github.io/tags/Confusion-Matrix/"/>
    
    <category term="Hypothesis Testing" scheme="http://yanghaowang.github.io/tags/Hypothesis-Testing/"/>
    
  </entry>
  
  <entry>
    <title>SQL JOIN with the WHERE and the ON Clause</title>
    <link href="http://yanghaowang.github.io/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause"/>
    <id>http://yanghaowang.github.io/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause</id>
    <published>2021-02-07T00:53:06.000Z</published>
    <updated>2021-04-10T19:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>When merging tables with selected rows in SQL, we often think of using the <code>JOIN</code> statement with the <code>WHERE</code> and the <code>ON</code> clause. The resulting table would depend on the inclusion of filters in the <code>WHERE</code> or the <code>ON</code> clause. To illustrate this difference, I employ the SQL examples from <a href="https://mode.com/sql-tutorial/sql-joins-where-vs-on/">a MODE tutorial page</a>.</p><h2 id="Filtering-in-The-ON-Clause"><a href="#Filtering-in-The-ON-Clause" class="headerlink" title="Filtering in The ON Clause"></a>Filtering in The <code>ON</code> Clause</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> companies.permalink            <span class="keyword">AS</span> companies_permalink,</span><br><span class="line">       companies.name                 <span class="keyword">AS</span> companies_name,</span><br><span class="line">       acquisitions.company_permalink <span class="keyword">AS</span> acquisitions_permalink,</span><br><span class="line">       acquisitions.acquired_at       <span class="keyword">AS</span> acquired_date</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.crunchbase_companies         companies</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tutorial.crunchbase_acquisitions acquisitions</span><br><span class="line">    <span class="keyword">ON</span> companies.permalink = acquisitions.company_permalink</span><br><span class="line">   <span class="keyword">AND</span> acquisitions.company_permalink != <span class="string">&#x27;/company/1000memories&#x27;</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><blockquote><p><code>ORDER BY 1</code> is equivalent to <code>ORDER BY companies.permalink</code> </p></blockquote><p>The conditional statement <code>AND...</code> is evaluated <strong>before</strong> the join occurs. Particularly, the <code>AND</code> statement is evaluated on the joining  table (i.e., <code>acquisitions</code>) rather than the target table (i.e., <code>companies</code>). Hence, the 1000memories permalink is still displayed in the column that pulls from the target table (i.e., <code>companies</code>).</p><img src="/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause/UsingWhereOrON_1.png" class=""><h2 id="Filtering-in-The-WHERE-Clause"><a href="#Filtering-in-The-WHERE-Clause" class="headerlink" title="Filtering in The WHERE Clause"></a>Filtering in The <code>WHERE</code> Clause</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> companies.permalink            <span class="keyword">AS</span> companies_permalink,</span><br><span class="line">       companies.name                 <span class="keyword">AS</span> companies_name,</span><br><span class="line">       acquisitions.company_permalink <span class="keyword">AS</span> acquisitions_permalink,</span><br><span class="line">       acquisitions.acquired_at       <span class="keyword">AS</span> acquired_date</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.crunchbase_companies         companies</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tutorial.crunchbase_acquisitions acquisitions</span><br><span class="line">    <span class="keyword">ON</span> companies.permalink = acquisitions.company_permalink</span><br><span class="line"> <span class="keyword">WHERE</span> acquisitions.company_permalink != <span class="string">&#x27;/company/1000memories&#x27;</span></span><br><span class="line">    <span class="keyword">OR</span> acquisitions.company_permalink <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>If you move the same filter to the <code>WHERE</code> clause, you will notice that the filter happens <strong>after</strong> the tables are joined. The result is that the 1000 memories row is joined onto the original table, but then it is filtered out entirely (in both tables) in the <code>WHERE</code> clause before displaying results (it would have been between the two highlighted lines in the resulting table below).</p><img src="/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause/UsingWhereOrON_2.png" class=""><p>Note <em>that filtering in the</em> <code>WHERE</code> <em>clause can also filter null values</em>, so we added an extra line to make sure to include the nulls.</p><blockquote><p>The null values will not be evaluated using comparison operators.</p><img src="/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause/UsingWhereOrON_3.png" class=""></blockquote>]]></content>
    
    
    <summary type="html">Use JOIN with the WHERE and the ON clause in SQL</summary>
    
    
    
    
    <category term="SQL" scheme="http://yanghaowang.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Git Quick Start</title>
    <link href="http://yanghaowang.github.io/posts/20201201-Git-Quick-Start"/>
    <id>http://yanghaowang.github.io/posts/20201201-Git-Quick-Start</id>
    <published>2020-12-01T22:21:37.000Z</published>
    <updated>2021-10-21T22:02:11.715Z</updated>
    
    <content type="html"><![CDATA[<p>I began my GitHub journey with <a href="https://desktop.github.com/">GitHub Desktop</a>, a  <a href="https://git-scm.com/downloads">Git</a> GUI client for Windows users. Recently, I switch to Git and find it worth to invest some time in learning it by using.</p><p class='twelve columns' style="text-align: center;"><img src="/posts/20201201-Git-Quick-Start/GitBasics.png" class=""></p><h2 id="Quick-Start-for-Git-in-Windows"><a href="#Quick-Start-for-Git-in-Windows" class="headerlink" title="Quick Start for Git in Windows"></a>Quick Start for Git in Windows</h2><ol><li><p>Download and install Git via this link <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a></p></li><li><p>Connect to GitHub using SSH keys</p><p>With SSH keys, we can connect to GitHub without supplying your username and personal access token at each visit.</p><ul><li><p>Learn more <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/about-ssh">about SSH</a></p></li><li><p>Check for existing SSH keys</p><p><a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/checking-for-existing-ssh-keys">Instruction page</a> from GitHub Docs</p><blockquote><p>Novice Note:</p><ol><li>The physical directory in Windows is <code>C:\Users\&lt;user name&gt;\.ssh\</code>, where <code>.ssh</code> is a hidden folder by default</li><li><a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generate a new SSH key</a> if needed</li></ol></blockquote></li><li><p>Add your SSH to the local ssh-agent and your GitHub account</p><blockquote><p>Novice Note: </p><ol><li><p>Use Git Bash to start the ssh-agent in the background. Command Prompt does not recognize <code>eval</code> command.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># start the ssh-agent in the background</span></span><br><span class="line">$ <span class="built_in">eval</span> $(ssh-agent -s)</span><br><span class="line">&gt; Agent pid &lt;your pid number&gt;</span><br></pre></td></tr></table></figure></li><li><p>Go to your GitHub setting page and follow <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account">this instruction</a> from GitHub Docs</p></li></ol></blockquote></li><li><p>Test the SSH connection</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ssh</span> -T git@github.com</span><br><span class="line">&gt; Hi &lt;GitHub username&gt;! You\<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>Start a project with GitHub using the command line</p><p><a href="https://docs.github.com/en/free-pro-team@latest/github/importing-your-projects-to-github/adding-an-existing-project-to-github-using-the-command-line">Instruction page</a> from GitHub Docs</p><blockquote><p>Novice Note:</p><ol><li><p>We can interchangeably use Git Bash and Command Prompt in Windows</p></li><li><p>My colleague suggests me use <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/about-ssh">SSH</a> instead of HTTPS when adding the URL for the remote repository</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sets the new remote</span></span><br><span class="line">$ git remote add origin &lt;remote repository SSH URL&gt;</span><br><span class="line"><span class="comment"># Verifies the new remote URL</span></span><br><span class="line">$ git remote -v</span><br></pre></td></tr></table></figure></li><li><p>We can give a name to the origin branch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pushes our local repository up to the remote repository we specify as the origin</span></span><br><span class="line">$ git push origin &lt;branch name&gt;</span><br></pre></td></tr></table></figure></li></ol></blockquote></li></ol><h2 id="Git-Reference"><a href="#Git-Reference" class="headerlink" title="Git Reference"></a>Git Reference</h2><p>Cheat Sheet: <a href="https://training.github.com/downloads/github-git-cheat-sheet/">https://training.github.com/downloads/github-git-cheat-sheet/</a></p><p>Video Tutorial: <a href="https://git-scm.com/videos">https://git-scm.com/videos</a></p><p>Documentation: <a href="https://git-scm.com/docs">https://git-scm.com/docs</a></p><p>My colleague, Jianghao, shares his note on using Git via this page: <a href="https://jianghaochu.github.io/version-control-with-git.html">https://jianghaochu.github.io/version-control-with-git.html</a></p>]]></content>
    
    
    <summary type="html">Git, GitHub, Git Basics, Windows Users</summary>
    
    
    
    
    <category term="Git" scheme="http://yanghaowang.github.io/tags/Git/"/>
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
  </entry>
  
  <entry>
    <title>Google Drive plus Git</title>
    <link href="http://yanghaowang.github.io/posts/20201201-Google-Drive-plus-Git"/>
    <id>http://yanghaowang.github.io/posts/20201201-Google-Drive-plus-Git</id>
    <published>2020-12-01T20:21:37.000Z</published>
    <updated>2021-10-21T14:27:40.335Z</updated>
    
    <content type="html"><![CDATA[<p>Collaboration is a multiplier for our achievement in the era of the Internet. I have heard about <a href="https://github.com/features">GitHub</a> for a long time but just started using GitHub <em>intensively</em> last month. In contrast, I have been constantly using <a href="https://www.google.com/intl/en/drive/">Google Drive</a> since 2013. It is not a “either/or” question. On the contrary, we can leverage the power of both.</p><h2 id="Generic-Solution-for-Sharing-and-Synchronizing-Files-Google-Drive"><a href="#Generic-Solution-for-Sharing-and-Synchronizing-Files-Google-Drive" class="headerlink" title="Generic Solution for Sharing and Synchronizing Files: Google Drive"></a>Generic Solution for Sharing and Synchronizing Files: Google Drive</h2><p>GitHub is a popular and well-known tool for IT people when it comes to collaboration in coding. You can simply find tons of reasons convincing people to manager and store their coding scripts using GitHub. However, most of my friends who are not intensively involved in coding have not considered about it. Honestly, I don’t use GitHub very often because of two reasons:</p><ol><li>I use Google Drive which also allows me to retrieve files from the cloud,</li><li>I am not worried about version control. If needed, I will make a copy and title it using an extended name with a time stamp. </li></ol><p>I am always enthused to collaborate with other scholars in doing research and have had pleasant experience in writing academic papers with my co-authors. Most of time, we will divide a long list of tasks into parts, one for each. It is a quite efficient way to do research and a file storage and synchronization service provided by Google Drive (or One Drive and Dropbox) is good enough for us. In my past experience, there is few chance, if possible, that multiple people would work on the same part of a coding script.</p><h2 id="Version-Control-Solution-GitHub"><a href="#Version-Control-Solution-GitHub" class="headerlink" title="Version Control Solution: GitHub"></a>Version Control Solution: GitHub</h2><p>Probably, it is not a good idea to store numbers of copies in a local archive folder. These copies might waste the space in our drive. As a result, there are quite a few times that we need to consider about version control and think of the potential maintenance and further development of existing programs. For example, </p><ol><li>I need to fix a problem in an existing script and update it when the problem is resolved, and</li><li>I might also work together with colleagues on a big project and write some scripts that will be shared within the team.</li></ol><h3 id="GitHub-Desktop-or-Git"><a href="#GitHub-Desktop-or-Git" class="headerlink" title="GitHub Desktop or Git"></a>GitHub Desktop or Git</h3><p><a href="https://desktop.github.com/">GitHub Desktop</a> is a <a href="https://git-scm.com/downloads">Git</a> GUI client for Windows users. It is user friendly and easy to manage your files in local and synchronize them with the copies in GitHub online repositories.</p><p>I began my GitHub journey with GitHub Desktop. Since most of my recent work involves in using a Linux server with command lines, <em>I switch to Git and find it worth to spend some time in learning how to use it</em>.</p><p>Git is small and fast. Written in C and built to work on the Linux kernel, it has had to effectively handle large repositories from day one. <a href="https://git-scm.com/about/small-and-fast">According to its official introduction page, speed and performance has been a primary goal in the design of Git from start</a>. Note that it can also be used in Windows Command Prompt.</p>]]></content>
    
    
    <summary type="html">Collaboration, Synchronization, Version Control</summary>
    
    
    
    
    <category term="Git" scheme="http://yanghaowang.github.io/tags/Git/"/>
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
  </entry>
  
  <entry>
    <title>LaTex Display in Hexo</title>
    <link href="http://yanghaowang.github.io/posts/20201125-LaTex-Display-in-Hexo"/>
    <id>http://yanghaowang.github.io/posts/20201125-LaTex-Display-in-Hexo</id>
    <published>2020-11-25T23:31:58.000Z</published>
    <updated>2020-12-06T22:36:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>One of my motivations to set up my site using Hexo and Github is that I can easily post some notes including some formulas as I write in LaTex in markdown documents. Therefore, I look for a solution for displaying LaTex formulas in Hexo.</p><h2 id="Hexo-Plugins"><a href="#Hexo-Plugins" class="headerlink" title="Hexo Plugins"></a>Hexo Plugins</h2><p>First, I visit the Hexo website and <a href="https://hexo.io/plugins/index.html">search for a Hexo plugin</a> fitting my needs.</p><p>By typing “math” in the search box, I find two relevant plugins, <a href="https://github.com/hexojs/hexo-math">hexo-math</a> and <a href="https://github.com/next-theme/hexo-filter-mathjax">hexo-filter-mathjax</a>. Taking a further look for both plugins, I find the syntax of hexo-math to initiate the math box is different than the LaTex writing in markdown documents. Particularly, the prefix and suffix of the math box in hexo-math for KaTex and Mathjax are</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% katex %&#125;</span><br><span class="line">a^&#123;b&#125;_&#123;c&#125;</span><br><span class="line">&#123;% endkatex %&#125;</span><br></pre></td></tr></table></figure><p>and</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mathjax %&#125;</span><br><span class="line">a^&#123;b&#125;_&#123;c&#125;</span><br><span class="line">&#123;% endmathjax %&#125;</span><br></pre></td></tr></table></figure><p>as well as some global settings in the front-matter of an article.</p><p>In contrast, the associated syntax in hexo-filter-mathjax is as same as the LaTex writing in markdown documents. Both are using one dollar sign to begin and end the inline math box and two dollar signs for the math box.</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">a^&#123;b&#125;_&#123;c&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>Without doubt, I choose hexo-filter-mathjax and install it in the working directory.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;root-directory-of-your-blog&gt;</span><br><span class="line">$ npm install hexo-filter-mathjax</span><br></pre></td></tr></table></figure><br><h2 id="Conflict-between-LaTex-and-Markdown-Syntax"><a href="#Conflict-between-LaTex-and-Markdown-Syntax" class="headerlink" title="Conflict between LaTex and Markdown Syntax"></a>Conflict between LaTex and Markdown Syntax</h2><p>However, hexo-filter-mathjax is not a fully quick fix. As mentioned in its documentations, hexo-filter-mathjax may have some problem when there are some underscores included, since an underscore (<code>_</code>) may be interpreted as the start of italic text in Markdown, or subscripted mark in TeX. To resolve this conflict, we need to use <code>\</code> in front of <code>_</code>.</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: XXX</span><br><span class="line">date: XXX</span><br><span class="line">mathjax: true ## case insentitive</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">Equation 1</span><br><span class="line">$$</span><br><span class="line">a^&#123;b&#125;<span class="emphasis">_&#123;c&#125; \times a^&#123;b&#125;_</span>&#123;c&#125;</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">Equation 2</span><br><span class="line">$$</span><br><span class="line">a^&#123;b&#125;\<span class="emphasis">_&#123;c&#125; \times a^&#123;b&#125;\_</span>&#123;c&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>Note that Equation 1 will be displayed as “a^{b}<em>{c} \times a^{b}</em>{c}” while Equation 2 will be presented properly.</p><h2 id="Another-Recommended-Hexo-Plugin"><a href="#Another-Recommended-Hexo-Plugin" class="headerlink" title="Another Recommended Hexo Plugin"></a>Another Recommended Hexo Plugin</h2><p>As suggested in the documentation of hexo-filter-mathjax, I install <a href="https://github.com/wzpan/hexo-renderer-pandoc">hexo-renderer-pandoc</a> to address this issue. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;root-directory-of-your-blog&gt;</span><br><span class="line">$ npm install hexo-renderer-pandoc</span><br></pre></td></tr></table></figure><blockquote><p>Note: hexo-renderer-pandoc is built in the environment where pandoc has been installed. Hence, I intall <a href="https://pandoc.org/installing.html">pandoc</a> using <a href="https://chocolatey.org/">Chocolatey</a>. Chocolatey was installed (automatically by default) as I installed Node.js by allowing it to install any necessary package.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> choco install pandoc</span></span><br></pre></td></tr></table></figure><p>So far, I have two hexo plugins (i.e., hexo-filter-mathjax and hexo-render-pandoc) installed in the working directory of my blog.</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> check the installations</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> &lt;root-directory-of-your-blog&gt;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm list</span></span><br></pre></td></tr></table></figure><p>By turning on the mathjax option in the markdown document, I am able to directly post the article on my site without further edits.</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: XXX</span><br><span class="line">date: XXX</span><br><span class="line">mathjax: true ## case insentitive</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">Equation 1</span><br><span class="line">$$</span><br><span class="line">a^&#123;b&#125;<span class="emphasis">_&#123;c&#125; \times a^&#123;b&#125;_</span>&#123;c&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>Now, Equation 1 can be displayed as expected. In the exported html page, this formula is presented as a <a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG image</a>.</p><h2 id="One-More-Thing-for-The-Lazy"><a href="#One-More-Thing-for-The-Lazy" class="headerlink" title="One More Thing for The Lazy"></a>One More Thing for The Lazy</h2><p>Though a SVG image is print-friendly, it does not allow readers to copy the formula in LaTex codes for other use. As one of the lazy, I do one more thing for my peers, that is, pasting the script for loading the mathjax html extension to <code>post.ejs</code> (e.g., line 3 to 5 in the code box below).</p><blockquote><p><code>post.ejs</code> defines the post template in the directory of the theme’s layout.</p></blockquote><p>In addition, once the mathjax script is included in the post template, I no longer need to add <code>mathjax: true</code> in the front-matter of the post. In other words, the mathjax script is a substitue for the package <code>hexo-filter-mathjax</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;&lt;%- page.title %&gt;&lt;&#x2F;h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;polyfill.io&#x2F;v3&#x2F;polyfill.min.js?features&#x3D;es6&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; id&#x3D;&quot;MathJax-script&quot; async</span><br><span class="line">  src&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3&#x2F;es5&#x2F;tex-chtml.js&quot;&gt;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">MathJax &#x3D; &#123;</span><br><span class="line">  tex: &#123;</span><br><span class="line">    inlineMath: [[&#39;$&#39;, &#39;$&#39;], [&#39;\\(&#39;, &#39;\\)&#39;]]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- page.content%&gt;</span><br></pre></td></tr></table></figure><blockquote><p>Codes in Line 10 enable the browser to properly display the inline formulas between two dollar signs. More detailed information about the configuration of MathJax is available in its <a href="http://docs.mathjax.org/en/latest/web/configuration.html">documentation page</a>.</p></blockquote><p>As follows, when reading the formula in the post, I am able to copy the formula’s LaTex codes.</p><img src="/posts/20201125-LaTex-Display-in-Hexo/codedisplaymenu.png" class=""><br>]]></content>
    
    
    <summary type="html">hexo plugins, LaTex, Markdown, hexo-filter-mathjax, hexo-renderer-pandoc</summary>
    
    
    
    
    <category term="Hexo" scheme="http://yanghaowang.github.io/tags/Hexo/"/>
    
    <category term="LaTex" scheme="http://yanghaowang.github.io/tags/LaTex/"/>
    
  </entry>
  
  <entry>
    <title>Hello World and Thank You Hexo</title>
    <link href="http://yanghaowang.github.io/posts/20201123-Hello-World-and-Thank-You-Hexo"/>
    <id>http://yanghaowang.github.io/posts/20201123-Hello-World-and-Thank-You-Hexo</id>
    <published>2020-11-24T03:31:58.000Z</published>
    <updated>2020-12-06T21:38:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to my site powered by <a href="https://hexo.io/">Hexo</a> and hosted on <a href="https://github.com/yanghaowang/yanghaowang.github.io">GitHub</a>! This is my very first post. </p><h2 id="Why-Hexo-and-GitHub"><a href="#Why-Hexo-and-GitHub" class="headerlink" title="Why Hexo and GitHub"></a>Why Hexo and GitHub</h2><p>I was using and maintaining a homepage on another free hosting site. Through the web interface provided by the hosting site, I can set up a homepage easily and customize it conveniently. It perfectly serves my needs for sharing some info and posts in words. Now, I am thinking of sharing some technical notes that include displays of $\LaTeX$ formulas and codes. </p><p>I am writing markdown documents using Typora and compile my notes with R codes in <code>.Rmd</code> files using RStudio and with python codes in <code>.ipynb</code> files using Jupyter Notebook.</p><table><thead><tr><th align="center">Typora</th><th align="center">Rstudio</th><th align="center">Jupyter Notebook</th></tr></thead><tbody><tr><td align="center"><a class="footer-link" href="https://typora.io/"><img class="img-hov" src="/images/typora_logo.png" width="72px"></a></td><td align="center"><a class="footer-link" href="https://rstudio.com"><img class="img-hov" src="/images/rstudio_logo.png" width="136px"></a></td><td align="center"><a class="footer-link" href="https://jupyter.org"><img class="img-hov" src="/images/jupyter_logo.png" width="56px"></a></td></tr></tbody></table><blockquote><p>Note: Both <code>.Rmd</code> files and <code>.ipynb</code> files can be exported as markdown-formatted documents. </p></blockquote><p>Also, I prefer not spending extra time on format editing for posting them on my site. The less effort in format editing, the better. Ideally, it would be wonderful if I can directly post the contents of my markdown-formatted documents.</p><p>After doing little search online, I find Hexo enables me to publish a post in Markdown and GitHub provides a space for hosting the site. So I decide to move 🚚 and start using the combo 🍔.</p><h2 id="Create-Your-Own-Site"><a href="#Create-Your-Own-Site" class="headerlink" title="Create Your Own Site"></a>Create Your Own Site</h2><p>If you are thinking of building your own site, there are a couple of things you need to do:</p><ol><li><p>Download and install these two programs in your local PC</p><ul><li><p>Node.js [<a href="https://nodejs.org/en/download/">Download Page</a>]</p><ul><li>npm is distributed with <a href="https://nodejs.org/">Node.js</a>- which means that when you download Node.js, you automatically get npm installed on your computer.</li></ul></li><li><p>Git [<a href="https://git-scm.com/downloads">Download Page</a>]</p></li><li><p>Check the program versions in Command Prompt (for Windows) if installations succeed</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># check the version of node.js and npm</span></span><br><span class="line">$ node -v</span><br><span class="line">$ npm -v</span><br><span class="line"><span class="comment"># check the version of git</span></span><br><span class="line">$ git version</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Register a GitHub account and set up Git in your local PC following <a href="https://docs.github.com/en/free-pro-team@latest/github/getting-started-with-github/set-up-git">this GitHub instruction</a> </p></li><li><p>Create a site using Hexo </p><ul><li><p>Watch <a href="https://www.youtube.com/watch?v=Kt7u5kr_P5o&list=PLLAZ4kZ9dFpOMJR6D25ishrSedvsguVSm">Hexo tutorial videos on Youtube</a> </p></li><li><p>Review this <a href="https://hexo.io/docs/">Hexo documentation</a> for more info</p></li><li><p>Ask your questions, if any, on this <a href="https://github.com/hexojs/hexo/issues">GitHub page</a> or look for an solution in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># download hexo client</span></span><br><span class="line">$ npm install -g hexo-cli</span><br><span class="line"><span class="comment"># check the version of git</span></span><br><span class="line">$ hexo -v</span><br><span class="line"><span class="comment"># download hex plugins (example)</span></span><br><span class="line">$ npm install hexo-renderer-pandoc</span><br><span class="line"><span class="comment"># initiate a blog</span></span><br><span class="line">$ hexo init &lt;type-your-blog-name&gt;</span><br><span class="line">$ <span class="built_in">cd</span> &lt;type-your-blog-name&gt;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Choose a theme from <a href="https://hexo.io/themes/index.html">Hexo Theme Gallery</a></p></li></ol><h2 id="Quick-Start-for-Hexo"><a href="#Quick-Start-for-Hexo" class="headerlink" title="Quick Start for Hexo"></a>Quick Start for Hexo</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    <summary type="html">Why Hexo and GitHub, Create Own Site, LaTex, Markdown</summary>
    
    
    
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Hexo" scheme="http://yanghaowang.github.io/tags/Hexo/"/>
    
  </entry>
  
</feed>
