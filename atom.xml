<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Home - Yanghao Wang</title>
  
  
  <link href="http://yanghaowang.github.io/atom.xml" rel="self"/>
  
  <link href="http://yanghaowang.github.io/"/>
  <updated>2022-04-05T05:01:30.346Z</updated>
  <id>http://yanghaowang.github.io/</id>
  
  <author>
    <name>Yanghao Wang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>不一样的清明节</title>
    <link href="http://yanghaowang.github.io/posts/20220405-My-Different-Qingming"/>
    <id>http://yanghaowang.github.io/posts/20220405-My-Different-Qingming</id>
    <published>2022-04-05T04:06:32.000Z</published>
    <updated>2022-04-05T05:01:30.346Z</updated>
    
    <content type="html"><![CDATA[<p><em>This is a post written by my father to my loved grandpa.</em></p><h1 id="不一样的清明节"><a href="#不一样的清明节" class="headerlink" title="不一样的清明节"></a>不一样的清明节</h1><p>——纪念父亲离世一周年</p><p>今年的清明日，刚好是父亲离开我们一周年的日子，也是计划上我们兄妹五人为父亲第一次做清明的日子。可是计划不如变化快，近期全国各地新冠疫情似乎更加严重了，南昌、婺源都有零星病例，我们兄妹五人也因此不能返乡。没想到去年清明节在卧榻旁的守候，竟成了我们最后的相处时光。回想年少时和成年后的过往，记忆慢慢变得模糊起来。故趁这两天空闲，把记忆里最深刻的，时常回想的片段，用文字记录下来，当作这个清明节对父亲的思念吧。父亲，我们想念父亲。</p><img src="/posts/20220405-My-Different-Qingming/grandpa.jpg" class=""><h2 id="记忆中的清明"><a href="#记忆中的清明" class="headerlink" title="记忆中的清明"></a>记忆中的清明</h2><p>往年清明节当天，都是父亲领着我们兄妹几个，上午去上坟，逐个祭拜爷爷奶奶，母亲，及更早的祖辈，挂些纸钱，烧些纸金银包、冥币。晚上在祖屋厅堂供上米饭鱼肉，点香祭拜列祖列宗，每次重复默念的祭词总少不了“父亲不要睡着了，要保佑父亲一身之下的人，保佑大家在外上车下车平平安安、工作顺顺利利，小孩读书年年升级、步步升高，好人相逢，恶人躲避……”。</p><p>从1982年到南昌读书，再到84年毕业分配至上饶工作起，因路途遥远、交通不便，记忆中就没有回官坑过清明了。但唇齿间总回味着清明果、蕨菜、小竹笋、猪头花[①]等家乡食物的味道，脑海里放映着石板路旁、小河边、房前屋后、稻田里、漫山遍野的各种油菜花、野花盛开的景象。到1998年，我考取了机动车驾驶证，从此就能自己开车往返工作地和官坑了。再后来，交通路况也逐步好起来了，也买了私家车。虽然因工作变动，我搬到了南昌，但感觉回官坑的路程也不那么遥远了。往后，官坑就成了清明节必须去的地方，这个习惯也就慢慢变成了责任。</p><h2 id="模范农民"><a href="#模范农民" class="headerlink" title="模范农民"></a>模范农民</h2><p>小学期间的事，因为年纪小，我大多已经记不得了。只是模糊记着，读小学的时候，我不爱读书，家里给每个人都分配了任务。我的主要任务是早晚放牛，牵牛喝水，投放牛料，打猪草。没有事的时候，我会经常跑到六队队屋里玩。那时父亲是生产队会计，每到生产队分玉米、分红薯的时候，我们小孩就特别高兴，而父亲就要算账，特别忙。每人或每户应分多少，按什么标准（权重）分，而且那时只能用算盘来加减乘除。因此，父亲也成了乡间算盘高手。有一次，县茶厂来招统计员，办事的专员发现父亲是乡间秀才，希望调父亲去县茶厂，可后来大队不同意，就此作罢。那时父亲也常常跟我们讲，经手财会类的事，一分钱都不能少、不能错。后来父亲也不止一次跟我们讲起一个事。有次生产队的社员质疑有一笔上级补助款大家没有分到，而且是好多年前的事。父亲就把账本、单据找出来跟大家仔细讲，多少用于计划生育妇女补助，多少替大家抵交农业税等等，讲得大家心服口服。平常父亲也跟我们几个兄妹讲“命里有时终须有，命里无时莫强求”，我们也时刻把父亲的话记在心里。</p><p>去年这个时候我们在父亲房间为他守灵时，看到父亲房间里两把用得破旧的算盘和一些记着生产队账务的落满灰尘的账本、发黄的单据依然挂在昏暗的木板墙上。</p><p>也许因为父亲读了点书，且特别尊尚传统文化、古人警言，常常在跟没有读过书的社员们讲道理时，挂着口头禅，经常说“过去老几（辈）人，如何如何,我们应该怎样怎样”。因此，村里人给父亲取了个绰号，叫“清朝”。</p><p>当年父亲不仅队长、会计做得称职，田地里的农活、挑驮力气活样样不落下。父亲常常跟我们讲，那时到秋口挑米，到屯溪挑茶是家常便饭。还说有一次清明前后挑担路过段莘溪边一户亲戚家，一口气吃了十八个清明果，可见长途挑担体力消耗之大。</p><p>还有一次，不记得我和兄弟谁，进七里源砍柴回家，路过上村对面父亲做砖瓦的草棚时，肚子饿得难受。父亲赶紧跑到棚边上，摘了一个自己种的嫩南瓜，炒起来让我们当饭吃，我们非常高兴，父亲也经常当笑话说起这事。</p><h2 id="自力更生建房"><a href="#自力更生建房" class="headerlink" title="自力更生建房"></a>自力更生建房</h2><p>记得1976年，我11岁，家里人多，祖上分下来的老屋住不下了。经过大队批准，父亲开始在太平灶北边的一个山坳里伐木，从段莘水库移民老屋基捡挑旧砖，在老屋后边大约80平米的菜园地里做了两直传统木屋。父亲常在我们面前自豪地说，当时猪肉价0.74元一斤，做这栋房屋请工匠等总共花费现金大约两千元，其余基本都是自己完成。我和华锋哥虽然也常常帮忙去山上驮一些小方料，放学后也到官坑口挑几块砖，但那时我们力气很小，只能帮一点点忙。想来父亲到老年，右肩驼得厉害，比左肩凸出好多，可能是中年时用力过度所致。何况当时驮木头，从山坳里上来要经过500米左右的羊肠上坡路。官坑也没通公路，从官坑口挑砖也要经过一段600米左右的上岭。一座房子的物料需要多少次日日夜夜的挑运啊！</p><p>终于在1978年，一家人住进了新屋，小弟华斌就是在新屋里出生的。也就是这段日子，父亲自力更生、勤劳节俭、精打细算的特质影响了我们兄妹几个一辈子。</p><h2 id="送我读书"><a href="#送我读书" class="headerlink" title="送我读书"></a>送我读书</h2><p>1979年，我在官坑附中读完两年制初中，毕业后前往河坑源段莘乡中学读高中。第一次要离开父母，离开官坑，住校读书。可能是年龄小不懂事，不习惯陌生环境，读书兴趣也不高。记得读了一个多月，便借故跑回家里不想读，拿起镰刀就要上山砍柴去，硬是被父亲打回学校的。印象中那是被打得最厉害的一次，我也感觉当时是我犟得最厉害的一次，还回嘴对骂，言语也很难听。如果要说一辈子我有什么对不住父母的话，那是唯一的一次，也是最后悔的一次。</p><p>两年高中，我很快就混到了毕业，1981年第一次参加高考。也许是段莘中学英语教学差，大家基本上都报考中专，结果只有一个女生去了上饶卫校。记得恢复高考前几年，段莘中学考上的人很少。官坑村只有两个人，一个是同一个生产队的汪新华，读了上饶师范，另一个是堂叔汪天祥，读了上饶卫校。后来不知是因为官坑有个慈祥的长辈洪应天老师在江湾中学当校长之故，还是华锋哥学了一年手艺又回到学校想读书的事影响了我，或是受父亲经常在我们面前讲“万般皆下品，唯有读书高”的影响，1981年下半年我又到江湾中学复读去了。</p><p>记得当时16岁的我，也许是农村人那时普遍营养不良，体重大约70斤左右，很是瘦小。第一天去江湾中学报到是父亲挑着被子和木箱子送我走路去的。快到江湾中学附近，路过一片雪梨地时，记得父亲买了两个让我们尝了尝。</p><p>从那天开始，我感觉才真正懂事了，才开始刻苦读书了。一方面，想想父母送两兄弟复读，在农村的确不易，也不多见。另一方面，或许是暑假期间跟着母亲田地里除草，热得受不了。或许是上山摘箬皮卖钱时，头怕山蜂，脚怕毒蛇的情景刺激着我。功夫没有白费，一年后终于以江湾中学第一名的成绩被录取到江西银行学校农村金融专业，更高兴的是华锋哥也同时考进了上饶农校。</p><h2 id="家书抵万金"><a href="#家书抵万金" class="headerlink" title="家书抵万金"></a>家书抵万金</h2><p>在通讯落后、交通不便的日子里，“家书抵万金”是现在很多年轻人无法体会的。就是一元钱的路费常常也舍不得花，乡愁就只能浓缩在一枚八分钱的邮票里了。从到了南昌读书后，直到上世纪九十年代末，与家里的联系就靠这枚小小的邮票了。</p><p>我和华锋哥进了中专学校读书后，乡村里许多一辈子跟泥土打交道的亲戚朋友都很羡慕。可是命运却开了个不小的玩笑，好像上帝故意要考验父亲一样，坏消息一个接一个：1982年下半年母亲生病，后来被诊断出是鼻咽癌；1983年大弟华树又生了一次大病，送外地就医；再后来父亲在田里干活时手又被蛇咬了……这些都靠书信来往得知。那时很希望一下课就能收到家里的来信，但信捏在自己手里的时候，又不敢拆开，怕看到坏消息。最后，最不幸的事还是发生了，1983年5月母亲还是离世了。</p><p>再后来，父亲家事、农活一个人更忙了，还有弟妹要读书要照顾抚养，有时一两个月都没有时间回我们的信。时间长了，心里就格外担心害怕。直到我和华锋哥毕业参加工作，一切才慢慢好起来。这时我们不仅常常写信向父亲报告一些好消息，也会通过邮局寄点钱回家补贴家用。</p><p>1988年，我写信回家，告诉父亲我找对象了，1989年春节带回官坑过年。父亲虽然言语不多，但内心的高兴还是看得出来的。当年4月28日，父亲和华锋哥来上饶参加我的结婚典礼，记得那天晚上，父亲们很晚到上饶。一方面是客车在路上耽误了，另一方面是两个人都没有来过上饶，下车后不认识路。那时小城市即买不到地图，路牌也很不规范，更没有电话手机。记得到我单位上饶农业银行都晚上十点钟了。第二天，新娘下婚车放鞭炮时，父亲也许是激动紧张，用一根火柴，划了好几次都未成功。这时我的一位退休留用的阿姨同事，一把抓过父亲手中的火柴，几根火柴一起划，着了，鞭炮响了。后来，我那位阿姨同事常常在我面前提起这个小插曲。</p><p>1990年2月小岛出生，我也是第一时间写信向父亲报喜。转眼到了1994年，华树毕业，分配到婺源邮电局[②]工作，一切都好起来了，交通也改善了，写信的次数就越来越少了。又过了几年，到了本世纪初，官坑外边溪关娣家安装了一部无线电话[③]，我们有急事、好事就通过关娣家电话联系了。好像又过了一年多，华树就帮我们自己家也装了一部无线电话，从那以后就再也没有写过信了，一家人相聚也容易多了。</p><h2 id="幸福的晚年"><a href="#幸福的晚年" class="headerlink" title="幸福的晚年"></a>幸福的晚年</h2><p>2005到2006年间，我们四兄妹在双河汇合处合资建新房。那时父亲虽已年近七十，但头脑清晰，很会算账，又有建房经验，仍担任家里的总指挥。记忆中，这是父亲最后做的一件大事。2007年春节，我们兄妹五家大大小小都住到了新房里过年。从那时算起，父亲才开始真正享受自己的晚年生活，吃喝、洗衣有旺生和兴珠伺候。</p><p>日子好了，天天都好像过年过节一样，想吃什么都有。电话方便了，不仅座机有了，华树还帮父亲办了手机。有什么事或想谁了，一个电话就解决问题了。交通也方便多了，水泥路、高速路陆续通了。我们兄弟几个也都买了私家车，逢年过节大家总会不约而同地跑去官坑看望父亲。与此同时，我们也了却了心中的乡愁，品尝了小时候的味道。碰上不错的时机，我们也会带父亲出门走走，看看外面的世界，体验一下电视新闻里才看得到的地方。</p><p>记得带父亲到南昌过年的时候，父亲说城市里怎么到处是人山人海；记得开车带父亲去赣州玩，父亲还说车子没有坐够；记得路过吉安吃饭时，上了一份驴肉，回来后常常说好吃；带父亲去杭州玩时，父亲总回想小时候书上讲“上有天堂，下有苏杭”，一看西湖怎么这么大；带父亲去上海时，父亲感觉酒店里的自助早餐真实在，东方明珠塔怎么能建得那么高，同时也去看了我爷爷在上海生活期间置办的小屋，了结了多年的心愿。再从上海坐飞机回南昌时，父亲说怎么就只坐了一下下子。</p><p>我还记得带父亲去惠州华斌家过年的时候，父亲在街上看到人家过年打赤膊很是惊奇。我还记得父亲，常常讲华锋带着去婺源乡下吃米饭蒸狗肉，低头一口气吃了三小碗。也常讲华斌带父亲去北京时，北京的饺子如何如何实惠。还常讲县里华树家声琴做的饺子、包子是如何如何好吃。</p><p>也因为父亲走得多、看得多，在官坑，父亲跟亲朋好友谈天时，或是跟兴珠家游客吹牛时，话题自然丰富了很多。近年来，我问父亲想去哪，他说想去的都去过了，不想了，也许这就是知足吧。</p><p>晚年期间，每当我们有好友去官坑玩，或是兴珠家游客高兴起哄时，父亲偶尔也在小院里唱唱婺源小调。我们听得最多的是《劝善记》，虽然调子有些凄凉，但歌中劝大家和谐相处、与人为善的词句让人深受启发，我们兄妹几个也都受益匪浅。</p><p>因父亲略知中国民间风水历学，特别是熟悉婺源本地民间风俗礼仪，所以闲空之时官坑本地亲朋好友举办红白喜事、建屋盖房都喜欢请父亲挑日子、看风水、写对联、做司仪。亦或是分家，也愿意请父亲当公证人或代理书写契约。对于这些事，父亲从不开价收费。相反，他总是乐于相助，在忙碌中实现个人价值。</p><h2 id="最后的时光"><a href="#最后的时光" class="headerlink" title="最后的时光"></a>最后的时光</h2><p>近几年来，父亲的听力减退了，我们也不常通电话。每逢节假日，我几乎都要开车去官坑看父亲。每次只要是讲了大概什么时间会到，父亲一定会站在停车场等候。同样，每次开车离开，父亲也一定会去停车场送别。虽然煽情的话不多，但彼此的内心一定是温暖的，现在这种感觉突然就没有了。</p><p>近几年，每次大年三十晚上团圆饭后，父亲都会提着小蓝子给我们大家发红包。无论男女老少，每人200元，很是热闹。小岛在美求学，因此也缺席了多年。但每次父亲见到我，总会提起，“小岛什么时候毕业，让他回来工作”。这份惦记，也许就是父亲心底里对孙辈的挂念吧。</p><p>近几年清明节，或是大年初二，父亲带我们去爷爷奶奶坟前祭拜结束后，他都会指着爷爷坟墓右边30米左右的一处空地，跟我们小声说上一句，“那个地方可以，离这也近，我以后可以放那”。去年清明，我问父亲寒食节是怎么来的，为什么婺源规矩不能挂纸钱，父亲跟我讲过后又拿出一本古书让我查对。最后还补上一句，“这本书人家出一万元想收购我都不肯”，又说，“以后这本书就传给你好了”。感觉是父亲自己知道时日不多，在妥善安排后事一样。没想到几天后，他就真要离开我们了。那时也没有机会说上一句话，也许这就是天意。</p><p>俗话说，“父母在，家就在。父母离去，人生只剩下归途”。现在终于体会到了其中的深意。在父亲离开的这一年里，我时常想起他过往的点点滴滴。各种场景涌上心头，感觉挥之不去。于是，我打算找个时间做个记录，传于后人。恰好这个清明假期，哪里也去不了，便打开电脑写下这些文字，当作对父亲的周年纪念吧。愿父亲在另一个世界里还是那么乐观、知足、快乐！</p><p>华亮</p><p>二零二二年农历三月初五 清明节</p><hr><p>①: 猪头花是官坑一种可以蒸起来吃的野花。</p><p>②: 1994年，邮电局负责邮政、电信、移动三项业务。</p><p>③: 官坑的无线电话依靠段莘乡山顶一个无线差转台传送信号。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;This is a post written by my father to my loved grandpa.&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;不一样的清明节&quot;&gt;&lt;a href=&quot;#不一样的清明节&quot; class=&quot;headerlink&quot; title=&quot;不一样的清</summary>
      
    
    
    
    
    <category term="札记" scheme="http://yanghaowang.github.io/tags/%E6%9C%AD%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Review in Causal Inference (Part 1)</title>
    <link href="http://yanghaowang.github.io/posts/20220201-Review-in-Causal-Inference-Part-1"/>
    <id>http://yanghaowang.github.io/posts/20220201-Review-in-Causal-Inference-Part-1</id>
    <published>2022-02-02T04:36:54.000Z</published>
    <updated>2022-07-06T14:53:40.168Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Practice-1-ATEs-and-CATEs"><a href="#Practice-1-ATEs-and-CATEs" class="headerlink" title="Practice 1: ATEs and CATEs"></a>Practice 1: ATEs and CATEs</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Examine the effect of private school on earnings</span></span><br><span class="line">schools &lt;- fread(<span class="string">&quot;ATEs&amp;CTEs/public_private_earnings.csv&quot;</span>)</span><br><span class="line">schools</span><br></pre></td></tr></table></figure><pre><code>##    student_id group   ivy1   ivy2  ivy3 public1 public2 public3 enrolled earnings## 1:          1     A   &lt;NA&gt; Reject Admit    &lt;NA&gt;   Admit    &lt;NA&gt;     ivy3   110000## 2:          2     A   &lt;NA&gt; Reject Admit    &lt;NA&gt;   Admit    &lt;NA&gt;     ivy3   100000## 3:          3     A   &lt;NA&gt; Reject Admit    &lt;NA&gt;   Admit    &lt;NA&gt;  public2   110000## 4:          4     B  Admit   &lt;NA&gt;  &lt;NA&gt;   Admit    &lt;NA&gt;   Admit     ivy1    60000## 5:          5     B  Admit   &lt;NA&gt;  &lt;NA&gt;   Admit    &lt;NA&gt;   Admit  public3    30000## 6:          6     C   &lt;NA&gt;  Admit  &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     ivy2   115000## 7:          7     C   &lt;NA&gt;  Admit  &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     ivy2    75000## 8:          8     D Reject   &lt;NA&gt;  &lt;NA&gt;   Admit   Admit    &lt;NA&gt;  public1    90000## 9:          9     D Reject   &lt;NA&gt;  &lt;NA&gt;   Admit   Admit    &lt;NA&gt;  public2    60000</code></pre><ul><li><p>Select comparable groups</p></li><li><p>Evaluate ATEs</p><ul><li><p>Manual Calculation</p><p>$$<br>\text{ATE}=\sum_i \pi_i\times \text{CATE}_i<br>$$</p><p>where $\pi_i$ is the share of group $i$ and $\text{CATE}_i$ is the conditional ATE of observations in group $i$.</p></li><li><p>Regression</p></li></ul></li></ul><h3 id="Manual-Calculation"><a href="#Manual-Calculation" class="headerlink" title="Manual Calculation"></a>Manual Calculation</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">schools[, <span class="string">&#x27;:=&#x27;</span>(private = grepl(<span class="string">&#x27;ivy&#x27;</span>, enrolled))]</span><br><span class="line">schools[group %in% <span class="built_in">c</span>(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>)][, .(n_obs = .N, avg_earnings = mean(earnings))</span><br><span class="line">                                , by=<span class="built_in">c</span>(<span class="string">&#x27;group&#x27;</span>, <span class="string">&#x27;private&#x27;</span>)]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">##    group private n_obs avg_earnings</span><br><span class="line">## 1:     A    TRUE     2       105000</span><br><span class="line">## 2:     A   FALSE     1       110000</span><br><span class="line">## 3:     B    TRUE     1        60000</span><br><span class="line">## 4:     B   FALSE     1        30000</span><br></pre></td></tr></table></figure><h3 id="Regression"><a href="#Regression" class="headerlink" title="Regression"></a>Regression</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lm(earnings ~ private + factor(group), </span><br><span class="line">   data=schools[group %in% <span class="built_in">c</span>(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>)])</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## Call:</span><br><span class="line">## lm(formula &#x3D; earnings ~ private + factor(group), data &#x3D; schools[group %in% </span><br><span class="line">##     c(&quot;A&quot;, &quot;B&quot;)])</span><br><span class="line">## </span><br><span class="line">## Coefficients:</span><br><span class="line">##    (Intercept)     privateTRUE  factor(group)B  </span><br><span class="line">##         100000           10000          -60000</span><br></pre></td></tr></table></figure><h2 id="Practice-2-Matching-and-Inverse-Probability-Weighting"><a href="#Practice-2-Matching-and-Inverse-Probability-Weighting" class="headerlink" title="Practice 2: Matching and Inverse Probability Weighting"></a>Practice 2: Matching and Inverse Probability Weighting</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Examine the effect of bed net usage on malaria risk</span></span><br><span class="line">nets &lt;- fread(<span class="string">&quot;Matching&amp;IPW/mosquito_nets.csv&quot;</span>)</span><br><span class="line">head(nets)</span><br></pre></td></tr></table></figure><pre><code>##    id   net net_num malaria_risk income health household eligible temperature resistance## 1:  1  TRUE       1           33    781     56         2    FALSE        21.1         59## 2:  2 FALSE       0           42    974     57         4    FALSE        26.5         73## 3:  3 FALSE       0           80    502     15         3    FALSE        25.6         65## 4:  4  TRUE       1           34    671     20         5     TRUE        21.3         46## 5:  5 FALSE       0           44    728     17         5    FALSE        19.2         54## 6:  6 FALSE       0           25   1050     48         1    FALSE        25.3         34</code></pre><h3 id="Directed-Acyclic-Graph-DAG"><a href="#Directed-Acyclic-Graph-DAG" class="headerlink" title="Directed Acyclic Graph (DAG)"></a>Directed Acyclic Graph (DAG)</h3><ul><li><p>Identify mediator, confounder, and collider</p><ul><li><p>Example</p><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-5-1.png" class=""></li><li><p>DAG for nets</p><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/dag-1.png" class=""><ul><li>Control variables?</li><li>Do we need to control <code>eligible</code> and <code>household</code></li></ul></li></ul></li></ul><h4 id="Conditional-Independence"><a href="#Conditional-Independence" class="headerlink" title="Conditional Independence"></a>Conditional Independence</h4><ul><li>$\text{Health}\perp\text{Numb. of Household}$</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor(nets$health, nets$household)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## [1] 9.785337e-05</span><br></pre></td></tr></table></figure><ul><li>$\text{Income}\perp\text{Insect Resistance}$</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor(nets$income, nets$resistance)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## [1] 0.01371297</span><br></pre></td></tr></table></figure><ul><li>$\text{Malaria risk}\perp\text{Numb. of Household} \mid \text{(Net Use, Health, Income, Temp)}$</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lm(malaria_risk ~ household + net + health + income + temperature,</span><br><span class="line">   data = nets) %&gt;%</span><br><span class="line">  (<span class="keyword">function</span>(x) summary(x)$coeff) %&gt;%</span><br><span class="line">  (<span class="keyword">function</span>(x) <span class="built_in">round</span>(x, <span class="number">4</span>))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">##             Estimate Std. Error  t value Pr(&gt;|t|)</span><br><span class="line">## (Intercept)  76.2067     0.9658  78.9062   0.0000</span><br><span class="line">## household    -0.0155     0.0893  -0.1730   0.8626</span><br><span class="line">## netTRUE     -10.4370     0.2665 -39.1633   0.0000</span><br><span class="line">## health        0.1483     0.0107  13.8997   0.0000</span><br><span class="line">## income       -0.0751     0.0010 -72.5635   0.0000</span><br><span class="line">## temperature   1.0058     0.0310  32.4829   0.0000</span><br></pre></td></tr></table></figure><p><strong>Notes:</strong> No correlation ⇏ Independence</p><blockquote><p>[Example] Flip a fair coin to determine the amount of your bet: bet $1 if heads \$2 if tails. Then flip again: win the amount of your bet if heads lose if tails.</p></blockquote><h3 id="Naive-Comparison"><a href="#Naive-Comparison" class="headerlink" title="Naive Comparison"></a>Naive Comparison</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model_naive &lt;- lm(malaria_risk ~ net, data = nets) </span><br><span class="line">summary(model_naive)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## Call:</span><br><span class="line">## lm(formula &#x3D; malaria_risk ~ net, data &#x3D; nets)</span><br><span class="line">## </span><br><span class="line">## Residuals:</span><br><span class="line">##     Min      1Q  Median      3Q     Max </span><br><span class="line">## -26.937  -9.605  -1.937   7.063  55.395 </span><br><span class="line">## </span><br><span class="line">## Coefficients:</span><br><span class="line">##             Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span class="line">## (Intercept)  41.9365     0.4049  103.57   &lt;2e-16 ***</span><br><span class="line">## netTRUE     -16.3315     0.6495  -25.15   &lt;2e-16 ***</span><br><span class="line">## ---</span><br><span class="line">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span><br><span class="line">## </span><br><span class="line">## Residual standard error: 13.25 on 1750 degrees of freedom</span><br><span class="line">## Multiple R-squared:  0.2654, Adjusted R-squared:  0.265 </span><br><span class="line">## F-statistic: 632.3 on 1 and 1750 DF,  p-value: &lt; 2.2e-16</span><br></pre></td></tr></table></figure><h4 id="Balance-Check"><a href="#Balance-Check" class="headerlink" title="Balance Check"></a>Balance Check</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="built_in">c</span>(<span class="string">&#x27;income&#x27;</span>, <span class="string">&#x27;temperature&#x27;</span>, <span class="string">&#x27;health&#x27;</span>)) &#123;</span><br><span class="line">  plot_command &lt;- paste0(<span class="string">&#x27;ggplot(data = nets, aes(x =&#x27;</span>, v,</span><br><span class="line">                         <span class="string">&#x27;, fill=net)) +geom_density(alpha = 0.7)&#x27;</span>)</span><br><span class="line">  print(eval(parse(text = plot_command)))</span><br><span class="line">  test_result &lt;- t.test(as.formula(paste0(v, <span class="string">&#x27;~net&#x27;</span>)), data=nets)</span><br><span class="line">  print(test_result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-10-1.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  income by net</span><br><span class="line">## t &#x3D; -8.8113, df &#x3D; 1284.7, p-value &lt; 2.2e-16</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -100.79660  -64.08593</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            872.7526            955.1938</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-10-2.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  temperature by net</span><br><span class="line">## t &#x3D; 3.492, df &#x3D; 1404.3, p-value &#x3D; 0.0004943</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  0.3098586 1.1042309</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            24.08796            23.38091</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-10-3.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  health by net</span><br><span class="line">## t &#x3D; -7.6447, df &#x3D; 1346.9, p-value &#x3D; 3.961e-14</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -8.610309 -5.093693</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            48.05696            54.90896</span><br></pre></td></tr></table></figure><h3 id="Regression-1"><a href="#Regression-1" class="headerlink" title="Regression"></a>Regression</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model_regression &lt;- lm(malaria_risk ~ net + income + temperature + health, data = nets)</span><br><span class="line">summary(model_regression)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## Call:</span><br><span class="line">## lm(formula &#x3D; malaria_risk ~ net + income + temperature + health, </span><br><span class="line">##     data &#x3D; nets)</span><br><span class="line">## </span><br><span class="line">## Residuals:</span><br><span class="line">##     Min      1Q  Median      3Q     Max </span><br><span class="line">## -13.143  -3.915  -0.561   3.333  16.461 </span><br><span class="line">## </span><br><span class="line">## Coefficients:</span><br><span class="line">##               Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span class="line">## (Intercept)  76.159901   0.926835   82.17   &lt;2e-16 ***</span><br><span class="line">## netTRUE     -10.441932   0.264906  -39.42   &lt;2e-16 ***</span><br><span class="line">## income       -0.075144   0.001035  -72.58   &lt;2e-16 ***</span><br><span class="line">## temperature   1.005855   0.030953   32.50   &lt;2e-16 ***</span><br><span class="line">## health        0.148362   0.010668   13.91   &lt;2e-16 ***</span><br><span class="line">## ---</span><br><span class="line">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span><br><span class="line">## </span><br><span class="line">## Residual standard error: 5.244 on 1747 degrees of freedom</span><br><span class="line">## Multiple R-squared:  0.8852, Adjusted R-squared:  0.8849 </span><br><span class="line">## F-statistic:  3366 on 4 and 1747 DF,  p-value: &lt; 2.2e-16</span><br></pre></td></tr></table></figure><h3 id="Matching-Mahalanobis-Distance"><a href="#Matching-Mahalanobis-Distance" class="headerlink" title="Matching (Mahalanobis Distance)"></a>Matching (Mahalanobis Distance)</h3><ul><li><p>Mahalanobis distance between $\bf{x}$ and $\bf{y}$</p><p>$$<br>(\bf{x} - \bf{y})\Sigma^{-1}(\bf{x} - \bf{y})^T<br>$$</p><p>where $\Sigma$ is the covariance matrix.</p></li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(MatchIt)</span><br><span class="line"></span><br><span class="line">matched &lt;- matchit(net ~ income + temperature + health, data = nets,</span><br><span class="line">                   method = <span class="string">&quot;nearest&quot;</span>, </span><br><span class="line">                   distance = <span class="string">&quot;mahalanobis&quot;</span>, </span><br><span class="line">                   replace = <span class="literal">TRUE</span>)</span><br><span class="line">matched</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">## A matchit object</span><br><span class="line">##  - method: 1:1 nearest neighbor matching with replacement</span><br><span class="line">##  - distance: Mahalanobis</span><br><span class="line">##  - number of obs.: 1752 (original), 1120 (matched)</span><br><span class="line">##  - target estimand: ATT</span><br><span class="line">##  - covariates: income, temperature, health</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dimension of the data used for matching</span></span><br><span class="line"><span class="built_in">dim</span>(matched$X)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## [1] 1752    3</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Number of the treated</span></span><br><span class="line"><span class="built_in">sum</span>(matched$treat)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## [1] 681</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Number of the matched control</span></span><br><span class="line"><span class="built_in">sum</span>(matched$weights&gt;<span class="number">0</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## [1] 1120</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Number of the unmatched control</span></span><br><span class="line"><span class="built_in">sum</span>(matched$weights==<span class="number">0</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## [1] 632</span><br></pre></td></tr></table></figure><ul><li>The <code>matchit()</code> function determines the pair weights by measuring how close the matched pair are. The weights can be used in the regression to account for the variation in distance.</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nets_matched &lt;- match.data(matched)</span><br><span class="line">model_matched &lt;- lm(malaria_risk ~ net, data = nets_matched, weights = weights)</span><br><span class="line">summary(model_matched)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## Call:</span><br><span class="line">## lm(formula &#x3D; malaria_risk ~ net, data &#x3D; nets_matched, weights &#x3D; weights)</span><br><span class="line">## </span><br><span class="line">## Weighted Residuals:</span><br><span class="line">##     Min      1Q  Median      3Q     Max </span><br><span class="line">## -36.312  -7.605  -1.681   5.395  55.395 </span><br><span class="line">## </span><br><span class="line">## Coefficients:</span><br><span class="line">##             Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span class="line">## (Intercept)  36.0940     0.5951   60.65   &lt;2e-16 ***</span><br><span class="line">## netTRUE     -10.4890     0.7632  -13.74   &lt;2e-16 ***</span><br><span class="line">## ---</span><br><span class="line">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span><br><span class="line">## </span><br><span class="line">## Residual standard error: 12.47 on 1118 degrees of freedom</span><br><span class="line">## Multiple R-squared:  0.1445, Adjusted R-squared:  0.1438 </span><br><span class="line">## F-statistic: 188.9 on 1 and 1118 DF,  p-value: &lt; 2.2e-16</span><br></pre></td></tr></table></figure><h4 id="Balance-Check-1"><a href="#Balance-Check-1" class="headerlink" title="Balance Check"></a>Balance Check</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="built_in">c</span>(<span class="string">&#x27;income&#x27;</span>, <span class="string">&#x27;temperature&#x27;</span>, <span class="string">&#x27;health&#x27;</span>)) &#123;</span><br><span class="line">  test_result &lt;- t.test(as.formula(paste0(v, <span class="string">&#x27;~net&#x27;</span>)), data=nets_matched)</span><br><span class="line">  print(test_result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  income by net</span><br><span class="line">## t &#x3D; -3.5017, df &#x3D; 990.87, p-value &#x3D; 0.0004829</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -64.12955 -18.06677</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            914.0957            955.1938 </span><br><span class="line">## </span><br><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  temperature by net</span><br><span class="line">## t &#x3D; 0.79239, df &#x3D; 952.76, p-value &#x3D; 0.4283</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -0.2955968  0.6959627</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            23.58109            23.38091 </span><br><span class="line">## </span><br><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  health by net</span><br><span class="line">## t &#x3D; -3.0287, df &#x3D; 977.39, p-value &#x3D; 0.002521</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -5.567087 -1.189325</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            51.53075            54.90896</span><br></pre></td></tr></table></figure><h3 id="Matching-Propensity-Score"><a href="#Matching-Propensity-Score" class="headerlink" title="Matching (Propensity Score)"></a>Matching (Propensity Score)</h3><p><strong>Other Source</strong>：<a href="https://sejdemyr.github.io/r-tutorials/statistics/tutorial8.html">Simon Ejdemyr’s notes on propensity score matching</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">matched_psm &lt;- matchit(net ~ income + temperature + health, data = nets,</span><br><span class="line">                   method = <span class="string">&quot;nearest&quot;</span>,</span><br><span class="line">                   replace = <span class="literal">TRUE</span>)</span><br><span class="line">matched_psm</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">## A matchit object</span><br><span class="line">##  - method: 1:1 nearest neighbor matching with replacement</span><br><span class="line">##  - distance: Propensity score</span><br><span class="line">##              - estimated with logistic regression</span><br><span class="line">##  - number of obs.: 1752 (original), 1098 (matched)</span><br><span class="line">##  - target estimand: ATT</span><br><span class="line">##  - covariates: income, temperature, health</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nets_matched_psm &lt;- match.data(matched_psm)</span><br><span class="line">model_matched_psm &lt;- lm(malaria_risk ~ net, data = nets_matched_psm, weights = weights)</span><br><span class="line">summary(model_matched_psm)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## Call:</span><br><span class="line">## lm(formula &#x3D; malaria_risk ~ net, data &#x3D; nets_matched_psm, weights &#x3D; weights)</span><br><span class="line">## </span><br><span class="line">## Weighted Residuals:</span><br><span class="line">##     Min      1Q  Median      3Q     Max </span><br><span class="line">## -57.745  -7.605  -1.605   5.395  59.226 </span><br><span class="line">## </span><br><span class="line">## Coefficients:</span><br><span class="line">##             Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span class="line">## (Intercept)  36.3025     0.6187   58.67   &lt;2e-16 ***</span><br><span class="line">## netTRUE     -10.6975     0.7857  -13.62   &lt;2e-16 ***</span><br><span class="line">## ---</span><br><span class="line">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span><br><span class="line">## </span><br><span class="line">## Residual standard error: 12.63 on 1096 degrees of freedom</span><br><span class="line">## Multiple R-squared:  0.1447, Adjusted R-squared:  0.1439 </span><br><span class="line">## F-statistic: 185.4 on 1 and 1096 DF,  p-value: &lt; 2.2e-16</span><br></pre></td></tr></table></figure><h4 id="Common-Support"><a href="#Common-Support" class="headerlink" title="Common Support"></a>Common Support</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">model_treatment &lt;- glm(net ~ income + temperature + health, data = nets,</span><br><span class="line">                       family = binomial(link = <span class="string">&quot;logit&quot;</span>))</span><br><span class="line">nets_pred &lt;- copy(nets)</span><br><span class="line">nets_pred$pred &lt;- model_treatment$fitted.values</span><br><span class="line"></span><br><span class="line">ggplot(data = nets_pred, aes(x = pred, fill=net)) + </span><br><span class="line">  geom_histogram(position = <span class="string">&quot;identity&quot;</span>, alpha = <span class="number">0.7</span>, bins = <span class="number">50</span>) + xlim(<span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>)) + </span><br><span class="line">  labs(title=paste0(<span class="string">&#x27;Full Sample (N = &#x27;</span>, nrow(nets_pred), <span class="string">&#x27;)&#x27;</span>))</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-17-1.png" class=""><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = nets_pred[id %in% nets_matched_psm$id], aes(x = pred, fill=net)) + </span><br><span class="line">  geom_histogram(position = <span class="string">&quot;identity&quot;</span>, alpha = <span class="number">0.7</span>, bins = <span class="number">50</span>) + xlim(<span class="built_in">c</span>(<span class="number">0</span>, <span class="number">1</span>)) + </span><br><span class="line">  labs(title=paste0(<span class="string">&#x27;Matched Sample (N = &#x27;</span>, nrow(nets_matched_psm), <span class="string">&#x27;)&#x27;</span>))</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-18-1.png" class=""><h4 id="Balance-Check-2"><a href="#Balance-Check-2" class="headerlink" title="Balance Check"></a>Balance Check</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (v <span class="keyword">in</span> <span class="built_in">c</span>(<span class="string">&#x27;income&#x27;</span>, <span class="string">&#x27;temperature&#x27;</span>, <span class="string">&#x27;health&#x27;</span>)) &#123;</span><br><span class="line">  plot_command &lt;- paste0(<span class="string">&#x27;ggplot(data = nets_matched_psm, aes(x =&#x27;</span>, v,</span><br><span class="line">                         <span class="string">&#x27;, fill=net)) +geom_density(alpha = 0.7)&#x27;</span>)</span><br><span class="line">  print(eval(parse(text = plot_command)))</span><br><span class="line">  test_result &lt;- t.test(as.formula(paste0(v, <span class="string">&#x27;~net&#x27;</span>)), data=nets_matched_psm)</span><br><span class="line">  print(test_result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-19-1.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  income by net</span><br><span class="line">## t &#x3D; -3.548, df &#x3D; 954.79, p-value &#x3D; 0.0004071</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -64.64167 -18.59971</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            913.5731            955.1938</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-19-2.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  temperature by net</span><br><span class="line">## t &#x3D; 1.4522, df &#x3D; 910.52, p-value &#x3D; 0.1468</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -0.1294926  0.8664727</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            23.74940            23.38091</span><br></pre></td></tr></table></figure><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-19-3.png" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">##  Welch Two Sample t-test</span><br><span class="line">## </span><br><span class="line">## data:  health by net</span><br><span class="line">## t &#x3D; -2.1015, df &#x3D; 920.12, p-value &#x3D; 0.03587</span><br><span class="line">## alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0</span><br><span class="line">## 95 percent confidence interval:</span><br><span class="line">##  -4.6145611 -0.1577902</span><br><span class="line">## sample estimates:</span><br><span class="line">## mean in group FALSE  mean in group TRUE </span><br><span class="line">##            52.52278            54.90896</span><br></pre></td></tr></table></figure><h3 id="Inverse-Probability-Weighting"><a href="#Inverse-Probability-Weighting" class="headerlink" title="Inverse Probability Weighting"></a>Inverse Probability Weighting</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Predict the probability of a household using bed nets</span></span><br><span class="line">model_treatment &lt;- glm(net ~ income + temperature + health, data = nets,</span><br><span class="line">                       family = binomial(link = <span class="string">&quot;logit&quot;</span>))</span><br><span class="line">nets_ipw &lt;- copy(nets)</span><br><span class="line">nets_ipw$pred &lt;- model_treatment$fitted.values</span><br><span class="line">nets_ipw[, ipw := (net_num / pred) + (<span class="number">1</span> - net_num) / (<span class="number">1</span> - pred)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Evaluate the effect with inverse probability weights</span></span><br><span class="line">model_ipw &lt;- lm(malaria_risk ~ net, data = nets_ipw, weights = ipw)</span><br><span class="line">summary(model_ipw)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## Call:</span><br><span class="line">## lm(formula &#x3D; malaria_risk ~ net, data &#x3D; nets_ipw, weights &#x3D; ipw)</span><br><span class="line">## </span><br><span class="line">## Weighted Residuals:</span><br><span class="line">##     Min      1Q  Median      3Q     Max </span><br><span class="line">## -45.705 -14.622  -4.924  10.791 162.642 </span><br><span class="line">## </span><br><span class="line">## Coefficients:</span><br><span class="line">##             Estimate Std. Error t value Pr(&gt;|t|)    </span><br><span class="line">## (Intercept)  39.6788     0.4684   84.71   &lt;2e-16 ***</span><br><span class="line">## netTRUE     -10.1312     0.6583  -15.39   &lt;2e-16 ***</span><br><span class="line">## ---</span><br><span class="line">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span><br><span class="line">## </span><br><span class="line">## Residual standard error: 19.54 on 1750 degrees of freedom</span><br><span class="line">## Multiple R-squared:  0.1192, Adjusted R-squared:  0.1187 </span><br><span class="line">## F-statistic: 236.8 on 1 and 1750 DF,  p-value: &lt; 2.2e-16</span><br></pre></td></tr></table></figure><ul><li><p>Inverse Probability Weights</p><p>$$<br>\frac{\text{Treatment}}{\text{Propensity}}+\frac{1-\text{Treatment}}{1-\text{Propensity}}<br>$$</p><p>Think of this formula in a controlled experiment scenario:</p><ul><li><p>Individuals are more likely to be <strong>never-takers</strong> (in a control group) if their likelihood values of receiving treatment are lower than the average and they do <em>not</em> receive treatment</p></li><li><p>Individuals are more likely to be <strong>always-takers</strong> (in a treatment group) if their likelihood values of receiving treatment are higher than the average and they <em>do</em> receive treatment</p></li><li><p>Individuals are more likely to be <strong>compliers</strong> (in both the control and the treatment group) if their likelihood values of receiving treatment are inconsistent with their actual treatment</p></li></ul></li></ul><p>To the end, we evaluate the change in the compliers’ outcomes due to their different exposures to the treatment.</p><h3 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">## </span><br><span class="line">## &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">##              Naive        Regression   Matching (M)  Matching (PS)  IPW        </span><br><span class="line">## -------------------------------------------------------------------------------</span><br><span class="line">## (Intercept)    41.94 ***    76.16 ***    36.09 ***     36.30 ***      39.68 ***</span><br><span class="line">##                (0.40)       (0.93)       (0.60)        (0.62)         (0.47)   </span><br><span class="line">## netTRUE       -16.33 ***   -10.44 ***   -10.49 ***    -10.70 ***     -10.13 ***</span><br><span class="line">##                (0.65)       (0.26)       (0.76)        (0.79)         (0.66)   </span><br><span class="line">## income                      -0.08 ***                                          </span><br><span class="line">##                             (0.00)                                             </span><br><span class="line">## temperature                  1.01 ***                                          </span><br><span class="line">##                             (0.03)                                             </span><br><span class="line">## health                       0.15 ***                                          </span><br><span class="line">##                             (0.01)                                             </span><br><span class="line">## -------------------------------------------------------------------------------</span><br><span class="line">## R^2             0.27         0.89         0.14          0.14           0.12    </span><br><span class="line">## Adj. R^2        0.27         0.88         0.14          0.14           0.12    </span><br><span class="line">## Num. obs.    1752         1752         1120          1098           1752       </span><br><span class="line">## &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</span><br></pre></td></tr></table></figure><ul><li><p>Overestimate or underestimate? Why?</p><p>Suppose $y = \beta x + \theta z + \varepsilon$ where $z$ is an omitting variable.</p><p>$$<br>\begin{align*}~<br>z &amp;= \gamma x+\eta \\<br>y &amp;= \beta x +\xi = \beta x + \theta\gamma x +\theta\eta+\epsilon<br>\end{align*}<br>$$</p><p>where $\beta’=\beta+\theta\gamma\neq\beta$ if $\theta\neq0$ or $\gamma\neq0$.</p></li></ul><h2 id="Practice-3-Difference-in-differences"><a href="#Practice-3-Difference-in-differences" class="headerlink" title="Practice 3: Difference-in-differences"></a>Practice 3: Difference-in-differences</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">injury &lt;- fread(<span class="string">&quot;Did/injury.csv&quot;</span>)[ky==<span class="number">1</span>]</span><br><span class="line">setnames(injury, old=<span class="built_in">c</span>(<span class="string">&#x27;durat&#x27;</span>, <span class="string">&#x27;ldurat&#x27;</span>, <span class="string">&#x27;afchnge&#x27;</span>),</span><br><span class="line">         new=<span class="built_in">c</span>(<span class="string">&#x27;duration&#x27;</span>, <span class="string">&#x27;log_duration&#x27;</span>, <span class="string">&#x27;after_1980&#x27;</span>))</span><br><span class="line">injury$highearn &lt;- injury$highearn==<span class="number">1</span></span><br><span class="line">print(paste(<span class="built_in">c</span>(<span class="string">&#x27;Number of Rows:&#x27;</span>, <span class="string">&#x27;Number of Columns:&#x27;</span>), <span class="built_in">dim</span>(injury)))</span><br></pre></td></tr></table></figure><pre><code>## [1] &quot;Number of Rows: 5626&quot;  &quot;Number of Columns: 30&quot;</code></pre><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head(injury)</span><br></pre></td></tr></table></figure><pre><code>##    duration after_1980 highearn male married hosp indust injtype age  prewage    totmed injdes  benefit ky mi log_duration afhigh lprewage     lage  ltotmed head neck upextr trunk lowback lowextr occdis manuf construc highlpre## 1:        1          1     TRUE    1       0    1      3       1  26 404.9500 1187.5732   1010 246.8375  1  0     0.000000      1 6.003764 3.258096 7.079667    1    0      0     0       0       0      0     0        0 6.003764## 2:        1          1     TRUE    1       1    0      3       1  31 643.8250  361.0786   1404 246.8375  1  0     0.000000      1 6.467427 3.433987 5.889095    1    0      0     0       0       0      0     0        0 6.467427## 3:       84          1     TRUE    1       1    1      3       1  37 398.1250 8963.6572   1032 246.8375  1  0     4.430817      1 5.986766 3.610918 9.100934    1    0      0     0       0       0      0     0        0 5.986766## 4:        4          1     TRUE    1       1    1      3       1  31 527.8000 1099.6483   1940 246.8375  1  0     1.386294      1 6.268717 3.433987 7.002746    1    0      0     0       0       0      0     0        0 6.268717## 5:        1          1     TRUE    1       1    0      3       1  23 528.9375  372.8019   1940 211.5750  1  0     0.000000      1 6.270870 3.135494 5.921047    1    0      0     0       0       0      0     0        0 6.270870## 6:        1          1     TRUE    1       1    0      3       1  34 614.2500  211.0199   1425 176.3125  1  0     0.000000      1 6.420402 3.526361 5.351953    1    0      0     0       0       0      0     0        0 6.420402</code></pre><blockquote><p>Background (Wooldridge’s Intro Econometrics P411): Meyer, Viscusi, and Durbin (1995) (hereafter, MVD) studied the length of time (in weeks) that an injured worker receives workers’ compensation. On July 15, 1980, Kentucky raised the cap on weekly earnings that were covered by workers’ compensation. An increase in the cap has no effect on the benefit for low-income workers, but it makes it less costly for a high-income worker to stay on workers’ compensation. Therefore, the control group is low-income workers, and the treatment group is high-income workers; high-income workers are defined as those who were subject to the pre-policy change cap. Using random samples both before and after the policy change, MVD were able to test whether more generous workers’ compensation causes people to stay out of work longer (everything else fixed). They started with a difference-in-differences analysis, using log(durat) as the dependent variable. Let afchnge be the dummy variable for observations after the policy change and highearn the dummy variable for high earners.</p></blockquote><h3 id="Change-after-1980"><a href="#Change-after-1980" class="headerlink" title="Change after 1980"></a>Change after 1980</h3><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-23-1.png" class=""><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-23-2.png" class=""><img src="/posts/20220201-Review-in-Causal-Inference-Part-1/unnamed-chunk-24-1.png" class=""><h3 id="Regression-2"><a href="#Regression-2" class="headerlink" title="Regression"></a>Regression</h3><p>$$<br>\log(\text{duration}) = \alpha + \beta \text{highearn} +<br>\gamma\text{after_1980} +<br>\delta(\text{highearn} \times \text{after_1980}) + \epsilon<br>$$</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model_simple &lt;- lm(log_duration ~ highearn + after_1980 + highearn * after_1980,</span><br><span class="line">                   data = injury)</span><br><span class="line">summary(model_simple)</span><br></pre></td></tr></table></figure><pre><code>## ## Call:## lm(formula = log_duration ~ highearn + after_1980 + highearn * ##     after_1980, data = injury)## ## Residuals:##     Min      1Q  Median      3Q     Max ## -2.9666 -0.8872  0.0042  0.8126  4.0784 ## ## Coefficients:##                         Estimate Std. Error t value Pr(&gt;|t|)    ## (Intercept)             1.125615   0.030737  36.621  &lt; 2e-16 ***## highearnTRUE            0.256479   0.047446   5.406 6.72e-08 ***## after_1980              0.007657   0.044717   0.171  0.86404    ## highearnTRUE:after_1980 0.190601   0.068509   2.782  0.00542 ** ## ---## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1## ## Residual standard error: 1.269 on 5622 degrees of freedom## Multiple R-squared:  0.02066,    Adjusted R-squared:  0.02014 ## F-statistic: 39.54 on 3 and 5622 DF,  p-value: &lt; 2.2e-16</code></pre><p><strong>Add more controls</strong>: <code>male</code>, <code>married</code>, <code>age</code>, <code>hosp</code> (1 = hospitalized), <code>indust</code> (1 = manuf, 2 = construc, 3 = other), <code>injtype</code> (1-8; categories for different types of injury), <code>lprewage</code> (log of wage prior to filing a claim)</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model_full &lt;- lm(log_duration ~ highearn + after_1980 + highearn * after_1980 + male + </span><br><span class="line">                   married + age + hosp + as.factor(indust) + as.factor(injtype) + lprewage,</span><br><span class="line">                 data = injury)</span><br><span class="line">summary(model_full)</span><br></pre></td></tr></table></figure><pre><code>## ## Call:## lm(formula = log_duration ~ highearn + after_1980 + highearn * ##     after_1980 + male + married + age + hosp + as.factor(indust) + ##     as.factor(injtype) + lprewage, data = injury)## ## Residuals:##     Min      1Q  Median      3Q     Max ## -4.0606 -0.7726  0.0931  0.7314  4.3409 ## ## Coefficients:##                          Estimate Std. Error t value Pr(&gt;|t|)    ## (Intercept)             -1.528202   0.422212  -3.620 0.000298 ***## highearnTRUE            -0.151781   0.089116  -1.703 0.088591 .  ## after_1980               0.049540   0.041321   1.199 0.230624    ## male                    -0.084289   0.042315  -1.992 0.046427 *  ## married                  0.056662   0.037305   1.519 0.128845    ## age                      0.006507   0.001338   4.863 1.19e-06 ***## hosp                     1.130493   0.037006  30.549  &lt; 2e-16 ***## as.factor(indust)2       0.183864   0.054131   3.397 0.000687 ***## as.factor(indust)3       0.163485   0.037852   4.319 1.60e-05 ***## as.factor(injtype)2      0.935468   0.143731   6.508 8.29e-11 ***## as.factor(injtype)3      0.635466   0.085442   7.437 1.19e-13 ***## as.factor(injtype)4      0.554550   0.092849   5.973 2.49e-09 ***## as.factor(injtype)5      0.641201   0.085435   7.505 7.15e-14 ***## as.factor(injtype)6      0.615041   0.086312   7.126 1.17e-12 ***## as.factor(injtype)7      0.991336   0.190532   5.203 2.03e-07 ***## as.factor(injtype)8      0.434082   0.118912   3.650 0.000264 ***## lprewage                 0.284481   0.080056   3.554 0.000383 ***## highearnTRUE:after_1980  0.168721   0.063975   2.637 0.008381 ** ## ---## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1## ## Residual standard error: 1.15 on 5329 degrees of freedom##   (279 observations deleted due to missingness)## Multiple R-squared:  0.1899, Adjusted R-squared:  0.1873 ## F-statistic: 73.46 on 17 and 5329 DF,  p-value: &lt; 2.2e-16</code></pre><p><strong>Summary</strong></p><pre><code>## ## =================================================##                          Simple       Full       ## -------------------------------------------------## (Intercept)                 1.13 ***    -1.53 ***##                            (0.03)       (0.42)   ## highearnTRUE                0.26 ***    -0.15    ##                            (0.05)       (0.09)   ## after_1980                  0.01         0.05    ##                            (0.04)       (0.04)   ## highearnTRUE:after_1980     0.19 **      0.17 ** ##                            (0.07)       (0.06)   ## -------------------------------------------------## Additional Controls        NO          YES       ## R^2                         0.02         0.19    ## Adj. R^2                    0.02         0.19    ## Num. obs.                5626         5347       ## =================================================## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>]]></content>
    
    
    <summary type="html">This is the first post in a series of reviews in Causal Inference in Economics.</summary>
    
    
    
    
    <category term="Causal Inference" scheme="http://yanghaowang.github.io/tags/Causal-Inference/"/>
    
    <category term="ATE" scheme="http://yanghaowang.github.io/tags/ATE/"/>
    
    <category term="DAG" scheme="http://yanghaowang.github.io/tags/DAG/"/>
    
    <category term="Matching" scheme="http://yanghaowang.github.io/tags/Matching/"/>
    
    <category term="IPW" scheme="http://yanghaowang.github.io/tags/IPW/"/>
    
    <category term="DID" scheme="http://yanghaowang.github.io/tags/DID/"/>
    
  </entry>
  
  <entry>
    <title>Short Notes on A/B Testing</title>
    <link href="http://yanghaowang.github.io/posts/20210916-Short-Notes-on-A-B-Testing"/>
    <id>http://yanghaowang.github.io/posts/20210916-Short-Notes-on-A-B-Testing</id>
    <published>2021-09-16T21:57:33.000Z</published>
    <updated>2021-10-23T15:25:42.784Z</updated>
    
    <content type="html"><![CDATA[<p class='twelve columns' style="text-align: center;"><img src="/posts/20210916-Short-Notes-on-A-B-Testing/ABTesting.jpg" class=""></p><h2 id="Short-Notes-on-A-B-Testing"><a href="#Short-Notes-on-A-B-Testing" class="headerlink" title="Short Notes on A/B Testing"></a>Short Notes on A/B Testing</h2><h3 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h3><ul><li>Understand what drives your business and provide insights for business decisions  </li><li>Understand causal relationship</li></ul><h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><ul><li>The control and testing groups can be clearly defined</li><li>Metrics of interest can be quantified</li><li>Data can be collected in a timely manner</li></ul><h3 id="Five-Stages-in-Practice"><a href="#Five-Stages-in-Practice" class="headerlink" title="Five Stages in Practice"></a>Five Stages in Practice</h3><ul><li>Define a study question</li><li>Make hypotheses (variations) and identify metrics</li><li>Identify variables<ul><li>Determine the data to be collected</li></ul></li><li>Run experiments and collect data<ul><li>Determine a detectable difference (i.e., how small of a difference you would like to detect, for example, 10% increase in your metric of interest)</li><li>Calculate the proper sample size using power analysis</li><li>Determine what fraction of traffic can be used in the treatment</li><li>Conduct a prior A/A test to check unfavorable impacts on business and a simultaneous A/A test to track seasonality and systematic biases/trend if any</li></ul></li><li>Measure results</li></ul><p class='twelve columns' style="text-align: center;"><img src="/posts/20210916-Short-Notes-on-A-B-Testing/ABTestingSteps.png" class=""></p><h3 id="Some-Details-in-A-B-Testing"><a href="#Some-Details-in-A-B-Testing" class="headerlink" title="Some Details in A/B Testing"></a>Some Details in A/B Testing</h3><h4 id="Common-Web-Analytics-Metrics"><a href="#Common-Web-Analytics-Metrics" class="headerlink" title="Common Web Analytics Metrics"></a>Common Web Analytics Metrics</h4><table><thead><tr><th>Count</th><th>Conversion</th><th>Time</th><th>Business</th></tr></thead><tbody><tr><td>Page View <br>Visits / Return Visits<br/>Click <br/>Visitor / Unique Visitor <br/>(Daily / Monthly) Active Users</td><td>Click Thru Rate <br/>Click Thru Probability <br/>User Click Probability  <br/>Bounce Rate</td><td>Active Time <br>Page View Duration</td><td>Revenue <br>Member <br>Order</td></tr></tbody></table><p>In addition, we can also consider a composite metric.</p><h4 id="Examples-of-Changes-for-Testing"><a href="#Examples-of-Changes-for-Testing" class="headerlink" title="Examples of Changes for Testing"></a>Examples of Changes for Testing</h4><ul><li>Page Contents<ul><li>Headlines, Sub Headlines, Font Size</li><li>Background Image, Background Color</li><li>Paragraph Text</li><li>Page Layout</li></ul></li><li>Call-to-Action<ul><li>Button Place, Button Color, Button Size</li><li>Text</li></ul></li></ul><p>Notes: <em>Only one thing can be changed in a pair of the control and treatment group.</em></p><h4 id="Experiment-Settings"><a href="#Experiment-Settings" class="headerlink" title="Experiment Settings"></a>Experiment Settings</h4><ul><li><p>Target Audience</p><ul><li>Country, Region</li><li>Demographics</li></ul></li><li><p>Sample Size</p></li><li><p>Experiment Period (Time)</p></li><li><p>Percentage of Traffic for A/B Testing</p></li><li><p>Split for Control and Treatment</p><p>Notes: Users visiting the page at different time or using different devices might see different features in the test. These are users in the mixed group, neither in A or B. To solve this problem, we might need to evenly split users in the control and treatment group. Theoretically, the percentages of the mixed group users in A and B should be similar.</p></li><li><p>A/A Test </p><ul><li><p>Run a small A/A test in a short time prior to the A/B test to check the change in metrics of interest and whether there are any unfavorable impacts on business</p></li><li><p>Run an A/A test simultaneously to track the systematic trend during the A/B test period</p></li></ul></li></ul><h4 id="Power-Analysis"><a href="#Power-Analysis" class="headerlink" title="Power Analysis"></a>Power Analysis</h4><ul><li><p><strong>False Positive</strong> (Type I Error): Falsely reject the null hypothesis</p><ul><li>False positive rate ($\alpha$, e.g., 5%) is the significant level of a statistic test</li></ul></li><li><p><strong>False Negative</strong> (Type II Error): Fail to reject (i.e., we should reject but we did not)</p><ul><li>False negative rate ($\beta$, e.g., 20%) is used in calculating the power of a test, i.e., $1-\beta$</li></ul></li></ul><p>Discuss the values of $\alpha$ and $\beta$ with business partners.</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Here is a function in R</span></span><br><span class="line"><span class="comment"># https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/power.prop.test</span></span><br><span class="line"><span class="comment"># power.prop.test(n = NULL, p1 = NULL, p2 = NULL, </span></span><br><span class="line"><span class="comment">#                 power = NULL, sig.level = 0.05,</span></span><br><span class="line"><span class="comment">#                 alternative = c(&quot;two.sided&quot;, &quot;one.sided&quot;),</span></span><br><span class="line"><span class="comment">#                 strict = FALSE, tol = .Machine$double.eps^0.25)</span></span><br><span class="line"><span class="comment"># Examples</span></span><br><span class="line">power.prop.test(p1 = <span class="number">0.5</span>, p2 = <span class="number">0.75</span>, power = <span class="number">0.90</span>) <span class="comment">## =&gt;     n = 76.7 in each group</span></span><br><span class="line">power.prop.test(p1 = <span class="number">0.5</span>, p2 = <span class="number">0.501</span>, </span><br><span class="line">                power = <span class="number">0.90</span>, sig.level=<span class="number">.001</span>)      <span class="comment">## =&gt;     n = 10451937 in each group</span></span><br><span class="line">power.prop.test(n = <span class="number">50</span>, p1 = <span class="number">0.5</span>, p2 = <span class="number">0.75</span>)       <span class="comment">## =&gt; power = 0.740</span></span><br><span class="line">power.prop.test(n = <span class="number">50</span>, p1 = <span class="number">0.5</span>, power = <span class="number">0.90</span>)    <span class="comment">## =&gt;    p2 = 0.8026</span></span><br><span class="line">power.prop.test(n = <span class="number">50</span>, p1 = <span class="number">0.5</span>, p2 = <span class="number">0.9</span>,</span><br><span class="line">                power = <span class="number">0.90</span>, sig.level=<span class="literal">NULL</span>)      <span class="comment">## =&gt; sig.l = 0.00131</span></span><br></pre></td></tr></table></figure><h4 id="Result-Evaluation"><a href="#Result-Evaluation" class="headerlink" title="Result Evaluation"></a>Result Evaluation</h4><table><thead><tr><th>Group</th><th>Control - A</th><th>Variation - B</th></tr></thead><tbody><tr><td>Unique Visitor</td><td>500</td><td>500</td></tr><tr><td>Unique Click</td><td>50</td><td>60</td></tr><tr><td>Conversion Rate</td><td>10%</td><td>12%</td></tr></tbody></table><ul><li><p>$H_0:\space d=0$</p></li><li><p>$d \sim N(0,SE)$</p><ul><li>$p_{\text{pool}}=\frac{50+60}{500+500}=0.11$</li><li>$SE=\sqrt{p_{\text{pool}}\times(1-p_{\text{pool}})\times(\frac{1}{N_A}+\frac{1}{N_B})}=0.019789$</li></ul></li><li><p>Calculate 95% confidence interval ($\alpha=5%$)</p><ul><li>$\pm z_{\alpha/2}\times SE\implies (-1.96\times SE, 1.96\times SE)=(-0.0388, 0.0388)$</li><li>$d = 12% - 10% =0.02 &lt; 0.0388$</li><li>Cannot reject $H_0$</li></ul></li><li><p>Suppose $N_A$ and $N_B$ become 10 times larger</p><ul><li>$SE=0.00003916$</li><li>$\pm z_{\alpha/2}\times SE = \pm 0.0000767536$</li><li>$d=0.02&gt;0.0000767536$</li><li>Reject $H_0$</li></ul></li></ul><h3 id="Some-Challenges-in-A-B-Testing"><a href="#Some-Challenges-in-A-B-Testing" class="headerlink" title="Some Challenges in A/B Testing"></a>Some Challenges in A/B Testing</h3><h4 id="Tradeoff-between-alpha-and-beta"><a href="#Tradeoff-between-alpha-and-beta" class="headerlink" title="Tradeoff between $\alpha$ and $\beta$"></a>Tradeoff between $\alpha$ and $\beta$</h4><ul><li><p>By definition, $\alpha$ is the false positive rate, representing the chance that we falsely reject $H_0$. In contrast, $\beta$ is the false negative rate, representing the chance that we should reject but didn’t.</p></li><li><p>Since resources and time are limited, we need put the effect on the project that improves the business most significantly and has the largest favorable business impact.</p></li><li><p>As a result, we might emphasize $\alpha$ at expense of $\beta$. Also, remember to reach an agreement with business before the test.</p></li></ul><h4 id="Insignificant-Treatment-Effect"><a href="#Insignificant-Treatment-Effect" class="headerlink" title="Insignificant Treatment Effect"></a>Insignificant Treatment Effect</h4><ul><li>It is worth noting that the difference between control and treatment is <em>insignificant in statistics</em>. The testing feature can be helpful in the long run.</li><li>Generate a line plot to visualize the difference and check if one is above the other in most of the time, though the difference could be statistically insignificant. Such a line plot can also provide some insights.</li></ul><h4 id="Multi-armed-Bandit-Approach"><a href="#Multi-armed-Bandit-Approach" class="headerlink" title="Multi-armed Bandit Approach"></a>Multi-armed Bandit Approach</h4><p>We want to achieve two goals at a time: (1) find the best variant in a longer time of experiment and (2) maximize the revenue during the experiment period as well.</p><ul><li>Solution: Adjust fraction of (new) users in treatment/control according to which group seems to be doing better.</li></ul>]]></content>
    
    
    <summary type="html">This is a brief note on A/B Testing, including the motivation, prerequisites, and practice steps. Some details and challenges in developing an A/B testing are also covered.</summary>
    
    
    
    
    <category term="A/B Testing" scheme="http://yanghaowang.github.io/tags/A-B-Testing/"/>
    
  </entry>
  
  <entry>
    <title>How to Use Class Objects in Python</title>
    <link href="http://yanghaowang.github.io/posts/20210810-How-to-Use-Class-Objects-in-Python"/>
    <id>http://yanghaowang.github.io/posts/20210810-How-to-Use-Class-Objects-in-Python</id>
    <published>2021-08-11T02:50:09.000Z</published>
    <updated>2021-08-11T04:34:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>I am used to statistical programming and use self-defined functions a lot in R. In my research work, a self-defined function works well in most cases since the scalability and flexibility of codes are less of concern. However, as using more Python and reading more source codes of Python packages, I find <code>class</code> is an important object and deserves a brief study on it.</p><p>A class is a prototype for an object, from which new instances can be created. An instance is a copy of the class with actual values.</p><h2 id="Class-Object"><a href="#Class-Object" class="headerlink" title="Class Object"></a>Class Object</h2><p>A given class object consists of two components:</p><ul><li>State: Attributes/properties of an object</li><li>Behavior: Methods of an object</li></ul><p>All the instances share the attributes and the methods of the class. But the values of attributes are unique for each instance. Let’s see an example as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define a python class named &#x27;makecake&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">makecake</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Define class variables</span></span><br><span class="line">    cook = <span class="string">&#x27;Sharon&#x27;</span></span><br><span class="line">    price_lb = <span class="number">5</span>    <span class="comment"># unit price; dollars per lb</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initialize</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, weight</span>):</span></span><br><span class="line">        <span class="comment"># Define instance variables</span></span><br><span class="line">        self.weight = weight</span><br><span class="line">       </span><br><span class="line">    <span class="comment"># Define a method for an instance</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">price</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.weight*self.price_lb</span><br></pre></td></tr></table></figure><blockquote><p><code>makecake</code> is the class name.</p><p><code>cook</code> and <code>price_lb</code> are the class attributes, representing the cook and the unit price of a cake.</p><p><code>price()</code> is the class method used to calculate the cake price.</p><p><code>__init__</code> method is a preserved method for a class object, used to initializing its state. The <code>__init__</code> method is executed at the time the class is instantiated (i.e., the creation of an instance).</p><p><code>self</code> is a must-have parameter in each class method, though it might take no arguments. When we call a method of an object as <code>myobject.method(arg1, arg2)</code>, it is equivalent to the command that <code>MyClass.method(myobject, arg1, arg2)</code>.</p></blockquote><p>Also, note that <code>weight</code> is a variable <em>unique to each instance</em>, while <code>cook</code>, <code>price_lb</code>, <code>price()</code> are <em>class variables</em> shared by all instances of the class.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cake = makecake(weight=<span class="number">2</span>)</span><br><span class="line">print(cake.cook)</span><br><span class="line">print(cake.price_lb)</span><br><span class="line">cake.price()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sharon</span><br><span class="line">5</span><br><span class="line">10</span><br></pre></td></tr></table></figure><h2 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h2><p>Inheritance allows us to define a class that inherits all the methods and properties from another class. For example, inherited from <code>makecake</code>, I declare a new class <code>ordercake</code> as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define a python class based on &#x27;makecake&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ordercake</span>(<span class="params">makecake</span>):</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initialize</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, weight, tax_rate=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="comment"># Define instance variables</span></span><br><span class="line">        self.weight = weight</span><br><span class="line">        self.tax_rate = tax_rate <span class="keyword">if</span> tax_rate <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0.06</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkout</span>(<span class="params">self, tip=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> tip <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            tip = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># self.price() is inherited from &#x27;makecake&#x27;</span></span><br><span class="line">        print(<span class="string">&#x27;Receipt&#x27;</span>, <span class="string">&#x27;\n--------------------&#x27;</span></span><br><span class="line">              <span class="string">&#x27;\nCake Price:&#x27;</span>, <span class="built_in">round</span>(self.price(), <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTax:&#x27;</span>, <span class="built_in">round</span>(self.price()*self.tax_rate, <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTips:&#x27;</span>, tip, <span class="string">&#x27;\n--------------------&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;\nTotal:&#x27;</span>, <span class="built_in">round</span>(self.price()*(<span class="number">1</span>+self.tax_rate)+tip, <span class="number">2</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder0 = ordercake(weight=<span class="number">2</span>)</span><br><span class="line">myorder0.checkout()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.6 </span><br><span class="line">Tips: 0 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 10.6</span><br></pre></td></tr></table></figure><p>In addtion to the inherited attributes, I add another attribute <code>tax_rate</code> in the <code>ordercake</code> class to calculate the cake price after tax such that<br>$$<br>\text{Cake Price after Tax}=\text{Cake Price before Tax}\times(1+\text{Tax Rate}).<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder1 = ordercake(weight=<span class="number">2</span>, tax_rate = <span class="number">0.08</span>)</span><br><span class="line">myorder1.checkout()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.8 </span><br><span class="line">Tips: 0 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 10.8</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myorder1.checkout(tip&#x3D;2)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.8 </span><br><span class="line">Tips: 2 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 12.8</span><br></pre></td></tr></table></figure><h2 id="Use-Self-defined-Function-in-Class"><a href="#Use-Self-defined-Function-in-Class" class="headerlink" title="Use Self-defined Function in Class"></a>Use Self-defined Function in Class</h2><p>To enhance the <code>ordercake</code> class, I add an additional function to determine the delivery fee as follows.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Define a free-delivery function</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_delivery</span>(<span class="params">order_price</span>):</span></span><br><span class="line">    <span class="comment"># Define the delivery fee</span></span><br><span class="line">    delivery_fee = <span class="number">5</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Waive delivery fee if order price &gt;= 15 dollars</span></span><br><span class="line">    <span class="keyword">if</span> order_price &gt;= <span class="number">15</span>:</span><br><span class="line">        delivery_fee = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> delivery_fee</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define a python class based on &#x27;makecake&#x27;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ordercake_delivery</span>(<span class="params">makecake</span>):</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, weight, delivery, tax_rate=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="comment"># Define instance variables</span></span><br><span class="line">        self.weight = weight</span><br><span class="line">        self.delivery_fcn = delivery</span><br><span class="line">        self.tax_rate = tax_rate <span class="keyword">if</span> tax_rate <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="number">0.06</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkout</span>(<span class="params">self, tip=<span class="literal">None</span></span>):</span></span><br><span class="line">        d_fee = self.delivery_fcn(self.price())</span><br><span class="line">        <span class="keyword">if</span> tip <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            tip = <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        print(<span class="string">&#x27;Receipt&#x27;</span>, <span class="string">&#x27;\n--------------------&#x27;</span></span><br><span class="line">              <span class="string">&#x27;\nCake Price:&#x27;</span>, <span class="built_in">round</span>(self.price(), <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTax:&#x27;</span>, <span class="built_in">round</span>(self.price()*self.tax_rate, <span class="number">2</span>),</span><br><span class="line">              <span class="string">&#x27;\nTips:&#x27;</span>, tip,</span><br><span class="line">              <span class="string">&#x27;\nDelivery:&#x27;</span>, d_fee, <span class="string">&#x27;\n--------------------&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;\nTotal:&#x27;</span>, <span class="built_in">round</span>(self.price()*(<span class="number">1</span>+self.tax_rate)+tip+d_fee, <span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>A delivery fee of 5 dollars is added to the receipt if the cake price is less than 15 dollars.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder2 = ordercake_delivery(weight=<span class="number">2</span>, delivery=free_delivery)</span><br><span class="line">myorder2.checkout()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 10 </span><br><span class="line">Tax: 0.6 </span><br><span class="line">Tips: 0 </span><br><span class="line">Delivery: 5 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 15.6</span><br></pre></td></tr></table></figure><p>In contrast, the delivery fee is waived if the cake price is 15 dollars or above.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myorder3 = ordercake_delivery(weight=<span class="number">3</span>, delivery=free_delivery)</span><br><span class="line">myorder3.checkout(tip=<span class="number">2</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Receipt </span><br><span class="line">--------------------</span><br><span class="line">Cake Price: 15 </span><br><span class="line">Tax: 0.9 </span><br><span class="line">Tips: 2 </span><br><span class="line">Delivery: 0 </span><br><span class="line">-------------------- </span><br><span class="line">Total: 17.9</span><br></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>Python Classes and Objects at GeeksforGeeks: <a href="https://www.geeksforgeeks.org/python-classes-and-objects/">https://www.geeksforgeeks.org/python-classes-and-objects/</a></p>]]></content>
    
    
    <summary type="html">A class is a prototype for an object, from which new instances can be created.</summary>
    
    
    
    
    <category term="Python" scheme="http://yanghaowang.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Path to Virtual Drive</title>
    <link href="http://yanghaowang.github.io/posts/20210720-Path-to-Virtual-Drive"/>
    <id>http://yanghaowang.github.io/posts/20210720-Path-to-Virtual-Drive</id>
    <published>2021-07-20T15:54:41.000Z</published>
    <updated>2021-10-21T21:07:28.949Z</updated>
    
    <content type="html"><![CDATA[<p class='twelve columns' style="text-align: center;">    <img src="/posts/20210720-Path-to-Virtual-Drive/SyncingGoogleDrive.png" class=""></p><p>This July, Google released a new Google Drive desktop app to replace old versions. The biggest change is that I cannot find a local path for files that are selected to be synced to the corresponding files in Google Drive.</p><h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>It bothered me since I mapped a virtual drive <code>W:</code> to the local Google Drive folder using a <code>.bat</code> file with a Windows command <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/subst"><code>subst</code></a> executed when I log into Windows. I learned this trick from my professor at UTK. It allowed me to keep a consistent working directory in my coding scripts. At the beginning of a script, I usually define a working directory at <code>W:</code> which is synced to my Google Drive. Using this trick, I no longer need to change the existing directory when switching my working computer from the desktop in my office to the laptop at home.</p><p>Now, the new Google Drive desktop app does not maintain a local path. Instead, it creates a drive, named “Google Drive,” after it starts as I am logging into Windows. The computer executes the selected software in the Windows Startup list. However, the new Google Drive app takes a little longer to fully start than my <code>.bat</code>. Therefore, when the <code>.bat</code> starts, it cannot find the corresponding path to be mapped to <code>W:</code>.</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>I turn off “Google Drive” in the Windows Startup list, while use the <code>.bat</code> file to start it before executing the <code>subst</code> command.</p><p>Here is an example of my <code>.bat</code> file, say <code>vdrive.bat</code>.</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">subst M: <span class="string">&quot;C:\Users\&lt;username&gt;\OneDrive - azureford&quot;</span></span><br><span class="line"><span class="built_in">start</span> C:\<span class="string">&quot;Program Files&quot;</span>\Google\<span class="string">&quot;Drive File Stream&quot;</span>\<span class="number">51.0</span>.<span class="number">16.0</span>\GoogleDriveFS.exe</span><br><span class="line">timeout /t <span class="number">8</span> /nobreak &gt; nul</span><br><span class="line">subst W: <span class="string">&quot;G:\My Drive&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>Notes: Please replace <code>&lt;username&gt;</code> with your username. If interested, feel free to check the references for windows commands, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/echo"><code>echo</code></a>, <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/start"><code>start</code></a>, and <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/timeout"><code>timeout</code></a>.</p></blockquote><p><code>vdrive.bat</code> will be started as I log into Windows if it is added to Windows Registry as a string value in <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]</code>. I need define a value name and the value data for this string value, where the value name is a string displayed in the Windows Startup list and the value data is a path with double quotation marks at both ends, e.g., <code>&quot;C:\vdrive.bat&quot;</code>.</p><p>Every time, when <code>vdrive.bat</code> starts, a Command Prompt window appears. I don’t want to see that as I log into Windows. So I create a shortcut for <code>vdrive.bat</code>, that is, <code>vdrive.bat.lnk</code>. Right click the shortcut file, choose “Minimized” in Run, and save the change. Then I update the value data to <code>&quot;C:\vdrive.bat.lnk&quot;</code> in Windows Registry. Awesome, it works perfectly!</p><p>Don’t want to work in Windows Registry for the Startup list. No problem. You can put the shortcut in the following directory:</p><blockquote><p>Startup folder for user:<br><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code></p><p>Startup folder for all users:<br><code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</code></p></blockquote><h3 id="Navigating-in-Command-Prompt"><a href="#Navigating-in-Command-Prompt" class="headerlink" title="Navigating in Command Prompt"></a>Navigating in Command Prompt</h3><p>In Command Prompt, the default <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cd"><code>cd</code></a> command allows us to change the working directory within the same drive. When changing to a directory in another drive,</p><ol><li>we need switch to the target drive first by typing the letter of the drive and then direct us to the target directory using <code>cd</code>, or</li><li>we can add a parameter in the <code>cd</code> command, i.e., <code>cd /d &quot;&lt;path in another drive&gt;&quot;</code>.</li></ol><p class='twelve columns' style="text-align: center;">    <img src="/posts/20210720-Path-to-Virtual-Drive/cd_command.png" class=""></p>]]></content>
    
    
    <summary type="html">Windows CMD, Command Prompt, Navigation, Virtual Drive, Google Drive, GoogleDriveFS.exe</summary>
    
    
    
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
    <category term="CMD" scheme="http://yanghaowang.github.io/tags/CMD/"/>
    
  </entry>
  
  <entry>
    <title>GitHub Authentication and Basic Functionalities</title>
    <link href="http://yanghaowang.github.io/posts/20210615-GitHub-Authentication-and-Basic-Functionalities"/>
    <id>http://yanghaowang.github.io/posts/20210615-GitHub-Authentication-and-Basic-Functionalities</id>
    <published>2021-06-15T16:06:00.000Z</published>
    <updated>2021-10-21T21:22:12.027Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I share with colleagues my knowledge of Git/GitHub. I gave a presentation in a team meeting, which covers the authentication and the basic functionalities of GitHub. </p><p class='twelve columns' style="text-align: center;">    <img src="/posts/20210615-GitHub-Authentication-and-Basic-Functionalities/Git_GitHub.png" class=""></p><p>The authentication setting of GitHub in Git is not as easy as that in the GitHub Desktop App. Most beginners are overwhelmed by large numbers of relevant posts. Therefore, I list the <em>only necessary official</em> references that you can follow step by step to set up the authentication. Moreover, from my perspectives, I list the basic functionalities of GitHub as well as the corresponding daily Git commands. Lastly, I share some rules of thumb for collaboration in GitHub.</p><h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><p><em>You must authenticate before you can access certain resources on GitHub</em>. When you authenticate to GitHub, you supply or confirm credentials that are unique to you to prove that you are exactly who you declare to be. The most two popular ways to authenticate to GitHub are </p><ol><li>A Combination of Username and Personal Access Token, and</li><li>The SSH Protocol</li></ol><h3 id="Username-and-Token"><a href="#Username-and-Token" class="headerlink" title="Username and Token"></a>Username and Token</h3><ol><li><p>Creating a personal access token: <a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-token">https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-token</a></p></li><li><p>Using a token on the command line: <a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#using-a-token-on-the-command-line">https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token#using-a-token-on-the-command-line</a></p></li></ol><h3 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h3><ol><li>Checking for existing SSH keys: <a href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/checking-for-existing-ssh-keys">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/checking-for-existing-ssh-keys</a></li><li>Generating a new SSH key and adding it to the ssh-agent: <a href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent</a></li><li>Adding a new SSH key to your GitHub account: <a href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account</a></li></ol><p>With SSH keys, you can connect to GitHub without supplying your username and personal access token at each visit.</p><p class='twelve columns' style="text-align: center;">    <img src="/posts/20210615-GitHub-Authentication-and-Basic-Functionalities/GitHubAuthentication.png" class=""></p><h2 id="Basic-Functionalities"><a href="#Basic-Functionalities" class="headerlink" title="Basic Functionalities"></a>Basic Functionalities</h2><h3 id="Adding-an-existing-project-to-GitHub"><a href="#Adding-an-existing-project-to-GitHub" class="headerlink" title="Adding an existing project to GitHub"></a>Adding an existing project to GitHub</h3><p><a href="https://docs.github.com/en/github/importing-your-projects-to-github/importing-source-code-to-github/adding-an-existing-project-to-github-using-the-command-line">https://docs.github.com/en/github/importing-your-projects-to-github/importing-source-code-to-github/adding-an-existing-project-to-github-using-the-command-line</a></p><h3 id="Cloning-a-repository"><a href="#Cloning-a-repository" class="headerlink" title="Cloning a repository"></a>Cloning a repository</h3><p><a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository-from-github/cloning-a-repository">https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository-from-github/cloning-a-repository</a></p><h3 id="Branch-Checkout-Branch"><a href="#Branch-Checkout-Branch" class="headerlink" title="Branch: Checkout/Branch"></a>Branch: Checkout/Branch</h3><ol><li>Create a new branch using <code>git branch &lt;branch_name&gt;</code>.</li><li>Switch to the new branch using <code>git checkout &lt;branch_name&gt;</code>.</li></ol><p>Execute two command lines in one: <code>git checkout -b &lt;branch_name&gt;</code></p><h3 id="Adding-a-file-to-a-repository"><a href="#Adding-a-file-to-a-repository" class="headerlink" title="Adding a file to a repository"></a>Adding a file to a repository</h3><p><a href="https://docs.github.com/en/github/managing-files-in-a-repository/managing-files-using-the-command-line/adding-a-file-to-a-repository-using-the-command-line">https://docs.github.com/en/github/managing-files-in-a-repository/managing-files-using-the-command-line/adding-a-file-to-a-repository-using-the-command-line</a></p><h3 id="Remove-files-from-the-working-directory"><a href="#Remove-files-from-the-working-directory" class="headerlink" title="Remove files from the working directory"></a>Remove files from the working directory</h3><ol><li>Remove files (e.g. trash.txt) from local directory manually.</li><li><code>git rm trash.txt</code> in Git Bash.</li><li>Commit the change using <code>git commit -m &quot;Remove trash.txt&quot;</code>.</li></ol><h3 id="Pull-and-Push"><a href="#Pull-and-Push" class="headerlink" title="Pull and Push"></a>Pull and Push</h3><ol><li>Check the target remote repository on GitHub using <code>git remote -v</code>.</li><li>Pull the latest changes from GitHub with <code>git pull</code>.</li><li>Push your work to GitHub with <code>git push origin &lt;branch_name&gt;&quot;</code> where <code>origin</code> is referred to as the target remote repository.</li></ol><h3 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h3><p>Merge code changes in two different branches (target branch and to be merged branch)</p><ol><li>Checkout the target branch using <code>git checkout &lt;target_bread&gt;</code>.</li><li>Merge the changes from to-be-merged-branch into the target branch using <code>git merge &lt;to_be_merged_branch&gt;</code>.</li></ol><h3 id="Revert-and-Reset"><a href="#Revert-and-Reset" class="headerlink" title="Revert and Reset"></a>Revert and Reset</h3><p><code>git revert &lt;commit_ID&gt;</code> will undo the changes in a particular commit.</p><ul><li><code>git reset </code></li></ul><ul><li><code>git commit --amend</code></li></ul><h2 id="Best-Practices-for-Collaboration"><a href="#Best-Practices-for-Collaboration" class="headerlink" title="Best Practices for Collaboration"></a>Best Practices for Collaboration</h2><ol><li>Always synchronize your branches before starting any work on your own.</li><li>Make changes that are self-contained.</li><li>Avoid having very large changes that modify a lot of different things. (Try to make changes as small as possible as long as they’re self-contained.)</li><li>When working on a big change, it makes sense to have a separate feature branch.</li><li>Regularly merge changes made on the master branch back onto the feature branch.</li><li>Have the latest version of the project in the master branch, and the stable version of the project on a separate branch.</li><li>You shouldn’t rebase changes that have been pushed to remote repos.</li><li>Write commit messages.</li><li>Only edit the same branch when necessary after submitting a pull request.</li></ol>]]></content>
    
    
    <summary type="html">Git, GitHub, Git Basics, GitHub Authentication</summary>
    
    
    
    
    <category term="Git" scheme="http://yanghaowang.github.io/tags/Git/"/>
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
  </entry>
  
  <entry>
    <title>Brief Introduction of Essential Methods in Causal Inference</title>
    <link href="http://yanghaowang.github.io/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference"/>
    <id>http://yanghaowang.github.io/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference</id>
    <published>2021-05-07T00:30:32.000Z</published>
    <updated>2021-05-17T01:05:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>Running an AB test becomes a generic solution when we are interested in the causal impacts of a new feature on the product sales or performance. What if we cannot set up the environment of an experiment because of market regulation?</p><p>In this post, we turn back to some essential methods in causal inference. These methods are briefly covered by the Coursera Project, titled “<a href="https://www.coursera.org/projects/essential-causal-inference-for-data-science">Essential Causal Inference Techniques for Data Science</a>.”</p><h2 id="Idea-behind-Causal-Inference"><a href="#Idea-behind-Causal-Inference" class="headerlink" title="Idea behind Causal Inference"></a>Idea behind Causal Inference</h2><p>Try to control for all possible confounders and <strong>look for “natural sources” of variation that can split our data into quasi random groups</strong> and mimic the randomization we would get from an AB test.</p><p>In other words, removing the effects of all the potential confounders, we believe that testing groups are randomly split and comparable.</p><h2 id="Essential-Methods"><a href="#Essential-Methods" class="headerlink" title="Essential Methods"></a>Essential Methods</h2><h3 id="Controlled-Regression"><a href="#Controlled-Regression" class="headerlink" title="Controlled Regression"></a>Controlled Regression</h3><ul><li><p>We have Y =&gt; usage as measured by completing the 2nd week of a course</p></li><li><p>and X =&gt; First Week NPS (net promoter score) which is a satisfaction rating on a 1-10 scale</p></li><li><p>Univariate regression of Y (usage) on X (product quality)</p></li><li><p>Multiple regression of Y (usage) on X (product quality) and a set of controls</p></li></ul><p>If </p><ol><li><p>the R squared in the multiple regression increases “a lot” from that in the univariate regression</p></li><li><p>coefficient on X is similar in the two models</p></li></ol><p>then by the theory of controlled regression, we can use it as the causal impact.</p><blockquote><p>Sources of Error</p><ul><li><p>Omitted Variable Bias</p><p>Look at the R squared in the multiple regression with controls and how large it is (if R^2^ is not close to 100% we know there are a lot of omitted variables in our regression)</p></li><li><p>Included Variable Bias</p><p>This is the opposite of omitted variable bias and involves the inclusion of too many controls. No direct way to identify this problem but generally can leave out controls that are not determined at time observe X. In the ML context, it is the information leakage (e.g., target encoding), that is, using future to predict the past.</p></li></ul></blockquote><p>Controlled regression can be a bit of art form and a bit of random. People nowadays prefer the other causal inference techniques that are considered to be more rigorous and reliable.</p><h3 id="Regression-Discontinuity"><a href="#Regression-Discontinuity" class="headerlink" title="Regression Discontinuity"></a>Regression Discontinuity</h3><p>Focus on cut-off point that can be thought of as local randomized experiment.</p><img src="/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference/RD.png" class=""><blockquote><p>Arbitrarily assigned cutoff point randomly splits the sample into two comparable groups around the cutoff point. </p></blockquote><ul><li><p>Y: Revenue or course enrollment</p></li><li><p>X: Advertisement (advertised, e.g., via email, if the percentage of subtitled materials in a course is greater than 80%)</p></li><li><p>Assumption</p><ol><li><p>Courses below and above the 80% subtitle threshold are similar to one another, so the discontinuity point effectively randomizes the sample.</p><blockquote><p>Check:</p><ol><li>Sample size similar below and above cutoff (i.e., roughly balanced)</li><li>Sample below and above cutoff are similar on observable/confounders</li></ol></blockquote></li><li><p>Advertising available or not is assumed to be the only differentiator between courses at the 70% subtitle value and the 90% subtitle value.</p><blockquote><p>Check:</p><p>Conduct placebo tests, that is, run regression discontinuity at points other than the cutoff and check for no effect (e.g., run regression discontinuity at 20%, 30%, and 40% and we shouldn’t find any significant difference at these levels)</p></blockquote></li></ol></li></ul><p>Using regression discontinuity design (RDD), we estimate a linear regression with a term of the X variable with the discontinuity, an indicator for the discontinuity (which is a function of the X variable being above or below the cutoff point), and the interaction of the X variable and the discontinuity indicator.<br>$$<br>y=\beta_0+\beta_1 \cdot x+\beta_2 \cdot I(x\ge c)+\beta_3\cdot x \cdot I(x\ge c),<br>$$<br>where $x$ is the variable with the discontinuity, $I(\cdot)$ is an indicator function, and $c$ is the randomly assigned cutoff point.</p><blockquote><p>Note this regression fits two linear models (with different coefficients) below and above the cutoff point. When $x&lt;c$, the intercept and the coefficient of the X variable are $\beta_0$ and $\beta_1$. In contrast, when $x\ge c$, the intercept and the coefficient become $\beta_0+\beta_2$ and $\beta_1+\beta_3$.</p><p>This change in the model structure is analog to the formulation of the Chow test for examining the structural break.</p></blockquote><p>Comparing pre and post the discontinuity, we obtain the causal effect given by<br>$$<br>\beta_2 + \beta_3\times c.<br>$$</p><h3 id="Difference-in-Difference"><a href="#Difference-in-Difference" class="headerlink" title="Difference-in-Difference"></a>Difference-in-Difference</h3><img src="/posts/20210506-Brief-Introduction-of-Essential-Methods-in-Causal-Inference/DID.png" class=""><ul><li><p>Y: Revenue</p></li><li><p>X: Price change</p></li><li><p>Assumption: Parallel Trends</p><p>Check revenue in control country with no price change was similar and highly correlated with revenue in treatment country with price change (ensure control can serve as counterfactual)</p><ol><li>Graph control and treatment groups in the pre period and see if highly correlated</li><li>Build a regression model to check whether trends are identical (hypotheses testing if there is no difference in slopes between two groups)</li></ol></li><li><p>Extension: <strong>Synthetic Control</strong></p><ul><li>Problem with regular DID: Picking a single control group that satisfies parallel trends can be arbitrary</li><li>Synthetic control creates a synthetic control group that is a weighted average of many control groups<ol><li>Choose weights to minimize tracking error with treatment group pre intervention (parallel trends)</li><li>Causal estimate is difference post intervention between treatment and “synthetic control” </li></ol></li><li>R packages: <a href="https://cran.r-project.org/web/packages/Synth/index.html"><code>Synth</code></a>; <a href="https://cran.r-project.org/web/packages/CausalImpact/"><code>CausalImpact</code></a> (Bayesian Version)</li></ul></li></ul><h3 id="Instrumental-Variables"><a href="#Instrumental-Variables" class="headerlink" title="Instrumental Variables"></a>Instrumental Variables</h3><ul><li><p>Assumptions</p><ol><li><p>Strong First Stage: Instruments are strong predictors for the X variable</p><p>Hypothesis tests for weak instruments</p></li><li><p>Exclusion Restriction: Instruments have an impact on the Y variable only through their impact on the X variable</p><p>There is no test for this assumption. We need to use logic to strengthen the validity of this assumption. In a <strong>randomized encouragement trial</strong> (i.e., a RCT used for product promotion campaign; think of email notification) where we create the instrument as a randomly assigned nudge that prompts the X variable, we can ensure exclusion restriction through random assignment.</p></li></ol></li></ul><h3 id="Machine-Learning-ML-Causal-Inference"><a href="#Machine-Learning-ML-Causal-Inference" class="headerlink" title="Machine Learning (ML) + Causal Inference"></a>Machine Learning (ML) + Causal Inference</h3><ul><li><p>Weakness of classic causal approaches</p><ul><li>Fail with many covariates</li><li>Model selection unprincipled</li><li>Linear relationships and no interactions</li></ul></li><li><p>Benefits of ML</p><ul><li>Handle high dimensionality</li><li>Principled ways to choose model</li><li>Nonlinear model using higher order features</li></ul></li><li><p>ML form controlled regression</p><ul><li><p>Use ML models to control for many potential confounders and/or nonlinear effects. </p><blockquote><p>Standard controlled regression steps</p><ul><li>Regress Y on X and a set of controls C to identify coefficient of interest on X</li><li>Be wary of omitted and included variable biases</li></ul></blockquote></li><li><p>There are two types of ML form controlled regressions:</p><ul><li>Double Selection (LASSO)</li><li>Double Debiased (Generic ML models)</li></ul><blockquote><p>Double Selection on AB test data:</p><ul><li>Reduce the noises and increase statistical power (give smaller confidence intervals in a shorter experiment period)</li><li>Good for small samples and small effect sizes (i.e., small expected difference between A and B groups)</li></ul></blockquote></li><li><p>Steps</p><ul><li><p>Define outcome Y, treatment indicator X, and high dimensional set of controls C</p></li><li><p>Split data into two sets: Training and Testing (this can be generalized to k-folds)</p></li><li><p><strong>Fit</strong> two Lassos of X~C and Y~C <strong>on the training</strong> data set</p><blockquote><p>Use <a href="https://stats.stackexchange.com/questions/138569/why-is-lambda-within-one-standard-error-from-the-minimum-is-a-recommended-valu">the one standard error rule</a> to choose the optimal $\lambda$ (i.e., the shrinkage parameter) for the LASSO regression</p><p>The final set of controls is a union of controls from the LASSO regression X~C and Y~C</p></blockquote></li><li><p>Take fitted models and <strong>apply to the testing</strong> data set</p></li><li><p>Get all nonzero variables in C and use as controls in controlled regression of Y on X</p></li></ul></li></ul></li><li><p>Causal Trees/Forests</p><ul><li><p>Previous models assume homogeneous treatment effects. However, <strong>causal trees/forests estimates heterogeneous treatment effects</strong> where impact differs on observed criteria</p><ul><li>Use trees (or forests) to identify partition of the demographic space that maximizes observed difference of Y between treatment and control while balancing overfitting</li></ul></li><li><p>Steps</p><ul><li>Split data into two halves</li><li>Fit trees/forests on one half (i.e., the splitting subsample) and apply to second half (i.e., the estimating subsample) to estimate treatment effects</li><li>Heterogeneous treatment effects from difference in Y in leaf nodes (i.e., the treatment effect conditioned on C attributes in leaf nodes) </li><li>Optimization criteria set up to find the best fit given the splitting subsample</li><li>Forest is an average of a collection of trees with sampling</li></ul></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Running an AB test becomes a generic solution when we are interested in the causal impacts of a new feature on the product sales or perfo</summary>
      
    
    
    
    
    <category term="Causal Inference" scheme="http://yanghaowang.github.io/tags/Causal-Inference/"/>
    
    <category term="Machine Learning" scheme="http://yanghaowang.github.io/tags/Machine-Learning/"/>
    
  </entry>
  
  <entry>
    <title>Aggregate Data in SQL Using GROUP BY or Window Functions</title>
    <link href="http://yanghaowang.github.io/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions"/>
    <id>http://yanghaowang.github.io/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions</id>
    <published>2021-04-10T15:57:07.000Z</published>
    <updated>2021-04-11T03:15:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>Aggregating over groups and calculating summary statistics by group provide an informative angle to review the data. As examining the data at the disaggregated level, we might prefer including the summary statistics aside. Therefore, we need to merge a table of summary statistics at the group level back to the disaggregated data using group ID. <em>Window functions</em> are introduced in SQL to facilitate this process.</p><blockquote><p>A <em>window function</em> performs a calculation across a set of table rows that are somehow related to the current row. This is comparable to the type of calculation that can be done with an aggregate function. <strong>In contrast to regular aggregate functions, use of a window function does not cause rows to become grouped into a single output row</strong> – the rows retain their separate identities (<a href="https://mode.com/sql-tutorial/sql-window-functions/#intro-to-window-functions">MODE Tutorial Link</a>).</p></blockquote><p>This post summarizes the primary use of window functions by presenting practice examples.</p><h2 id="The-OVER-Clause-Syntax"><a href="#The-OVER-Clause-Syntax" class="headerlink" title="The OVER Clause Syntax"></a>The <code>OVER</code> Clause Syntax</h2><p>The basic syntax of window function is to use SQL functions (either aggregate functions such as <code>SUM</code>, <code>COUNT</code>, and <code>AVG</code> or row-wise functions such as <code>ROW_NUMBER()</code> and <code>RANK()</code>) together with the <code>OVER</code> clause.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---- OVER (ORDER BY) ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_time,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">      start_time</span><br><span class="line">  ) <span class="keyword">AS</span> cumsum <span class="comment">-- cumulative sum overall</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br><span class="line"></span><br><span class="line"><span class="comment">---- OVER (PARTITION BY) ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">  ) <span class="keyword">AS</span> sub_total <span class="comment">-- subtotal by group</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br><span class="line"></span><br><span class="line"><span class="comment">---- OVER (PARTITION BY + ORDER BY) ----</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">      start_time</span><br><span class="line">  ) <span class="keyword">AS</span> running_total <span class="comment">-- cumsum within group</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br></pre></td></tr></table></figure><blockquote><p>The <code>PARTITION BY</code> clause within the <code>OVER</code> clause divides the data into subsets by the values of selected columns.</p></blockquote><h2 id="GROUP-BY-JOIN-Window-Functions"><a href="#GROUP-BY-JOIN-Window-Functions" class="headerlink" title="GROUP BY + JOIN = Window Functions"></a><code>GROUP BY</code> + <code>JOIN</code> = Window Functions</h2><p>Here is a diagram to illustrate this <code>GROUP BY</code>+<code>JOIN</code> process:</p><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/transform-example.png" class=""><blockquote><p>This can be completed by <code>pandas.DataFrame.transform</code> in Python (<a href="https://pbpython.com/pandas_transform.html">Reference Link</a>) or <code>DT[, .SD, by]</code> using <code>data.table</code> package in R (<a href="https://rdatatable.gitlab.io/data.table/articles/datatable-sd-usage.html">Reference Link</a>).</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---- Window Functions ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  <span class="keyword">COUNT</span>(duration_seconds) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal) <span class="keyword">AS</span> n_duration,</span><br><span class="line">  <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal) <span class="keyword">AS</span> subtotal_duration</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> duration_seconds &gt; <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds</span><br><span class="line"></span><br><span class="line"><span class="comment">---- GROUP BY + LEFT JOIN ----</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  raw.start_terminal,</span><br><span class="line">  duration_seconds,</span><br><span class="line">  n_duration,</span><br><span class="line">  subtotal_duration</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  tutorial.dc_bikeshare_q1_2012 <span class="keyword">raw</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">      start_terminal,</span><br><span class="line">      <span class="keyword">COUNT</span>(duration_seconds) <span class="keyword">AS</span> n_duration,</span><br><span class="line">      <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">AS</span> subtotal_duration</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">      tutorial.dc_bikeshare_q1_2012</span><br><span class="line">    <span class="keyword">WHERE</span></span><br><span class="line">      start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">      <span class="keyword">AND</span> duration_seconds &gt; <span class="number">3000</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">      start_terminal</span><br><span class="line">  ) subsum <span class="keyword">ON</span> subsum.start_terminal = raw.start_terminal</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  raw.start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> raw.duration_seconds &gt; <span class="number">3000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  start_terminal,</span><br><span class="line">  duration_seconds</span><br></pre></td></tr></table></figure><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/WindowFunction_1.png" class=""><h2 id="ROW-NUMBER-RANK-and-DENSE-RANK"><a href="#ROW-NUMBER-RANK-and-DENSE-RANK" class="headerlink" title="ROW_NUMBER(), RANK(), and DENSE_RANK()"></a><code>ROW_NUMBER()</code>, <code>RANK()</code>, and <code>DENSE_RANK()</code></h2><p>When labeling the row numbers, we are thinking of <code>ROW_NUMBER()</code>, <code>RANK()</code>, and <code>DENSE_RANK()</code>. </p><ul><li><p><code>RANK()</code> vs. <code>ROW_NUMBER()</code></p><p>For example, if you order by <code>start_time</code>, there might exist some rows with identical start times. <code>RANK()</code> gives the same rank to these rows, whereas <code>ROW_NUMBER()</code> gives them different numbers in order. </p></li><li><p><code>RANK()</code> vs. <code>DENSE_RANK()</code></p><p>For example, <code>RANK()</code> would give the identical rows a rank of 2, then might give 5 by skipping the ranks 3 and 4. In contrast, <code>DENSE_RANK()</code> would not skip any rank. It gives all the identical rows a rank of 2, followed by 3.</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---- ROW_NUMBER() ----</span></span><br><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       start_time,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       ROW_NUMBER() <span class="keyword">OVER</span> (</span><br><span class="line">         <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">         <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_time</span><br><span class="line">       ) <span class="keyword">AS</span> row_number</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---- RANK() ----</span></span><br><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       <span class="keyword">RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">         <span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal</span><br><span class="line">         <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_time</span><br><span class="line">       ) <span class="keyword">AS</span> <span class="keyword">rank</span></span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Quartile-Quintile-and-Percentile"><a href="#Quartile-Quintile-and-Percentile" class="headerlink" title="Quartile, Quintile, and Percentile"></a>Quartile, Quintile, and Percentile</h2><p>Use the window function <code>NTILE(# of buckets)</code> to label the subgroups ordered by selected columns.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       NTILE(<span class="number">4</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">          <span class="keyword">AS</span> quartile,</span><br><span class="line">       NTILE(<span class="number">5</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">         <span class="keyword">AS</span> quintile,</span><br><span class="line">       NTILE(<span class="number">100</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">         <span class="keyword">AS</span> percentile</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> duration_seconds &gt; <span class="number">300</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_terminal, duration_seconds</span><br></pre></td></tr></table></figure><h3 id="Window-Alias"><a href="#Window-Alias" class="headerlink" title="Window Alias"></a>Window Alias</h3><p>If you’re planning to write several window functions in to the same query, using the same window, you can create an alias. The <code>WINDOW</code> clause, if included, should always come <em>after</em> the <code>WHERE</code> clause.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       <span class="keyword">SUM</span>(duration_seconds) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal) <span class="keyword">AS</span> subtotal,</span><br><span class="line">       NTILE(<span class="number">4</span>) <span class="keyword">OVER</span> ntile_window                               <span class="keyword">AS</span> quartile,</span><br><span class="line">       NTILE(<span class="number">5</span>) <span class="keyword">OVER</span> ntile_window                               <span class="keyword">AS</span> quintile,</span><br><span class="line">       NTILE(<span class="number">100</span>) <span class="keyword">OVER</span> ntile_window                             <span class="keyword">AS</span> percentile,</span><br><span class="line">       ROW_NUMBER() <span class="keyword">OVER</span> ntile_window                           <span class="keyword">AS</span> row_numb</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> duration_seconds &gt; <span class="number">300</span></span><br><span class="line"><span class="keyword">WINDOW</span> ntile_window <span class="keyword">AS</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_terminal, duration_seconds</span><br></pre></td></tr></table></figure><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/WindowFunction_2.png" class=""><blockquote><p>When <code># of buckets</code> is greater than the number of records, <code>NTILE()</code> == <code>ROW_NUMBER()</code>.</p></blockquote><h2 id="Comparing-to-The-Preceding-or-Following-Rows"><a href="#Comparing-to-The-Preceding-or-Following-Rows" class="headerlink" title="Comparing to The Preceding or Following Rows"></a>Comparing to The Preceding or Following Rows</h2><p>You can use <code>LAG</code> or <code>LEAD</code> to create columns that pull values from other rows.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> start_terminal,</span><br><span class="line">       duration_seconds,</span><br><span class="line">       LAG(duration_seconds, <span class="number">1</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds) <span class="keyword">AS</span> lag,</span><br><span class="line">       duration_seconds -LAG(duration_seconds, <span class="number">1</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds)</span><br><span class="line">         <span class="keyword">AS</span> lag_difference,</span><br><span class="line">       <span class="keyword">LEAD</span>(duration_seconds, <span class="number">1</span>) <span class="keyword">OVER</span></span><br><span class="line">         (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> start_terminal <span class="keyword">ORDER</span> <span class="keyword">BY</span> duration_seconds) <span class="keyword">AS</span> <span class="keyword">lead</span></span><br><span class="line">  <span class="keyword">FROM</span> tutorial.dc_bikeshare_q1_2012</span><br><span class="line"> <span class="keyword">WHERE</span> start_time &lt; <span class="string">&#x27;2012-01-08&#x27;</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_terminal, duration_seconds</span><br></pre></td></tr></table></figure><img src="/posts/20210410-Aggregate-Data-in-SQL-Using-GROUP-BY-or-Window-Functions/WindowFunction_3.png" class="">]]></content>
    
    
    <summary type="html">Aggregate Data in SQL, GROUP BY, Window Functions, SQL OVER Clause, Window Alias</summary>
    
    
    
    
    <category term="SQL" scheme="http://yanghaowang.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Aggregating and Filtering at One Time in SQL</title>
    <link href="http://yanghaowang.github.io/posts/20210406-Aggregating-and-Filtering-at-One-Time-in-SQL"/>
    <id>http://yanghaowang.github.io/posts/20210406-Aggregating-and-Filtering-at-One-Time-in-SQL</id>
    <published>2021-04-07T01:37:57.000Z</published>
    <updated>2021-04-10T19:22:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>When it comes to reporting some statistics by group in SQL, we will think of using the aggregate functions and, if needed, the <code>WHERE</code> clause for filtering. However, the <code>WHERE</code> clause doesn’t allow you to filter on aggregate columns. To complete the query at one time without subqueries, we need the help of the <code>HAVING</code> clause.</p><h2 id="Aggregate-Functions"><a href="#Aggregate-Functions" class="headerlink" title="Aggregate Functions"></a>Aggregate Functions</h2><p>There are four popular aggregate functions in SQL:</p><ul><li><p><code>COUNT</code> counts the number of non-<code>NULL</code> rows in a column</p><ul><li><code>COUNT(DISTINCT price)</code> counts the number of the distinct non-<code>NULL</code> values in <code>price</code>.</li></ul></li><li><p><code>SUM</code> adds together all the values in a numeric column</p><ul><li><code>NULL</code> is treated as <code>0</code>. </li></ul></li><li><p><code>MIN</code> and <code>MAX</code> return the lowest and highest values in a numeric column, respectively</p></li><li><p><code>AVG</code> calculates the average of a group of selected values</p><ul><li><p>It can ONLY be used on numerical columns.</p></li><li><p><code>NULL</code> is ignored in the calculation.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(price)</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line"> <span class="keyword">WHERE</span> price <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="comment">---- Equivalent Query ----</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(price)</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.storesales</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="Aggregate-by-Group"><a href="#Aggregate-by-Group" class="headerlink" title="Aggregate by Group"></a>Aggregate by Group</h3><p>For example, you might want to count the number of entries for each year and month.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">year</span>,</span><br><span class="line">       <span class="keyword">month</span>,</span><br><span class="line">       <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="keyword">count</span></span><br><span class="line"> <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">month</span>, <span class="keyword">year</span></span><br></pre></td></tr></table></figure><h2 id="Filtering"><a href="#Filtering" class="headerlink" title="Filtering"></a>Filtering</h2><p>What if we are only interested in the months when the highest price is over 200.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">year</span>,</span><br><span class="line">       <span class="keyword">month</span>,</span><br><span class="line">       <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> month_high</span><br><span class="line"> <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">MAX</span>(price) &gt; <span class="number">200</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line"><span class="comment">---- Equivalent Query ----</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">      <span class="keyword">SELECT</span> <span class="keyword">year</span>,</span><br><span class="line">             <span class="keyword">month</span>,</span><br><span class="line">             <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> month_high</span><br><span class="line">        <span class="keyword">FROM</span> tutorial.storesales</span><br><span class="line">       <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br><span class="line">      ) sub</span><br><span class="line"><span class="keyword">WHERE</span> month_high &gt; <span class="number">200</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">year</span>, <span class="keyword">month</span></span><br></pre></td></tr></table></figure><ul><li>Using the aggregate function and the <code>HAVING</code> clause at one time to filter on an aggregated column.</li><li>The <code>WHERE</code> clause does not work in this case.</li></ul>]]></content>
    
    
    <summary type="html">Aggregate Functions in SQL, SQL GROUP BY, SQL WHERE, SQL HAVING, Filters on Aggregate Columns in SQL</summary>
    
    
    
    
    <category term="SQL" scheme="http://yanghaowang.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Hypothesis Testing vs. A/B Testing</title>
    <link href="http://yanghaowang.github.io/posts/20210405-Hypothesis-Testing-vs-A-B-Testing"/>
    <id>http://yanghaowang.github.io/posts/20210405-Hypothesis-Testing-vs-A-B-Testing</id>
    <published>2021-04-05T21:12:01.000Z</published>
    <updated>2021-04-25T18:14:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>A/B testing is a popular term in Data Science. It is fairly self-explanatory to me at the first glance but then arises an question, what is the difference between the A/B testing people are using nowadays and the hypothesis testing I learnt in the statistics class. </p><p>In this post, I include some key points for understanding the hypothesis testing and the A/B testing, as well as some takeaways from other posts. In short, A/B testing is a version of a two-sample hypothesis testing for a randomized controlled experiment with two groups, control and treatment.</p><h2 id="Hypothesis-Testing"><a href="#Hypothesis-Testing" class="headerlink" title="Hypothesis Testing"></a>Hypothesis Testing</h2><ul><li>Specify the null ($H_0$) and alternative ($H_1$) Hypothesis</li><li>Calculate test statistics according to the observed sample</li><li>Reject or cannot reject the null hypothesis</li></ul><p>In the hypothesis testing, we have some knowledge of a population and observe a representative sample from the population. By computing the test statistics, we verify if our knowledge of the population can be supported by the observed sample.</p><p><a href="https://towardsdatascience.com/a-gentle-introduction-to-the-mathematics-behind-a-b-testing-3afe354bdce3">A post by Jérôme Spielmann</a> gives a gentle introduction about the mathematics behind the statistical testing and the transition from the generic testing to the A/B testing.</p><blockquote><p>In this post, the author has an example of the results in a A/B test.</p><table><thead><tr><th align="left"></th><th align="center">Click on Link</th><th align="center">Did not Click</th></tr></thead><tbody><tr><td align="left">Design A</td><td align="center">33</td><td align="center">362</td></tr><tr><td align="left">Design B</td><td align="center">42</td><td align="center">283</td></tr></tbody></table><p>In the hypothesis testing, we focus on the results from one design and have<br>$$<br>H_0:p=0.05\quad\text{v.s.}\quad H_1:p\neq 0.05.<br>$$</p><p>In the A/B testing, we compare the results from two designs and have</p><p>$$<br>H_0:p_1=p_2=p\quad\text{v.s.}\quad H_1:p_1\neq p_2.<br>$$</p></blockquote><h2 id="A-B-Testing"><a href="#A-B-Testing" class="headerlink" title="A/B Testing"></a>A/B Testing</h2><ul><li>Define a measure of interest (i.e., treatment) and a metric</li><li>Specify the control and treatment group (i.e., Group A and B)</li><li>Construct the null hypothesis that the treatment group is as same as the control group</li><li>Calculate test statistics according to the control and treatment group</li><li>Reject or cannot reject the null hypothesis</li></ul><p>In the A/B testing, we have a hypothesis of a measure and we are interested in its impact. Particularly, we design a randomized experiment with two groups that are identical prior to the treatment. In the testing process, one group is treated, while the other is not. </p><h3 id="Test-Statistics"><a href="#Test-Statistics" class="headerlink" title="Test Statistics"></a>Test Statistics</h3><p>The A/B testing includes applications of <a href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">statistical hypothesis testing</a> or “<a href="https://en.wikipedia.org/wiki/Two-sample_hypothesis_testing">two-sample hypothesis testing</a>“ as used in statistics. The test statistics vary with the metrics that are used for comparing the two groups.</p><ul><li> <a href="https://en.wikipedia.org/wiki/Z-test">Z-test</a> is appropriate for comparing means under stringent conditions regarding normality and a known standard deviation.</li><li> <a href="https://en.wikipedia.org/wiki/Student's_t-test">Student’s t-tests</a> is appropriate for comparing means under relaxed conditions when less is assumed. </li><li> <a href="https://en.wikipedia.org/wiki/Welch's_t_test">Welch’s t test</a> assumes the least and is therefore the most commonly used test in a two-sample hypothesis test where the mean of a metric is to be optimized.</li><li> <a href="https://en.wikipedia.org/wiki/Fisher's_exact_test">Fisher’s exact test</a> is used in a comparison of two <a href="https://en.wikipedia.org/wiki/Binomial_distribution">binomial distributions</a> such as a <a href="https://en.wikipedia.org/wiki/Click-through_rate">click-through rate</a>.</li></ul><table><thead><tr><th>Assumed Distribution</th><th align="left">Example Case</th><th>Standard Test</th><th>Alternative Test</th></tr></thead><tbody><tr><td><a href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian</a></td><td align="left"><a href="https://en.wikipedia.org/wiki/Average_revenue_per_user">Average revenue per user</a></td><td><a href="https://en.wikipedia.org/wiki/Welch's_t-test">Welch’s t-test</a> <br>(Unpaired t-test)</td><td><a href="https://en.wikipedia.org/wiki/Student's_t-test">Student’s t-test</a></td></tr><tr><td><a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial</a></td><td align="left"><a href="https://en.wikipedia.org/wiki/Click-through_rate">Click-through rate</a></td><td><a href="https://en.wikipedia.org/wiki/Fisher's_exact_test">Fisher’s exact test</a></td><td><a href="https://en.wikipedia.org/wiki/Barnard's_test">Barnard’s test</a></td></tr><tr><td><a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson</a></td><td align="left">Transactions <br/>per paying user</td><td>E-test</td><td>C-test</td></tr><tr><td><a href="https://en.wikipedia.org/wiki/Multinomial_distribution">Multinomial</a></td><td align="left">Number of <br/>each product purchased</td><td><a href="https://en.wikipedia.org/wiki/Chi-squared_test">Chi-squared test</a></td><td></td></tr><tr><td>Unknown</td><td align="left"></td><td><a href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test">Mann–Whitney U test</a></td><td><a href="https://en.wikipedia.org/wiki/Gibbs_sampling">Gibbs sampling</a></td></tr></tbody></table><blockquote><p>Reference Link: <a href="https://en.wikipedia.org/wiki/A/B_testing#Common_test_statistics">https://en.wikipedia.org/wiki/A/B_testing#Common_test_statistics</a></p></blockquote><h3 id="Test-Significance-Level-and-Statistical-Power"><a href="#Test-Significance-Level-and-Statistical-Power" class="headerlink" title="Test Significance Level and Statistical Power"></a>Test Significance Level and Statistical Power</h3><p>Oftentimes, a problem will be given with a desired confidence level instead of the significance level ($\alpha$). A typical 95% confidence level for an A/B test corresponds to a significance level of 0.05.</p><blockquote><p>$\text{significance level}~\alpha=1-\text{confidence level}$</p></blockquote><p><em>An experiment in the A/B testing is typically set up at a minimum statistical power of 80 percent</em>. In other words, we want the test to show it is at least 80 percent in the probability that the treatment truly works.</p><p>By construction, if we increase the sample size for both A and B group, we will make the distributions under $H_0$ and $H_1$ much narrower and hence increase the statistical power.   </p><h3 id="Test-Sample-Size"><a href="#Test-Sample-Size" class="headerlink" title="Test Sample Size"></a>Test Sample Size</h3><p>The key is to determine the minimum sample size for the experiment, because it is directly related to how quickly you can complete the test and deliver statistically significant results.</p><blockquote><p>There are two calculators available on the web:</p><ul><li><a href="https://www.evanmiller.org/ab-testing/sample-size.html">Sample Size Calculator (Evan’s Awesome A/B Tools) (evanmiller.org)</a></li><li><a href="https://www.optimizely.com/sample-size-calculator/">A/B Test Sample Size Calculator (optimizely.com)</a></li></ul><p>You will need the baseline conversion rate and the minimum detectable effect, which is the minimum difference between the control and treatment group.</p><p>For detailed discussions on statistical power and sample size, you can also check these two notes:</p><ul><li><a href="https://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/BS704_Power/BS704_Power_print.html">Power and Sample Size Determination (Boston Univeristy School of Public Health)</a></li><li><a href="https://med.stanford.edu/content/dam/sm/s-spire/documents/WIPvF_EstimatingPowerSampleSize_ATrickey.pdf">Estimating Power and Sample Size (Stanford-Surgery Policy Improvement Research and Education)</a></li></ul></blockquote><p>According to the <a href="https://web.stanford.edu/~kcobb/hrp259/lecture11.ppt">the lecture notes from Stanford</a>, we have this formula:<br>$$<br>n=\frac{r+1}{r}\frac{\sigma^2(Z_\beta+Z_{\alpha/2})^2}{d^2},<br>$$<br>where $n$ is the sample size of the smaller group, $r$ is the ratio of the larger group to the smaller group, $\sigma$ is the standard deviation of the outcome variable, $Z_\beta$ and $Z_{\alpha/2}$ represents the critical value at the desired power and significance level (two-sided testing), and $d$ is the size of the treatment effect (i.e., the difference in means).</p><blockquote><p>All-purpose power formula $Z_\beta=\frac{d}{\text{s.e. of }d}-Z_{\alpha/2}$</p><p>Standard error (s.e.) of $d = \sqrt{\frac{\sigma^2}{n}+\frac{\sigma^2}{rn}}$</p></blockquote><p>Subsequently, this formula can be adapted to a case with a binary metric:<br>$$<br>n=\frac{r+1}{r}\frac{\bar p(1-\bar p)(Z_\beta+Z_{\alpha/2})^2}{(p_1-p_2)^2},<br>$$<br>where $\bar p = (p_1+p_2)/2$. A corresponding Python script is provided in <a href="https://towardsdatascience.com/the-math-behind-a-b-testing-with-example-code-part-1-of-2-7be752e1d06f">a post by Nguyen Ngo</a>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy.stats <span class="keyword">as</span> scs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">min_sample_size</span>(<span class="params">bcr, mde, power=<span class="number">0.8</span>, sig_level=<span class="number">0.05</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns the minimum sample size to set up a split test</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">        bcr (float): probability of success for control, sometimes</span></span><br><span class="line"><span class="string">        referred to as baseline conversion rate</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        mde (float): minimum change in measurement between control</span></span><br><span class="line"><span class="string">        group and test group if alternative hypothesis is true, sometimes</span></span><br><span class="line"><span class="string">        referred to as minimum detectable effect</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        power (float): probability of rejecting the null hypothesis when the</span></span><br><span class="line"><span class="string">        null hypothesis is false, typically 0.8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        sig_level (float): significance level often denoted as alpha,</span></span><br><span class="line"><span class="string">        typically 0.05</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        min_N: minimum sample size (float)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    References:</span></span><br><span class="line"><span class="string">        Stanford lecture on sample sizes</span></span><br><span class="line"><span class="string">        http://statweb.stanford.edu/~susan/courses/s141/hopower.pdf</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># standard normal distribution to determine z-values</span></span><br><span class="line">    standard_norm = scs.norm(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># find Z_beta from desired power</span></span><br><span class="line">    Z_beta = standard_norm.ppf(power)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># find Z_alpha</span></span><br><span class="line">    Z_alpha = standard_norm.ppf(<span class="number">1</span>-sig_level/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># average of probabilities from both groups</span></span><br><span class="line">    pooled_prob = (bcr + bcr+mde) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    min_N = (<span class="number">2</span> * pooled_prob * (<span class="number">1</span> - pooled_prob) * (Z_beta + Z_alpha)**<span class="number">2</span></span><br><span class="line">             / mde**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> min_N</span><br></pre></td></tr></table></figure><h2 id="Refresher-on-A-B-Testing"><a href="#Refresher-on-A-B-Testing" class="headerlink" title="Refresher on A/B Testing"></a>Refresher on A/B Testing</h2><blockquote><p>This part summarizes <a href="https://hbr.org/2017/06/a-refresher-on-ab-testing">the article</a> published in <em>Harvard Business Review</em>. </p></blockquote><h3 id="How-Does-A-B-Testing-Work"><a href="#How-Does-A-B-Testing-Work" class="headerlink" title="How Does A/B Testing Work?"></a>How Does A/B Testing Work?</h3><p>A/B testing, at its most basic, is a way to compare two versions of something to figure out which performs better. “The A/B test can be considered the most basic kind of randomized controlled experiment,” Fung says. “In its simplest form, there are two treatments and one acts as the control for the other.” <em>As with all randomized controlled experiments, you must estimate the <strong>sample size</strong> you need to achieve a statistical significance, which will help you make sure the result you’re seeing “isn’t just because of background noise</em>,” Fung says.</p><p>Lots of managers run sequential tests — e.g., testing size first (large versus small), then testing color (blue versus red), then testing typeface (Times versus Arial) — because they believe they shouldn’t vary two or more factors at the same time. But according to Fung, that view has been debunked by statisticians. And <em>sequential tests are suboptimal because you’re not measuring what happens when factors interact</em>. For example, it may be that users prefer blue on average but prefer red when it’s combined with Arial. This kind of result is regularly missed in sequential A/B testing because the typeface test is run on blue buttons that have “won” the prior test. </p><p>Using mathematics you can “smartly pick and run only certain subsets of those treatments; then you can infer the rest from the data.” This is called “multivariate” testing in the A/B testing world and often means you end up doing an A/B/C test or even an A/B/C/D test. In the example above with colors and size, it might mean showing different groups: a large red button, a small red button, a large blue button, and a small blue button.</p><h3 id="What-Mistakes-Do-People-Make-When-Doing-A-B-Tests"><a href="#What-Mistakes-Do-People-Make-When-Doing-A-B-Tests" class="headerlink" title="What Mistakes Do People Make When Doing A/B Tests?"></a>What Mistakes Do People Make When Doing A/B Tests?</h3><ul><li><p>First, he says, too many managers don’t let the tests run their course. </p><ul><li>The problem is that, because of randomization, it’s possible that if you let the test run to its natural end, you might get a different result. </li></ul></li><li><p>The second mistake is looking at too many metrics.</p><ul><li>The problem is that if you’re looking at such a large number of metrics at the same time, you’re at risk of making what statisticians call “spurious correlations.” </li><li>In proper test design, you should decide on the metrics you’re going to look at before you execute an experiment and select a few. The more you’re measuring, the more likely that you’re going to see random fluctuations.  </li></ul></li><li><p>Lastly, few companies do enough retesting.</p><ul><li>Even though there may be little chance that any given A/B result is driven by random chance, if you do lots of A/B tests, the chances that at least one of your results is wrong grows rapidly.</li><li>The smaller the improvement, the less reliable the results.  </li></ul></li></ul><p>It’s clear that A/B testing is not a panacea. There are more complex kinds of experiments that are more efficient and will give you more reliable data. But A/B testing is a great way to gain a <em>quick</em> understanding of a question you have.   </p>]]></content>
    
    
    <summary type="html">Hypothesis Testing, A/B Testing</summary>
    
    
    
    
    <category term="Hypothesis Testing" scheme="http://yanghaowang.github.io/tags/Hypothesis-Testing/"/>
    
    <category term="A/B Testing" scheme="http://yanghaowang.github.io/tags/A-B-Testing/"/>
    
  </entry>
  
  <entry>
    <title>Error Types and Measures</title>
    <link href="http://yanghaowang.github.io/posts/20210327-Error-Types-and-Measures"/>
    <id>http://yanghaowang.github.io/posts/20210327-Error-Types-and-Measures</id>
    <published>2021-03-27T20:14:51.000Z</published>
    <updated>2021-10-21T15:13:34.855Z</updated>
    
    <content type="html"><![CDATA[<p>In the context of econometrics and the empirical analysis in microeconomics, we focus on the type I error and pay much attention on p-value evaluated at a given significance level ($\alpha$). I haven’t cared about the type II error and the statistical power of a test ($1-\beta$) quite a while since I worked on some homework problems related to type II error in the graduate school as taking the Mathematical Statistics course.</p><p>When evaluating the results from a A/B testing and comparing the performances of alternative machine learning models, we inevitably encounter quite a few measures pertaining to type I and type II errors. In this post, I am going to review the error types and some relevant measures.</p><h2 id="Error-Types"><a href="#Error-Types" class="headerlink" title="Error Types"></a>Error Types</h2><p>Errors arise in the process of the statistical testing. Let $H_0$ and $H_1$ denote the null and the alternative hypothesis for a test. By calculating a test statistic from an observed sample, we can reject $H_0$ or not. Because of the randomness, we sometimes might make a mistake as concluding with the value of a test statistic. Here is a table explicitly presenting the error types in a statistical test.</p><table><thead><tr><th></th><th align="left">$H_0$ is true</th><th align="left">$H_0$ is not true</th></tr></thead><tbody><tr><td>Reject $H_0$</td><td align="left">Type I error <br>False Positive (FP)</td><td align="left">Correct <br>True Positive (TP)</td></tr><tr><td>Cannot reject $H_0$</td><td align="left">Correct<br>True Negative (TN)</td><td align="left">Type II error <br>False Negative (FN)</td></tr></tbody></table><p>As follows, there are relevant measures build on this table:</p><ul><li><p>Recall, Sensitivity, or True Positive Rate (TPR):<br>$$<br>\frac{TP}{TP+FN}=1-\beta<br>$$<br>where $1-\beta$ represents the statistical power of the test.</p></li><li><p>False Positive Rate (FPR):<br>$$<br>\frac{FP}{FP+TN}=\alpha<br>$$<br>where $\alpha$ represents the significance level of the test.</p><blockquote><p>In a binary classification problem, the TPR and the FPR will vary accordingly as we change the determination threshold in a model (e.g., the cut-off point for a logit model in predicting the credit default).</p><img src="/posts/20210327-Error-Types-and-Measures/AUC.png" class=""><p>A <strong>receiver (or relative) operating characteristic curve</strong>, or <strong>ROC curve</strong>, is a <a href="https://en.wikipedia.org/wiki/Graph_of_a_function">graphical plot</a> that illustrates the diagnostic ability of a <a href="https://en.wikipedia.org/wiki/Binary_classifier">binary classifier</a> system <u>as its discrimination threshold is varied</u>. The method was originally developed for operators of military radar receivers, which is why it is so named.</p><p>The optimal cut-off point on ROC can be determined by one of the three criteria (<a href="http://www.medicalbiostatistics.com/roccurve.pdf">Reference Link</a>):</p><ul><li>The farthest point from the random classifier, that is, max(TPR+FPR), the Youden index</li><li>The closest point to the perfect classifier (0, 1)</li><li>The point minimizing the cost.</li></ul></blockquote></li><li><p>Precision, or Positive Predictive Value (PPV):<br>$$<br>\frac{TP}{TP+FP}<br>$$</p></li><li><p>Specificity, Selectivity, or True Negative Rate (TNR):<br>$$<br>\frac{TN}{TN+FP}=1-\alpha<br>$$</p></li><li><p>Accuracy:<br>$$<br>\frac{TP+TN}{TP+TN+FP+FN}<br>$$</p></li><li><p>F1 Score (Harmonic mean of precision and recall):<br>$$<br>\frac{1}{\frac{1}{2}\frac{1}{\text{Precision}}+\frac{1}{2}\frac{1}{\text{ Recall}}}=2\times\frac{\text{Precision}\times\text{Recall}}{\text{Precision}+\text{Recall}}<br>$$</p><blockquote><p>The harmonic mean is best used for fractions such as rates.</p><p>For example, Joe drives a car at 10 mph for the half of the journey and 40 mph for the second half. What’s his average speed? The naïve answer is to calculate the total mileage of the journey and then divide it by the total drive time. Denote the total mileage of the journey as $x$ and the total drive time is $\frac{0.5x}{10}+\frac{0.5x}{40}$. Therefore, the average speed is $x/\left(\frac{0.5x}{10}+\frac{0.5x}{40}\right)=16$ mph.</p></blockquote></li></ul><h2 id="Trade-off-between-Errors"><a href="#Trade-off-between-Errors" class="headerlink" title="Trade-off between Errors"></a>Trade-off between Errors</h2><p>We cannot reduce the type I error (false positive) and the type II error (false negative) at the same time, once a testing environment is fixed and the observed results are given. Usually, we set the expected result as the alternative hypothesis $H_1$ and prefer minimizing $\alpha$ in a statistical test, the probability that we incorrectly reject $H_0$.</p><p>The figure below presents the change in $\alpha$ and $\beta$ as the cut-off point is altered in a given test. By construction, we would like to differentiate the distributions under $H_0$ and $H_1$ as much as possible.</p><img src="/posts/20210327-Error-Types-and-Measures/PPV_NPV_Sensitivity_and_Specificity.png" class=""><p>In this figure, it is easy to see the specificity ($=1-\alpha$, also known as the confidence level) and the sensitivity ($=1-\beta$, also known as the statistical power of the test) representing the “true” portion of the $H_0$ distribution and the $H_1$ distribution, respectively.</p>]]></content>
    
    
    <summary type="html">type I error, type II error, measures built on errors, terms from a confusion matrix, ROC, AUC</summary>
    
    
    
    
    <category term="Error Types" scheme="http://yanghaowang.github.io/tags/Error-Types/"/>
    
    <category term="Confusion Matrix" scheme="http://yanghaowang.github.io/tags/Confusion-Matrix/"/>
    
    <category term="Hypothesis Testing" scheme="http://yanghaowang.github.io/tags/Hypothesis-Testing/"/>
    
  </entry>
  
  <entry>
    <title>SQL JOIN with the WHERE and the ON Clause</title>
    <link href="http://yanghaowang.github.io/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause"/>
    <id>http://yanghaowang.github.io/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause</id>
    <published>2021-02-07T00:53:06.000Z</published>
    <updated>2021-04-10T19:21:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>When merging tables with selected rows in SQL, we often think of using the <code>JOIN</code> statement with the <code>WHERE</code> and the <code>ON</code> clause. The resulting table would depend on the inclusion of filters in the <code>WHERE</code> or the <code>ON</code> clause. To illustrate this difference, I employ the SQL examples from <a href="https://mode.com/sql-tutorial/sql-joins-where-vs-on/">a MODE tutorial page</a>.</p><h2 id="Filtering-in-The-ON-Clause"><a href="#Filtering-in-The-ON-Clause" class="headerlink" title="Filtering in The ON Clause"></a>Filtering in The <code>ON</code> Clause</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> companies.permalink            <span class="keyword">AS</span> companies_permalink,</span><br><span class="line">       companies.name                 <span class="keyword">AS</span> companies_name,</span><br><span class="line">       acquisitions.company_permalink <span class="keyword">AS</span> acquisitions_permalink,</span><br><span class="line">       acquisitions.acquired_at       <span class="keyword">AS</span> acquired_date</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.crunchbase_companies         companies</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tutorial.crunchbase_acquisitions acquisitions</span><br><span class="line">    <span class="keyword">ON</span> companies.permalink = acquisitions.company_permalink</span><br><span class="line">   <span class="keyword">AND</span> acquisitions.company_permalink != <span class="string">&#x27;/company/1000memories&#x27;</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><blockquote><p><code>ORDER BY 1</code> is equivalent to <code>ORDER BY companies.permalink</code> </p></blockquote><p>The conditional statement <code>AND...</code> is evaluated <strong>before</strong> the join occurs. Particularly, the <code>AND</code> statement is evaluated on the joining  table (i.e., <code>acquisitions</code>) rather than the target table (i.e., <code>companies</code>). Hence, the 1000memories permalink is still displayed in the column that pulls from the target table (i.e., <code>companies</code>).</p><img src="/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause/UsingWhereOrON_1.png" class=""><h2 id="Filtering-in-The-WHERE-Clause"><a href="#Filtering-in-The-WHERE-Clause" class="headerlink" title="Filtering in The WHERE Clause"></a>Filtering in The <code>WHERE</code> Clause</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> companies.permalink            <span class="keyword">AS</span> companies_permalink,</span><br><span class="line">       companies.name                 <span class="keyword">AS</span> companies_name,</span><br><span class="line">       acquisitions.company_permalink <span class="keyword">AS</span> acquisitions_permalink,</span><br><span class="line">       acquisitions.acquired_at       <span class="keyword">AS</span> acquired_date</span><br><span class="line">  <span class="keyword">FROM</span> tutorial.crunchbase_companies         companies</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tutorial.crunchbase_acquisitions acquisitions</span><br><span class="line">    <span class="keyword">ON</span> companies.permalink = acquisitions.company_permalink</span><br><span class="line"> <span class="keyword">WHERE</span> acquisitions.company_permalink != <span class="string">&#x27;/company/1000memories&#x27;</span></span><br><span class="line">    <span class="keyword">OR</span> acquisitions.company_permalink <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>If you move the same filter to the <code>WHERE</code> clause, you will notice that the filter happens <strong>after</strong> the tables are joined. The result is that the 1000 memories row is joined onto the original table, but then it is filtered out entirely (in both tables) in the <code>WHERE</code> clause before displaying results (it would have been between the two highlighted lines in the resulting table below).</p><img src="/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause/UsingWhereOrON_2.png" class=""><p>Note <em>that filtering in the</em> <code>WHERE</code> <em>clause can also filter null values</em>, so we added an extra line to make sure to include the nulls.</p><blockquote><p>The null values will not be evaluated using comparison operators.</p><img src="/posts/20210206-SQL-JOIN-with-the-WHERE-and-the-ON-Clause/UsingWhereOrON_3.png" class=""></blockquote>]]></content>
    
    
    <summary type="html">Use JOIN with the WHERE and the ON clause in SQL</summary>
    
    
    
    
    <category term="SQL" scheme="http://yanghaowang.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Git Quick Start</title>
    <link href="http://yanghaowang.github.io/posts/20201201-Git-Quick-Start"/>
    <id>http://yanghaowang.github.io/posts/20201201-Git-Quick-Start</id>
    <published>2020-12-01T22:21:37.000Z</published>
    <updated>2021-10-21T22:02:22.079Z</updated>
    
    <content type="html"><![CDATA[<p>I began my GitHub journey with <a href="https://desktop.github.com/">GitHub Desktop</a>, a  <a href="https://git-scm.com/downloads">Git</a> GUI client for Windows users. Recently, I switch to Git and find it worth to invest some time in learning it by using.</p><p class='twelve columns' style="text-align: center;"><img src="/posts/20201201-Git-Quick-Start/GitBasics.png" class=""></p><h2 id="Quick-Start-for-Git-in-Windows"><a href="#Quick-Start-for-Git-in-Windows" class="headerlink" title="Quick Start for Git in Windows"></a>Quick Start for Git in Windows</h2><ol><li><p>Download and install Git via this link <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a></p></li><li><p>Connect to GitHub using SSH keys</p><p>With SSH keys, we can connect to GitHub without supplying your username and personal access token at each visit.</p><ul><li><p>Learn more <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/about-ssh">about SSH</a></p></li><li><p>Check for existing SSH keys</p><p><a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/checking-for-existing-ssh-keys">Instruction page</a> from GitHub Docs</p><blockquote><p>Novice Note:</p><ol><li>The physical directory in Windows is <code>C:\Users\&lt;user name&gt;\.ssh\</code>, where <code>.ssh</code> is a hidden folder by default</li><li><a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generate a new SSH key</a> if needed</li></ol></blockquote></li><li><p>Add your SSH to the local ssh-agent and your GitHub account</p><blockquote><p>Novice Note: </p><ol><li><p>Use Git Bash to start the ssh-agent in the background. Command Prompt does not recognize <code>eval</code> command.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># start the ssh-agent in the background</span></span><br><span class="line">$ <span class="built_in">eval</span> $(ssh-agent -s)</span><br><span class="line">&gt; Agent pid &lt;your pid number&gt;</span><br></pre></td></tr></table></figure></li><li><p>Go to your GitHub setting page and follow <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account">this instruction</a> from GitHub Docs</p></li></ol></blockquote></li><li><p>Test the SSH connection</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ssh</span> -T git@github.com</span><br><span class="line">&gt; Hi &lt;GitHub username&gt;! You\<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>Start a project with GitHub using the command line</p><p><a href="https://docs.github.com/en/free-pro-team@latest/github/importing-your-projects-to-github/adding-an-existing-project-to-github-using-the-command-line">Instruction page</a> from GitHub Docs</p><blockquote><p>Novice Note:</p><ol><li><p>We can interchangeably use Git Bash and Command Prompt in Windows</p></li><li><p>My colleague suggests me use <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/about-ssh">SSH</a> instead of HTTPS when adding the URL for the remote repository</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sets the new remote</span></span><br><span class="line">$ git remote add origin &lt;remote repository SSH URL&gt;</span><br><span class="line"><span class="comment"># Verifies the new remote URL</span></span><br><span class="line">$ git remote -v</span><br></pre></td></tr></table></figure></li><li><p>We can give a name to the origin branch</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pushes our local repository up to the remote repository we specify as the origin</span></span><br><span class="line">$ git push origin &lt;branch name&gt;</span><br></pre></td></tr></table></figure></li></ol></blockquote></li></ol><h2 id="Git-Reference"><a href="#Git-Reference" class="headerlink" title="Git Reference"></a>Git Reference</h2><p>Cheat Sheet: <a href="https://training.github.com/downloads/github-git-cheat-sheet/">https://training.github.com/downloads/github-git-cheat-sheet/</a></p><p>Video Tutorial: <a href="https://git-scm.com/videos">https://git-scm.com/videos</a></p><p>Documentation: <a href="https://git-scm.com/docs">https://git-scm.com/docs</a></p><p>My colleague, Jianghao, shares his note on using Git via this page: <a href="https://jianghaochu.github.io/version-control-with-git.html">https://jianghaochu.github.io/version-control-with-git.html</a></p>]]></content>
    
    
    <summary type="html">Git, GitHub, Git Basics, Windows Users</summary>
    
    
    
    
    <category term="Git" scheme="http://yanghaowang.github.io/tags/Git/"/>
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
  </entry>
  
  <entry>
    <title>Google Drive plus Git</title>
    <link href="http://yanghaowang.github.io/posts/20201201-Google-Drive-plus-Git"/>
    <id>http://yanghaowang.github.io/posts/20201201-Google-Drive-plus-Git</id>
    <published>2020-12-01T20:21:37.000Z</published>
    <updated>2021-10-21T14:27:46.670Z</updated>
    
    <content type="html"><![CDATA[<p>Collaboration is a multiplier for our achievement in the era of the Internet. I have heard about <a href="https://github.com/features">GitHub</a> for a long time but just started using GitHub <em>intensively</em> last month. In contrast, I have been constantly using <a href="https://www.google.com/intl/en/drive/">Google Drive</a> since 2013. It is not a “either/or” question. On the contrary, we can leverage the power of both.</p><h2 id="Generic-Solution-for-Sharing-and-Synchronizing-Files-Google-Drive"><a href="#Generic-Solution-for-Sharing-and-Synchronizing-Files-Google-Drive" class="headerlink" title="Generic Solution for Sharing and Synchronizing Files: Google Drive"></a>Generic Solution for Sharing and Synchronizing Files: Google Drive</h2><p>GitHub is a popular and well-known tool for IT people when it comes to collaboration in coding. You can simply find tons of reasons convincing people to manager and store their coding scripts using GitHub. However, most of my friends who are not intensively involved in coding have not considered about it. Honestly, I don’t use GitHub very often because of two reasons:</p><ol><li>I use Google Drive which also allows me to retrieve files from the cloud,</li><li>I am not worried about version control. If needed, I will make a copy and title it using an extended name with a time stamp. </li></ol><p>I am always enthused to collaborate with other scholars in doing research and have had pleasant experience in writing academic papers with my co-authors. Most of time, we will divide a long list of tasks into parts, one for each. It is a quite efficient way to do research and a file storage and synchronization service provided by Google Drive (or One Drive and Dropbox) is good enough for us. In my past experience, there is few chance, if possible, that multiple people would work on the same part of a coding script.</p><h2 id="Version-Control-Solution-GitHub"><a href="#Version-Control-Solution-GitHub" class="headerlink" title="Version Control Solution: GitHub"></a>Version Control Solution: GitHub</h2><p>Probably, it is not a good idea to store numbers of copies in a local archive folder. These copies might waste the space in our drive. As a result, there are quite a few times that we need to consider about version control and think of the potential maintenance and further development of existing programs. For example, </p><ol><li>I need to fix a problem in an existing script and update it when the problem is resolved, and</li><li>I might also work together with colleagues on a big project and write some scripts that will be shared within the team.</li></ol><h3 id="GitHub-Desktop-or-Git"><a href="#GitHub-Desktop-or-Git" class="headerlink" title="GitHub Desktop or Git"></a>GitHub Desktop or Git</h3><p><a href="https://desktop.github.com/">GitHub Desktop</a> is a <a href="https://git-scm.com/downloads">Git</a> GUI client for Windows users. It is user friendly and easy to manage your files in local and synchronize them with the copies in GitHub online repositories.</p><p>I began my GitHub journey with GitHub Desktop. Since most of my recent work involves in using a Linux server with command lines, <em>I switch to Git and find it worth to spend some time in learning how to use it</em>.</p><p>Git is small and fast. Written in C and built to work on the Linux kernel, it has had to effectively handle large repositories from day one. <a href="https://git-scm.com/about/small-and-fast">According to its official introduction page, speed and performance has been a primary goal in the design of Git from start</a>. Note that it can also be used in Windows Command Prompt.</p>]]></content>
    
    
    <summary type="html">Collaboration, Synchronization, Version Control</summary>
    
    
    
    
    <category term="Git" scheme="http://yanghaowang.github.io/tags/Git/"/>
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Work Efficiency" scheme="http://yanghaowang.github.io/tags/Work-Efficiency/"/>
    
  </entry>
  
  <entry>
    <title>LaTex Display in Hexo</title>
    <link href="http://yanghaowang.github.io/posts/20201125-LaTex-Display-in-Hexo"/>
    <id>http://yanghaowang.github.io/posts/20201125-LaTex-Display-in-Hexo</id>
    <published>2020-11-25T23:31:58.000Z</published>
    <updated>2022-04-05T04:51:08.341Z</updated>
    
    <content type="html"><![CDATA[<p>One of my motivations to set up my site using Hexo and Github is that I can easily post some notes including some formulas as I write in LaTex in markdown documents. Therefore, I look for a solution for displaying LaTex formulas in Hexo.</p><h2 id="Hexo-Plugins"><a href="#Hexo-Plugins" class="headerlink" title="Hexo Plugins"></a>Hexo Plugins</h2><p>First, I visit the Hexo website and <a href="https://hexo.io/plugins/index.html">search for a Hexo plugin</a> fitting my needs.</p><p>By typing “math” in the search box, I find two relevant plugins, <a href="https://github.com/hexojs/hexo-math">hexo-math</a> and <a href="https://github.com/next-theme/hexo-filter-mathjax">hexo-filter-mathjax</a>. Taking a further look for both plugins, I find the syntax of hexo-math to initiate the math box is different than the LaTex writing in markdown documents. Particularly, the prefix and suffix of the math box in hexo-math for KaTex and Mathjax are</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% katex %&#125;</span><br><span class="line">a^&#123;b&#125;_&#123;c&#125;</span><br><span class="line">&#123;% endkatex %&#125;</span><br></pre></td></tr></table></figure><p>and</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% mathjax %&#125;</span><br><span class="line">a^&#123;b&#125;_&#123;c&#125;</span><br><span class="line">&#123;% endmathjax %&#125;</span><br></pre></td></tr></table></figure><p>as well as some global settings in the front-matter of an article.</p><p>In contrast, the associated syntax in hexo-filter-mathjax is as same as the LaTex writing in markdown documents. Both are using one dollar sign to begin and end the inline math box and two dollar signs for the math box.</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">a^&#123;b&#125;_&#123;c&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>Without doubt, I choose hexo-filter-mathjax and install it in the working directory.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;root-directory-of-your-blog&gt;</span><br><span class="line">$ npm install hexo-filter-mathjax</span><br></pre></td></tr></table></figure><br><h2 id="Conflict-between-LaTex-and-Markdown-Syntax"><a href="#Conflict-between-LaTex-and-Markdown-Syntax" class="headerlink" title="Conflict between LaTex and Markdown Syntax"></a>Conflict between LaTex and Markdown Syntax</h2><p>However, hexo-filter-mathjax is not a fully quick fix. As mentioned in its documentations, hexo-filter-mathjax may have some problem when there are some underscores included, since an underscore (<code>_</code>) may be interpreted as the start of italic text in Markdown, or subscripted mark in TeX. To resolve this conflict, we need to use <code>\</code> in front of <code>_</code>.</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: XXX</span><br><span class="line">date: XXX</span><br><span class="line">mathjax: true ## case insentitive</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">Equation 1</span><br><span class="line">$$</span><br><span class="line">a^&#123;b&#125;<span class="emphasis">_&#123;c&#125; \times a^&#123;b&#125;_</span>&#123;c&#125;</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">Equation 2</span><br><span class="line">$$</span><br><span class="line">a^&#123;b&#125;\<span class="emphasis">_&#123;c&#125; \times a^&#123;b&#125;\_</span>&#123;c&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>Note that Equation 1 will be displayed as “a^{b}<em>{c} \times a^{b}</em>{c}” while Equation 2 will be presented properly.</p><h2 id="Another-Recommended-Hexo-Plugin"><a href="#Another-Recommended-Hexo-Plugin" class="headerlink" title="Another Recommended Hexo Plugin"></a>Another Recommended Hexo Plugin</h2><p>As suggested in the documentation of hexo-filter-mathjax, I install <a href="https://github.com/wzpan/hexo-renderer-pandoc">hexo-renderer-pandoc</a> to address this issue. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;root-directory-of-your-blog&gt;</span><br><span class="line">$ npm install hexo-renderer-pandoc</span><br></pre></td></tr></table></figure><blockquote><p>Note: hexo-renderer-pandoc is built in the environment where pandoc has been installed. Hence, I intall <a href="https://pandoc.org/installing.html">pandoc</a> using <a href="https://chocolatey.org/">Chocolatey</a>. Chocolatey was installed (automatically by default) as I installed Node.js by allowing it to install any necessary package.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> choco install pandoc</span></span><br></pre></td></tr></table></figure><p>So far, I have two hexo plugins (i.e., hexo-filter-mathjax and hexo-render-pandoc) installed in the working directory of my blog.</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> check the installations</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> &lt;root-directory-of-your-blog&gt;</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm list</span></span><br></pre></td></tr></table></figure><p>By turning on the mathjax option in the markdown document, I am able to directly post the article on my site without further edits.</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: XXX</span><br><span class="line">date: XXX</span><br><span class="line">mathjax: true ## case insentitive</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">Equation 1</span><br><span class="line">$$</span><br><span class="line">a^&#123;b&#125;<span class="emphasis">_&#123;c&#125; \times a^&#123;b&#125;_</span>&#123;c&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>Now, Equation 1 can be displayed as expected. In the exported html page, this formula is presented as a <a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG image</a>.</p><h2 id="One-More-Thing-for-The-Lazy"><a href="#One-More-Thing-for-The-Lazy" class="headerlink" title="One More Thing for The Lazy"></a>One More Thing for The Lazy</h2><p>Though a SVG image is print-friendly, it does not allow readers to copy the formula in LaTex codes for other use. As one of the lazy, I do one more thing for my peers, that is, pasting the script for loading the mathjax html extension to <code>post.ejs</code> (e.g., line 3 to 5 in the code box below).</p><blockquote><p><code>post.ejs</code> defines the post template in the directory of the theme’s layout.</p></blockquote><p>In addition, once the mathjax script is included in the post template, I no longer need to add <code>mathjax: true</code> in the front-matter of the post. In other words, the mathjax script is a substitue for the package <code>hexo-filter-mathjax</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;&lt;%- page.title %&gt;&lt;&#x2F;h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;polyfill.io&#x2F;v3&#x2F;polyfill.min.js?features&#x3D;es6&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; id&#x3D;&quot;MathJax-script&quot; async</span><br><span class="line">  src&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3&#x2F;es5&#x2F;tex-chtml.js&quot;&gt;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">MathJax &#x3D; &#123;</span><br><span class="line">  tex: &#123;</span><br><span class="line">    inlineMath: [[&#39;$&#39;, &#39;$&#39;], [&#39;\\(&#39;, &#39;\\)&#39;]]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- page.content%&gt;</span><br></pre></td></tr></table></figure><blockquote><p>Codes in Line 10 enable the browser to properly display the inline formulas between two dollar signs. More detailed information about the configuration of MathJax is available in its <a href="http://docs.mathjax.org/en/latest/web/configuration.html">documentation page</a>.</p></blockquote><p>As follows, when reading the formula in the post, I am able to copy the formula’s LaTex codes.</p><img src="/posts/20201125-LaTex-Display-in-Hexo/codedisplaymenu.png" class=""><br>]]></content>
    
    
    <summary type="html">hexo plugins, LaTex, Markdown, hexo-filter-mathjax, hexo-renderer-pandoc</summary>
    
    
    
    
    <category term="Hexo" scheme="http://yanghaowang.github.io/tags/Hexo/"/>
    
    <category term="LaTex" scheme="http://yanghaowang.github.io/tags/LaTex/"/>
    
  </entry>
  
  <entry>
    <title>Hello World and Thank You Hexo</title>
    <link href="http://yanghaowang.github.io/posts/20201123-Hello-World-and-Thank-You-Hexo"/>
    <id>http://yanghaowang.github.io/posts/20201123-Hello-World-and-Thank-You-Hexo</id>
    <published>2020-11-24T03:31:58.000Z</published>
    <updated>2020-12-06T21:38:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to my site powered by <a href="https://hexo.io/">Hexo</a> and hosted on <a href="https://github.com/yanghaowang/yanghaowang.github.io">GitHub</a>! This is my very first post. </p><h2 id="Why-Hexo-and-GitHub"><a href="#Why-Hexo-and-GitHub" class="headerlink" title="Why Hexo and GitHub"></a>Why Hexo and GitHub</h2><p>I was using and maintaining a homepage on another free hosting site. Through the web interface provided by the hosting site, I can set up a homepage easily and customize it conveniently. It perfectly serves my needs for sharing some info and posts in words. Now, I am thinking of sharing some technical notes that include displays of $\LaTeX$ formulas and codes. </p><p>I am writing markdown documents using Typora and compile my notes with R codes in <code>.Rmd</code> files using RStudio and with python codes in <code>.ipynb</code> files using Jupyter Notebook.</p><table><thead><tr><th align="center">Typora</th><th align="center">Rstudio</th><th align="center">Jupyter Notebook</th></tr></thead><tbody><tr><td align="center"><a class="footer-link" href="https://typora.io/"><img class="img-hov" src="/images/typora_logo.png" width="72px"></a></td><td align="center"><a class="footer-link" href="https://rstudio.com"><img class="img-hov" src="/images/rstudio_logo.png" width="136px"></a></td><td align="center"><a class="footer-link" href="https://jupyter.org"><img class="img-hov" src="/images/jupyter_logo.png" width="56px"></a></td></tr></tbody></table><blockquote><p>Note: Both <code>.Rmd</code> files and <code>.ipynb</code> files can be exported as markdown-formatted documents. </p></blockquote><p>Also, I prefer not spending extra time on format editing for posting them on my site. The less effort in format editing, the better. Ideally, it would be wonderful if I can directly post the contents of my markdown-formatted documents.</p><p>After doing little search online, I find Hexo enables me to publish a post in Markdown and GitHub provides a space for hosting the site. So I decide to move 🚚 and start using the combo 🍔.</p><h2 id="Create-Your-Own-Site"><a href="#Create-Your-Own-Site" class="headerlink" title="Create Your Own Site"></a>Create Your Own Site</h2><p>If you are thinking of building your own site, there are a couple of things you need to do:</p><ol><li><p>Download and install these two programs in your local PC</p><ul><li><p>Node.js [<a href="https://nodejs.org/en/download/">Download Page</a>]</p><ul><li>npm is distributed with <a href="https://nodejs.org/">Node.js</a>- which means that when you download Node.js, you automatically get npm installed on your computer.</li></ul></li><li><p>Git [<a href="https://git-scm.com/downloads">Download Page</a>]</p></li><li><p>Check the program versions in Command Prompt (for Windows) if installations succeed</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># check the version of node.js and npm</span></span><br><span class="line">$ node -v</span><br><span class="line">$ npm -v</span><br><span class="line"><span class="comment"># check the version of git</span></span><br><span class="line">$ git version</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Register a GitHub account and set up Git in your local PC following <a href="https://docs.github.com/en/free-pro-team@latest/github/getting-started-with-github/set-up-git">this GitHub instruction</a> </p></li><li><p>Create a site using Hexo </p><ul><li><p>Watch <a href="https://www.youtube.com/watch?v=Kt7u5kr_P5o&list=PLLAZ4kZ9dFpOMJR6D25ishrSedvsguVSm">Hexo tutorial videos on Youtube</a> </p></li><li><p>Review this <a href="https://hexo.io/docs/">Hexo documentation</a> for more info</p></li><li><p>Ask your questions, if any, on this <a href="https://github.com/hexojs/hexo/issues">GitHub page</a> or look for an solution in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># download hexo client</span></span><br><span class="line">$ npm install -g hexo-cli</span><br><span class="line"><span class="comment"># check the version of git</span></span><br><span class="line">$ hexo -v</span><br><span class="line"><span class="comment"># download hex plugins (example)</span></span><br><span class="line">$ npm install hexo-renderer-pandoc</span><br><span class="line"><span class="comment"># initiate a blog</span></span><br><span class="line">$ hexo init &lt;type-your-blog-name&gt;</span><br><span class="line">$ <span class="built_in">cd</span> &lt;type-your-blog-name&gt;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Choose a theme from <a href="https://hexo.io/themes/index.html">Hexo Theme Gallery</a></p></li></ol><h2 id="Quick-Start-for-Hexo"><a href="#Quick-Start-for-Hexo" class="headerlink" title="Quick Start for Hexo"></a>Quick Start for Hexo</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    <summary type="html">Why Hexo and GitHub, Create Own Site, LaTex, Markdown</summary>
    
    
    
    
    <category term="Github" scheme="http://yanghaowang.github.io/tags/Github/"/>
    
    <category term="Hexo" scheme="http://yanghaowang.github.io/tags/Hexo/"/>
    
  </entry>
  
</feed>
